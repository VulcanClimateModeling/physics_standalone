
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <title>Head</title>
  <style media="screen" type="text/css">

    body
    {
      color: #000000;
      background-color: #FFFFFF;
    }

    /* Link formats: use maroon w/underlines */
    a:link
    {
      color: navy;
      text-decoration: underline;
    }
    a:visited
    {
      color: maroon;
      text-decoration: underline;
    }
    a:active
    {
      color: navy;
      text-decoration: underline;
    }

    /*** TD formats ***/
    td
    {
      font-family: sans-serif;
    }
    td.title
    {
      text-align: center;
      padding-bottom: 10px;
      font-size: 20pt;
      font-weight: bold;
    }

    /* TD Header Information */
    td.headerName
    {
      text-align: right;
      color: black;
      padding-right: 6px;
      font-weight: bold;
      vertical-align: top;
      white-space: nowrap;
    }
    td.headerValue
    {
      text-align: left;
      color: blue;
      font-weight: bold;
      white-space: nowrap;
    }
    td.headerTableEntry
    {
      text-align: right;
      color: black;
      font-weight: bold;
      white-space: nowrap;
      padding-left: 12px;
      padding-right: 4px;
      background-color: LightBlue;
    }
    td.headerValueLeg
    {
      text-align: left;
      color: black;
      font-size: 80%;
      white-space: nowrap;
      padding-left: 10px;
      padding-right: 10px;
      padding-top: 2px;
    }

    /* Color of horizontal ruler */
    td.hr
    {
      background-color: navy;
      height:3px;
    }
    /* Footer format */
    td.footer
    {
      text-align: center;
      padding-top: 3px;
      font-family: sans-serif;
    }

    /* Coverage Table */

    td.coverTableHead
    {
      text-align: center;
      color: white;
      background-color: SteelBlue;
      font-family: sans-serif;
      font-size: 120%;
      white-space: nowrap;
      padding-left: 4px;
      padding-right: 4px;
    }
    td.coverFile
    {
      text-align: left;
      padding-left: 10px;
      padding-right: 20px;
      color: black;
      background-color: LightBlue;
      font-family: monospace;
      font-weight: bold;
      font-size: 110%;
    }
    td.coverBar
    {
      padding-left: 10px;
      padding-right: 10px;
      background-color: LightBlue;
    }
    td.coverBarOutline
    {
      background-color: white;
    }
    td.coverValue
    {
      padding-top: 2px;
      text-align: right;
      padding-left: 10px;
      padding-right: 10px;
      font-family: sans-serif;
      white-space: nowrap;
      font-weight: bold;
    }

    /* Link Details */
    a.detail:link
    {
      color: #B8D0FF;
      font-size:80%;
    }
    a.detail:visited
    {
      color: #B8D0FF;
      font-size:80%;
    }
    a.detail:active
    {
      color: #FFFFFF;
      font-size:80%;
    }

    .graphcont{
        color:#000;
        font-weight:700;
        float:left
    }

    .graph{
        float:left;
        background-color: white;
        position:relative;
        width:280px;
        padding:0
    }

    .graph .bar{
        display:block;
        position:relative;
        border:black 1px solid;
        text-align:center;
        color:#fff;
        height:10px;
        font-family:Arial,Helvetica,sans-serif;
        font-size:12px;
        line-height:1.9em
    }

    .graph .bar span{
        position:absolute;
        left:1em
    }

    td.coveredLine,
    span.coveredLine
    {
        background-color: LightGreen!important;
    }

    td.uncoveredLine,
    span.uncoveredLine
    {
        background-color: LightPink!important;
    }

    .linebranch, .linecount
    {
        border-right: 1px gray solid;
        background-color: lightgray;
    }

    span.takenBranch
    {
        color: Green!important;
        cursor: help;
    }

    span.notTakenBranch
    {
        color: Red!important;
        cursor: help;
    }

    .src
    {
        padding-left: 12px;
    }

    .srcHeader,
    span.takenBranch,
    span.notTakenBranch
    {
        font-family: monospace;
        font-weight: bold;
    }

    pre
    {
        height : 15px;
        margin-top: 0;
        margin-bottom: 0;
    }

    .lineno
    {
        background-color: #EFE383;
        border-right: 1px solid #BBB15F;
    }

  </style>
</head>

<body>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr><td class="title">GCC Code Coverage Report</td></tr>
    <tr><td class="hr"></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding="1" border="0" width="100%">
          <tr>
            <td width="10%" class="headerName">Directory:</td>
            <td width="35%" class="headerValue">./</td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerValue" style="text-align:right;">Exec</td>
            <td width="10%" class="headerValue" style="text-align:right;">Total</td>
            <td width="15%" class="headerValue" style="text-align:right;">Coverage</td>
          </tr>
          <tr>
            <td class="headerName">File:</td>
            <td class="headerValue">physics/cldwat2m_micro.F</td>
            <td></td>
            <td class="headerName">Lines:</td>
            <td class="headerTableEntry">0</td>
            <td class="headerTableEntry">2045</td>
            <td class="headerTableEntry" style="background-color:LightPink">0.0 %</td>
          </tr>
          <tr>
            <td class="headerName">Date:</td>
            <td class="headerValue">2020-06-22 17:45:28</td>
            <td></td>
            <td class="headerName">Branches:</td>
            <td class="headerTableEntry">0</td>
            <td class="headerTableEntry">19784</td>
            <td class="headerTableEntry" style="background-color:LightPink">0.0 %</td>
          </tr>
        </table>
      </td>
    </tr>

    <tr><td class="hr"></td></tr>
  </table>

  <br>
  <table cellspacing="0" cellpadding="1">
    <tr>
      <td width="5%" align="right" class="srcHeader">Line</td>
      <td width="5%" align="right" class="srcHeader">Branch</td>
      <td width="5%" align="right" class="srcHeader">Exec</td>
      <td width="75%" align="left" class="srcHeader src">Source</td>
    </tr>


    <tr>
    <td align="right" class="lineno"><pre>1</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      module cldwat2m_micro</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!---------------------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Purpose:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   CAM Interface for microphysics</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>6</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>7</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Author: Andrew Gettelman, Hugh Morrison.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>8</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Contributions from: Xiaohong Liu and Steve Ghan</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>9</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! December 2005-May 2010</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>10</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Description in: Morrison and Gettelman, 2008. J. Climate (MG2008)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>11</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                 Gettelman et al., 2010 J. Geophys. Res. - Atmospheres (G2010)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>12</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for questions contact Hugh Morrison, Andrew Gettelman</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>13</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! e-mail: morrison@ucar.edu, andrew@ucar.edu</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>14</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!---------------------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>15</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>16</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef NEMS_GSM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>17</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use machine,       only : r8 => kind_phys</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>18</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use physcons, gravit => con_g,    rair    => con_rd,             &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>19</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;               rh2o   => con_rv,   epsilon => con_eps,            &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>20</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;               tmelt  => con_tice, cpair   => con_cp,             &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>21</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;               latvap => con_hvap, latice  => con_hfus,           &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>22</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;               pi => con_pi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>23</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use wv_saturation, only : estblf, hlatv, tmin, hlatf, rgasv, pcf,&amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>24</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                           epsqs, ttrice, vqsatd2,cp,             &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>25</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                           vqsatd2_single,polysvp,gestbl</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>26</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use funcphys,      only : fpvs, fpvsl, fpvsi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>27</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>28</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>29</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef GEOS5</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>30</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use MAPL_ConstantsMod, r8 => MAPL_R8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>31</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use wv_saturation,    only: estblf, hlatv, tmin, hlatf, rgasv,   &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>32</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                             pcf, cp, epsqs, ttrice, vqsatd2,     &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>33</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                             vqsatd2_single,polysvp,gestbl</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>34</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>35</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>36</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>37</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use shr_kind_mod,     only: r8=>shr_kind_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>38</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use spmd_utils,       only: masterproc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>39</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use ppgrid,           only: pcols, pver, pverp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>40</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use physconst,        only: gravit, rair, tmelt, cpair, rh2o,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>41</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                             r_universal, mwh2o, rhoh2o</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>42</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use physconst,        only: latvap, latice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>43</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use abortutils,       only: endrun</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>44</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use error_function,   only: erf,erfc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>45</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use wv_saturation,    only: estblf, hlatv, tmin, hlatf, rgasv,   &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>46</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                             pcf, cp, epsqs, ttrice, vqsatd2,     &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>47</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                             vqsatd2_single,polysvp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>48</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use cam_history,      only: addfld, add_default, phys_decomp,    &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>49</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                             outfld</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>50</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use cam_logfile,      only: iulog</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>51</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use rad_constituents, only: rad_cnst_get_clim_info,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>52</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                             rad_cnst_get_clim_aer_props</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>53</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use phys_control,     only: phys_getopts</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>54</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use cldwat2m_macro,   only: rhmini, rhmaxi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>55</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>56</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>57</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>58</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      implicit none</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>59</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>60</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: zero=0.0_r8,  one=1.0_r8,  two=2.0_r8     &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>61</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                       three=3.0_r8, four=4.0_r8, five=5.0_r8    &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>62</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                       half=0.5_r8,  oneb3=one/three             &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>63</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                       onebcp=one/cpair</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>64</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef NEMS_GSM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>65</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>66</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer,  parameter :: iulog = 6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>67</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>68</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rhmini = 0.80_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>69</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rhmaxi = 1.1_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>70</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      real(r8), parameter :: r_universal = 6.02214e26*1.38065e-23</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>71</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      real(r8), parameter :: r_universal = con_rgas * 1000.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>72</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: mwh2o   = 18.016</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>73</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rhoh2o  = 1.000e3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>74</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>75</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical  :: ip = .true.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>76</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: tmn = 173.16_r8, tmx = 375.16_r8, trice = 35.00_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>77</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>78</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>79</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>80</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef GEOS5</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>81</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!++jtb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>82</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>83</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rhmini = 0.80_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>84</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rhmaxi = 1.1_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>85</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer,  parameter :: iulog = 6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>86</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>87</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>88</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>89</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: gravit = MAPL_GRAV</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>90</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rair = MAPL_RGAS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>91</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: tmelt = MAPL_TICE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>92</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: cpair = MAPL_CP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>93</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rh2o = MAPL_RVAP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>94</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: r_universal = MAPL_RUNIV</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>95</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: mwh2o = MAPL_H2OMW</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>96</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: rhoh2o = MAPL_RHOWTR</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>97</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: latvap = MAPL_ALHL</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>98</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: latice = MAPL_ALHF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>99</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: epsilon = MAPL_VIREPS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>100</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>101</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>102</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical  :: ip    = .true.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>103</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: tmn   = 173.16_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>104</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: tmx   = 375.16_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>105</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: trice = 35.00_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>106</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>107</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!--jtb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>108</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>109</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>110</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       private</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>111</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      save</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>112</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>113</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical, public :: liu_in = .false.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>114</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>115</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>116</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       public :: ini_micro, mmicro_pcond,gamma,derf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>117</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>118</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!constants remaped</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>119</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: g, ginv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>120</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: r</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>121</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: rv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>122</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      real(r8), private:: rr             ! not used</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>123</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>124</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: rhow, pirhow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>125</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: xxlv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>126</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: xlf, xlfocp, cpoxlf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>127</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), private:: xxls</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>128</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>129</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: rhosn, pirhosn</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>130</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: rhoi,  pirhoi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>131</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>132</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: ac,bc,as,bs,ai,bi,ar,br</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>133</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: ci,di,oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>134</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: cs,ds</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>135</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: cr,dr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>136</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: f1s,f2s</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>137</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: Eii</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>138</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: Ecc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>139</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: Ecr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>140</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: f1r,f2r</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>141</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: DCS, ts_auto_ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>142</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: qsmall</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>143</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: qvsmall</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>144</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: bimm,aimm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>145</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: rhosu</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>146</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: mi0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>147</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: rin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>148</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: qcvar</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>149</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     real(r8), private:: pi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>150</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>151</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Additional constants to help speed up code</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>152</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>153</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: cons1,  cons2,  cons3,  cons4,  cons5</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>154</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                   cons6,  cons7,  cons8,  cons9,  cons10</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>155</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                   cons11, cons12, cons13, cons14, cons15</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>156</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                   cons16, cons17, cons18, cons19, cons20</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>157</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                   cons21, cons22, cons23, cons24, cons25</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>158</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                   cons27, cons28</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>159</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>160</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: lammini, lammaxi, lamminr, lammaxr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>161</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                   lammins, lammaxs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>162</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>163</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! parameters for snow/rain fraction for convective clouds</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>164</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private, parameter :: tmax_fsnow = tmelt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>165</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                               tmin_fsnow = tmelt-5._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>166</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>167</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!needed for findsp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>168</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: tt0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>169</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>170</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!switch for specification of droplet and crystal number</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>171</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>172</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      real(r8), private:: csmin,csmax,minrefl,mindbz</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>173</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>174</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>175</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       contains</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>176</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>177</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!===============================================================================</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>178</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>179</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      subroutine ini_micro(Dcs_, QCVAR_, ts_auto_ice_)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>180</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>181</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>182</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>183</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Purpose:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>184</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize constants for the morrison microphysics</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>185</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! called from stratiform.F90</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>186</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>187</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Author: Andrew Gettelman Dec 2005</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>188</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>189</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>190</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>191</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>192</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use cloud_fraction, only: cldfrc_getparams</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>193</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>194</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: Dcs_, QCVAR_, ts_auto_ice_</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>195</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>196</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>197</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer k, l, m, iaer</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>198</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) surften, arg, derf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>199</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>200</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       character(len=16) :: eddy_scheme = ' '</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>201</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical           :: history_microphysics</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>202</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>203</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>204</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>205</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>206</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>207</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call phys_getopts(eddy_scheme_out = eddy_scheme,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>208</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; history_microphysics_out = history_microphysics )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>209</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>210</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>211</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('QRAIN ','kg/kg ',pver, 'A','Diagnostic grid-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>212</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;mean rain mixing ratio' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>213</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('QSNOW ','kg/kg ',pver, 'A','Diagnostic grid-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>214</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;mean snow mixing ratio' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>215</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('NRAIN ','m-3 ',pver, 'A','Diagnostic grid-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>216</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;mean rain number conc' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>217</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('NSNOW ','m-3 ',pver, 'A','Diagnostic grid-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>218</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;mean snow number conc' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>219</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>220</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>221</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('RERCLD ','m ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>222</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Diagnostic effective radius of Liquid Cloud and Rain' ,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>223</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>224</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>225</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('DSNOW ','m ',pver, 'A','Diagnostic grid-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>226</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;mean snow diameter' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>227</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>228</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>229</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('MGFLXPRC ','kg/m2/s ',pver+1, 'A','Diagnostic grid-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>230</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;mean rain flux at layer interface', phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>231</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('MGFLXSNW ','kg/m2/s ',pver+1, 'A','Diagnostic grid-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>232</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;mean snow flux at layer interface', phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>233</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>234</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>235</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('REFL ','DBz ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>236</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'94 GHz radar reflectivity' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>237</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('AREFL ','DBz ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>238</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average 94 GHz radar reflectivity' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>239</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('FREFL ','fraction ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>240</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Fractional occurance of radar reflectivity' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>241</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>242</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('CSRFL ','DBz ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>243</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'94 GHz radar reflectivity (CloudSat thresholds)' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>244</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('ACSRFL ','DBz ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>245</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average 94 GHz radar reflectivity (CloudSat thresholds)' ,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>246</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>247</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('FCSRFL ','fraction ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>248</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Fractional occurance of radar reflectivity (CloudSat thresholds)'</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>249</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>250</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>251</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('AREFLZ ','mm^6/m^3 ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>252</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average 94 GHz radar reflectivity' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>253</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>254</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>255</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('NCAL ','#/m3 ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>256</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Number Concentation Activated for Liquid',phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>257</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('NCAI ','#/m3 ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>258</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Number Concentation Activated for Ice',phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>259</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>260</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>261</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>262</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('AQRAIN ','kg/kg ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>263</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average rain mixing ratio' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>264</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('AQSNOW ','kg/kg ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>265</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average snow mixing ratio' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>266</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('ANRAIN ','m-3 ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>267</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average rain number conc' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>268</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('ANSNOW ','m-3 ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>269</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average snow number conc' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>270</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('ADRAIN ','Micron ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>271</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average rain effective Diameter' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>272</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('ADSNOW ','Micron ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>273</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Average snow effective Diameter' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>274</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('FREQR ','fraction ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>275</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Fractional occurance of rain' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>276</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call addfld ('FREQS ','fraction ',pver, 'A',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>277</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;'Fractional occurance of snow' ,phys_decomp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>278</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>279</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if ( history_microphysics) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>280</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call add_default ('AQSNOW ', 1, ' ')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>281</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call add_default ('FREQR ', 1, ' ')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>282</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call add_default ('FREQS ', 1, ' ')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>283</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call add_default ('AQRAIN ', 1, ' ')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>284</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call add_default ('AQSNOW ', 1, ' ')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>285</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call add_default ('ANRAIN ', 1, ' ')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>286</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call add_default ('ANSNOW ', 1, ' ')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>287</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>288</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>289</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>290</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!--jtb commented out when GEOS5</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>291</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>292</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!declarations for morrison codes (transforms variable names)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>293</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>294</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       g    = gravit</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>295</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ginv = one / g</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>296</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       r    = rair</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>297</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       rv   = rh2o</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>298</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      rr   = r_universal</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>299</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cpp  = cpair</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>300</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cp  = cpair</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>301</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       rhow = rhoh2o</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>302</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>303</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! latent heats</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>304</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>305</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       xxlv   = latvap</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>306</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       xlf    = latice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>307</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       xxls   = xxlv + xlf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>308</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       xlfocp = xlf  / cpair</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>309</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cpoxlf = cpair / xlf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>310</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>311</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      write(0,*)' xlfocp=',xlfocp,' cpoxlf=',cpoxlf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>312</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! parameters below from Reisner et al. (1998)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>313</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! density parameters (kg/m3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>314</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>315</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       rhosn = 100._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>316</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       rhoi  = 500._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>317</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       rhow  = 1000._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>318</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>319</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>320</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! fall speed parameters, V = aD^b</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>321</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! V is in m/s</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>322</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>323</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! droplets</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>324</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ac = 3.e7_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>325</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       bc = two</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>326</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>327</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>328</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       as = 11.72_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>329</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       bs = 0.41_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>330</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>331</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cloud ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>332</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ai = 700._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>333</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       bi = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>334</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>335</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>336</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ar = 841.99667_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>337</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       br = 0.8_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>338</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>339</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! particle mass-diameter relationship</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>340</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! currently we assume spherical particles for cloud ice/snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>341</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! m = cD^d</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>342</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>343</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      pi= 3.1415927_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>344</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      pi= 3.1415926535897931_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>345</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>346</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      pi = four*atan(one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>347</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>348</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       pirhow  = pi * rhow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>349</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       pirhosn = pi * rhosn</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>350</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       pirhoi  = pi * rhoi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>351</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>352</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cloud ice mass-diameter relationship</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>353</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>354</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ci     = pirhoi/6._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>355</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       di     = three</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>356</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       oneodi = one / di</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>357</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>358</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! snow mass-diameter relationship</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>359</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>360</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cs = pirhosn/6._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>361</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ds = three</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>362</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>363</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! drop mass-diameter relationship</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>364</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>365</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cr = pirhow/6._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>366</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       dr = three</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>367</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>368</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ventilation parameters for snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>369</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! hall and prupacher</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>370</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>371</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       f1s = 0.86_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>372</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       f2s = 0.28_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>373</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>374</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! collection efficiency, aggregation of cloud ice and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>375</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>376</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       Eii = 0.1_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>377</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>378</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! collection efficiency, accretion of cloud water by rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>379</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>380</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       Ecr = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>381</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>382</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ventilation constants for rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>383</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>384</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       f1r = 0.78_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>385</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       f2r = 0.32_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>386</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>387</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! autoconversion size threshold for cloud ice to snow (m)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>388</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>389</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       Dcs = Dcs_ * 1.0e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>390</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ice autoconversion time scale (default 180s)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>391</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>392</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ts_auto_ice = ts_auto_ice_</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>393</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>394</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! smallest mixing ratio considered in microphysics</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>395</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>396</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       qsmall  = 1.e-18_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>397</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       qvsmall = 1.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>398</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>399</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! immersion freezing parameters, bigg 1953</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>400</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>401</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       bimm = 100._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>402</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       aimm = 0.66_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>403</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>404</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! typical air density at 850 mb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>405</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>406</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       rhosu = 85000._r8/(rair * tmelt)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>407</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>408</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! mass of new crystal due to aerosol freezing and growth (kg)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>409</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>410</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mi0 = (four/three)*pirhoi*(10.e-6_r8)*(10.e-6_r8)*(10.e-6_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>411</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>412</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>413</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! radius of contact nuclei aerosol (m)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>414</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>415</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       rin = 0.1e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>416</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>417</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! 1 / relative variance of sub-grid cloud water distribution</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>418</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! see morrison and gettelman, 2008, J. Climate for details</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>419</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>420</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>421</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>422</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       qcvar = QCVAR_</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>423</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>424</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! freezing temperature</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>425</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       tt0  = 273.15_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>426</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>427</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>428</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!++jtb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>429</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       tmn   = 173.16_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>430</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       tmx   = 375.16_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>431</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       trice = 35.00_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>432</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ip    = .true.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>433</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>434</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call gestbl(tmn ,tmx ,trice ,ip ,epsilon , latvap ,latice ,rh2o ,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>435</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             cpair ,tmelt )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>436</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>437</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!--jtb (08/18/10)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>438</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>439</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      pi = 4._r8*atan(1.0_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>440</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>441</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>442</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       csmin   = -30._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>443</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       csmax   =  26._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>444</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mindbz  = -99._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>445</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>446</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       minrefl = 1.26e-10_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>447</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>448</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Define constants to help speed up code (limit calls to gamma function)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>449</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>450</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons1   = gamma(one+di)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>451</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      cons1   = gamma(one+miu_ice+ di)/gamma(one+miu_ice)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>452</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>453</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons2   = gamma(qcvar+2.47_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>454</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons3   = gamma(qcvar)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>455</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons4   = gamma(one+br)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>456</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons5   = gamma(four+br)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>457</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons6   = gamma(one+ds)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>458</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons7   = gamma(one+bs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>459</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons8   = gamma(four+bs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>460</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons9   = gamma(qcvar+two)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>461</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons10  = gamma(qcvar+one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>462</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons11  = gamma(three+bs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>463</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons12  = gamma(qcvar+1.15_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>464</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons13  = gamma((five+br)*half)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>465</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons14  = gamma((five+bs)*half)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>466</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons15  = gamma(qcvar+bc/three)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>467</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>468</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>469</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>470</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>471</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>472</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons18  = qcvar**2.47_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>473</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons19  = qcvar*qcvar</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>474</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons20  = qcvar**1.15_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>475</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons21  = qcvar**(bc/three)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>476</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons22  = (four/three)*pirhow*(25.e-6_r8)**3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>477</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons23  = dcs*dcs*dcs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>478</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons24  = dcs*dcs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>479</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons25  = dcs**bs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>480</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons27  = xxlv*xxlv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>481</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       cons28  = xxls*xxls</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>482</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>483</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lammaxi = one / 1.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>484</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lammini = one / (one*dcs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>485</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lammaxr = one / 20.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>486</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lamminr = one / 500.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>487</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lammaxs = one / 10.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>488</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lammins = one / 2000.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>489</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>490</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       return</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>491</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end subroutine ini_micro</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>492</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>493</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!===============================================================================</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>494</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!microphysics routine for each timestep goes here...</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>495</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>496</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      subroutine mmicro_pcond ( lchnk, ncol, deltatin, tn, ttend,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>497</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; pcols, pver,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>498</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; qn, qtend, cwtend, qc, qi, nc, ni,fprcp,qrn,qsnw,nrn,nsnw,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>499</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; p, pdel, cldn, liqcldf,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>500</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; icecldf, cldo, pint, rpdel, zm,        rate1ord_cw2pr_st, naai,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>501</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; icecldf, cldo, pint, rpdel, zm, omega, rate1ord_cw2pr_st, naai,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>502</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; npccnin, rndst,nacon, rhdfda, rhu00, fice, tlat, qvlat, qctend,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>503</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; qitend, nctend, nitend, effc, effc_fn, effi, prect, preci,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>504</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; nevapr, evapsnow, prain, prodsnow, cmeout, deffi, pgamrad,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>505</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; lamcrad,qsout2,dsout2,qrout2, drout2, qcsevap,qisevap,qvres,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>506</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; cmeiout, vtrmc,vtrmi,qcsedten,qisedten, prao,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>507</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; prco,mnuccco,mnuccto,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>508</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; msacwio,psacwso, bergso,bergo,melto,homoo,qcreso,prcio,praio,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>509</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; qireso, mnuccro,pracso,meltsdt,frzrdt, ncal, ncai, mnuccdo,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>510</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; nnuccto,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>511</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; nsout2, nrout2, ncnst, ninst, nimm, miu_disp, nsoot, rnsoot,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>512</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; ui_scale, dcrit, nnuccdo, nnuccco, nsacwio, nsubio, nprcio,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>513</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; npraio, npccno, npsacwso, nsubco, nprao, nprc1o, tlataux,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>514</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; nbincontactdust, lprint, xlat, xlon, rhc)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>515</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; nbincontactdust, ts_auto_ice,xlat,xlon)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>516</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>517</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>518</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Author: Hugh Morrison, Andrew Gettelman, NCAR</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>519</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! e-mail: morrison@ucar.edu, andrew@ucar.edu</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>520</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>521</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use wv_saturation, only: vqsatd, vqsatd_water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>522</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>523</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>524</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       use constituents, only: pcnst</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>525</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: ncnst = 100.0e6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>526</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: ninst = 0.10e6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>527</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>528</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>529</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!--jtb (08/18/10) Is this still needed? Pcnst is not used.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>530</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>531</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer,  intent (in) :: pcols, pver,fprcp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>532</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent (in) :: ncnst</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>533</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent (in) :: ninst</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>534</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent (in) :: nimm (pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>535</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent (in) :: miu_disp , ui_scale, dcrit</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>536</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      real(r8), intent (in) :: miu_disp , ui_scale, dcrit, ts_auto_ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>537</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent (in) :: nsoot (pcols,pver) , rnsoot (pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>538</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;     ,xlon,xlat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>539</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      integer,  intent(in)  :: ktrop_min</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>540</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>541</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>542</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical lprint</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>543</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>544</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>545</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer, intent(in)  :: lchnk</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>546</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer, intent(in)  :: ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>547</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: deltatin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>548</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: tn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>549</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: ttend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>550</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: qn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>551</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: qtend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>552</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: cwtend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>553</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>554</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: qc(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>555</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: qi(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>556</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: nc(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>557</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: ni(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>558</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: qrn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>559</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: qsnw(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>560</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: nrn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>561</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: nsnw(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>562</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: p(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>563</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: pdel(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>564</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: cldn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>565</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: icecldf(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>566</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: liqcldf(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>567</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: cldo(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>568</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: pint(pcols,pver+1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>569</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>570</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: rpdel(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>571</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: zm(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>572</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      real(r8), intent(in)    :: omega(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>573</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: rhc(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>574</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>575</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out)   :: rate1ord_cw2pr_st(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>576</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>577</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Inputs for aerosol activation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>578</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in)    :: naai(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>579</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(inout) :: npccnin(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>580</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer                 :: nbincontactdust</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>581</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in), dimension(pcols,pver, 10) :: rndst, nacon</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>582</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>583</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>584</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: rhdfda(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>585</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: rhu00(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>586</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: fice(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>587</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>588</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: tlat(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>589</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>590</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: tlataux(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>591</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>592</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qvlat(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>593</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qctend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>594</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qitend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>595</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nctend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>596</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nitend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>597</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: effc(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>598</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: effc_fn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>599</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: effi(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>600</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: prect(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>601</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: preci(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>602</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nevapr(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>603</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: evapsnow(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>604</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: prain(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>605</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: prodsnow(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>606</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: cmeout(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>607</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: deffi(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>608</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: pgamrad(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>609</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: lamcrad(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>610</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>611</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qcsevap(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>612</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qisevap(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>613</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qvres(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>614</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: cmeiout(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>615</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: vtrmc(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>616</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: vtrmi(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>617</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qcsedten(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>618</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qisedten(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>619</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! microphysical process rates for output (mixing ratio tendencies)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>620</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: prao(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>621</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: prco(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>622</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: mnuccco(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>623</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: mnuccto(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>624</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: msacwio(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>625</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: psacwso(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>626</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: bergso(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>627</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: bergo(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>628</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: melto(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>629</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: homoo(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>630</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qcreso(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>631</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: prcio(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>632</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: praio(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>633</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qireso(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>634</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: mnuccro(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>635</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: pracso (pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>636</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: meltsdt(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>637</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: frzrdt (pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>638</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: mnuccdo(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>639</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nnuccto(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>640</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>641</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nnuccdo(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>642</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nnuccco(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>643</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nsacwio(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>644</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nsubio(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>645</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nprcio(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>646</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: npraio(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>647</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>648</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: npccno(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>649</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: npsacwso(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>650</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nsubco(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>651</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nprao(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>652</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: nprc1o(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>653</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>654</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! local workspace</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>655</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! all units mks unless otherwise stated</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>656</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>657</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! temporary variables for sub-stepping</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>658</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>659</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: t1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>660</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: q1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>661</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qc1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>662</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qi1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>663</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nc1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>664</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ni1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>665</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: tlat1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>666</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qvlat1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>667</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qctend1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>668</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qitend1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>669</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nctend1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>670</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nitend1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>671</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: prect1(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>672</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: preci1(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>673</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>674</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: tlat1_aux(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>675</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>676</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>677</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! hm 5/12/11</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>678</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! temporary variable for old nc before updating with activation tendency</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>679</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ncold(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>680</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>681</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>682</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: deltat, dti, deltam</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>683</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>684</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dto2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>685</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: mincld</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>686</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8), dimension(pcols,pver) :: q, t, rho, irho, rhof, dv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>687</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,                                   mu, sc, kap, cldmax, cldm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>688</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,                                   icldm, lcldm, cme, cmei</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>689</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,                                   cwml, cwmi, lcldn, lcldo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>690</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,                                   nctend_mixnuc, npccn</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>691</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>692</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), dimension(pcols)      :: icwc, calpha, cbeta, cbetah</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>693</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                                   cgamma, cgamah, rcgama</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>694</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                                   cmec1, cmec2, cmec3, cmec4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>695</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>696</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8), dimension(pver)       :: nnuccd, mnuccd</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>697</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,                                   qcsinksum_rate1ord</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>698</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,                                   qcsum_rate1ord</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>699</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>700</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8)                        :: qtmp, dum, dum1, dum2, qcld</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>701</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;,                                   arg, alpha</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>702</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>703</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>704</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qcic(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>705</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qiic(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>706</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qniic(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>707</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qric(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>708</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ncic(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>709</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: niic(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>710</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsic(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>711</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nric(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>712</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: lami(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>713</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: n0i(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>714</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: lamc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>715</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: n0c(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>716</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: lams(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>717</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: n0s(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>718</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: lamr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>719</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: n0r(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>720</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: cdist1(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>721</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! combined size of precip &amp; cloud drops</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>722</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: rercld(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>723</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: arcld(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>724</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: Actmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>725</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: Artmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>726</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>727</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: pgam(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>728</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: lammax</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>729</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: lammin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>730</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: nacnt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>731</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: mnuccc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>732</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nnuccc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>733</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>734</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: mnucct(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>735</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nnucct(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>736</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: msacwi(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>737</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsacwi(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>738</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>739</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: prc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>740</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nprc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>741</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nprc1(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>742</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsagg(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>743</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dc0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>744</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ds0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>745</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: eci</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>746</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: psacws(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>747</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: npsacws(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>748</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: uni</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>749</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: umi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>750</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: uns(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>751</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ums(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>752</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: unr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>753</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: umr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>754</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: unc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>755</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: umc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>756</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: pracs(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>757</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: npracs(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>758</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: mnuccr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>759</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nnuccr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>760</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: pra(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>761</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: npra(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>762</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nragg(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>763</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: prci(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>764</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nprci(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>765</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: prai(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>766</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nprai(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>767</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qvs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>768</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qvi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>769</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dqsdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>770</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dqsidt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>771</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ab</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>772</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qclr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>773</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: abi,oneoabi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>774</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: epss</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>775</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: epsr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>776</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: pre(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>777</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: prds(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>778</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qce</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>779</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qie</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>780</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nce</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>781</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nie</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>782</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>783</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dumc(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>784</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dumnc(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>785</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dumi(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>786</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dumni(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>787</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: dums(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>788</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: dumns(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>789</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: dumr(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>790</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: dumnr(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>791</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! below are parameters for cloud water and cloud ice sedimentation calculations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>792</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: fr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>793</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: fnr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>794</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: fc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>795</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: fnc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>796</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: fi(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>797</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: fni(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>798</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: fs(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>799</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: fns(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>800</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: faloutr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>801</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: faloutnr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>802</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faloutc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>803</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faloutnc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>804</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: falouti(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>805</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faloutni(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>806</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: falouts(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>807</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: faloutns(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>808</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: faltndr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>809</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: faltndnr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>810</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faltndc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>811</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faltndnc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>812</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faltndi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>813</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faltndni</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>814</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: faltnds</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>815</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: faltndns</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>816</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faltndqie</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>817</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: faltndqce</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>818</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>819</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: relhum(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>820</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: csigma(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>821</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: rgvm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>822</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: arn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>823</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: asn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>824</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: acn(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>825</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ain(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>826</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsubi(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>827</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsubc(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>828</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsubs(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>829</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsubr(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>830</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: mtime</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>831</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dz(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>832</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>833</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!fice variable</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>834</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nfice(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>835</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>836</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!add variables for rain and snow flux at layer interfaces</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>837</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: rflx(pcols,pver+1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>838</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: sflx(pcols,pver+1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>839</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>840</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: rflx1(pcols,pver+1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>841</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: sflx1(pcols,pver+1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>842</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>843</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! returns from function/subroutine calls</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>844</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: tsp(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>845</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: qsp(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>846</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: qsphy(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>847</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qs(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>848</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: es(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>849</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: esl(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>850</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: esi(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>851</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      real(r8) :: gammas(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>852</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>853</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sum of source/sink terms for diagnostic precip</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>854</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>855</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qnitend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>856</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nstend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>857</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qrtend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>858</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nrtend(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>859</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qrtot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>860</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nrtot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>861</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qstot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>862</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nstot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>863</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>864</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! new terms for Bergeron process</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>865</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>866</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dumnnuc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>867</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ninew</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>868</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qinew</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>869</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qvl</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>870</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: epsi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>871</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: prd</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>872</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: berg(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>873</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: bergs(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>874</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>875</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!bergeron terms</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>876</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: bergtsf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>877</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: rhin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>878</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>879</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! diagnostic rain/snow for output to history</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>880</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! values are in-precip (local) !!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>881</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>882</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qrout(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>883</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nrout(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>884</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nsout(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>885</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dsout(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>886</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qsout(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>887</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>888</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>889</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!averageed rain/snow for history</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>890</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) , intent(out) :: qrout2(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>891</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) , intent(out) :: qsout2(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>892</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) , intent(out) :: nrout2(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>893</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) , intent(out) :: nsout2(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>894</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: freqs(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>895</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: freqr(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>896</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dumfice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>897</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out), dimension(pcols,pver) :: drout2, dsout2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>898</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>899</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ice nucleation, droplet activation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>900</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dum2i(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>901</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: dum2l(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>902</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ncmax(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>903</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: nimax</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>904</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>905</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!output fields for number conc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>906</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: ncai(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>907</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: ncal(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>908</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>909</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! loop array variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>910</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       integer i,k,nstep,n, l</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>911</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       integer ii,kk, m, ind_aux, km, kp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>912</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>913</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! loop variables for sub-step solution</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>914</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       integer iter,it,ltrue(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>915</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>916</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! used in contact freezing via dust particles</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>917</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) tcnt, viscosity, mfp, nslipsoot, ndfaersoot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>918</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8), dimension(nbincontactdust) :: ndfaer, nslip, slip</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>919</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>920</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>921</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! used in ice effective radius</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>922</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) bbi, cci, ak, iciwc, rvi, riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>923</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>924</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! used in Bergeron processe and water vapor deposition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>925</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) Tk, deles, Aprpr, Bprpr, Cice, qi0, Crate, qidep</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>926</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>927</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! mean cloud fraction over the time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>928</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) cldmw(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>929</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>930</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! used in secondary ice production</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>931</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) ni_secp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>932</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>933</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! variabels to check for RH after rain evap</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>934</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>935</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: esn</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>936</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: qsn</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>937</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: ttmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>938</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>939</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>940</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: refl(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>941</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: rainrt(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>942</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: rainrt1(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>943</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: csrfl(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>944</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: arefl(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>945</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: acsrfl(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>946</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: frefl(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>947</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: fcsrfl(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>948</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: areflz(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>949</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: tmp, miu_ice(pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>950</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: cons16</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>951</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: cons17</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>952</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>953</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dmc,ssmc,dstrn</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>954</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>955</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: cdnl = 0.e6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>956</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>957</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      integer,  parameter :: auto_option=3     ! dcrit only used with auto_option=4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>958</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      integer,  parameter :: auto_option=2     ! dcrit only used with auto_option=4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>959</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer,  parameter :: auto_option=1     ! dcrit only used with auto_option=4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>960</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      integer,  parameter :: auto_option=4     ! dcrit only used with auto_option=4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>961</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       real(r8) :: beta6, xs, nssoot, nsdust, taux, psc, Bh, vaux, aux,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>962</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             LW, NW, tx1, tx2, tx3, tx4, tx5, omeps, esloesi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>963</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,            rdz, rdzi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>964</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>965</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>966</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: number will be adjusted as needed to keep mean size within bounds,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>967</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! even when cosntant droplet or ice number is used</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>968</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>969</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ***note: Even if constant cloud ice number is set, ice number is allowed</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>970</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! to evolve based on process rates. This is needed in order to calculate</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>971</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! the change in mass due to ice nucleation. All other ice microphysical</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>972</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! processes are consistent with the specified constant ice number if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>973</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! this switch is turned on.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>974</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>975</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       logical :: nccons,nicons</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>976</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>977</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>978</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       omeps  = one - epsqs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>979</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>980</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       nccons = .false.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>981</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       nicons = .false.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>982</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>983</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>984</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize  output fields for number conc qand ice nucleation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>985</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>986</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         miu_ice(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>987</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>988</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>989</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i=1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>990</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           ncai(i,k)      = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>991</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           ncal(i,k)      = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>992</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>993</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Initialize rain size</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>994</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           rercld(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>995</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           arcld(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>996</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>997</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!initialize radiation output variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>998</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           pgamrad(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>999</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           lamcrad(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1000</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           deffi (i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1001</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!initialize radiation output variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1002</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!initialize water vapor tendency term output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1003</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qcsevap(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1004</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qisevap(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1005</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qvres (i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1006</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cmeiout (i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1007</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           vtrmc (i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1008</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           vtrmi (i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1009</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qcsedten (i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1010</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qisedten (i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1011</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1012</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prao(i,k)      = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1013</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prco(i,k)      = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1014</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1015</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           mnuccco(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1016</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           mnuccto(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1017</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           msacwio(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1018</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           psacwso(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1019</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           bergso(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1020</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           bergo(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1021</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           melto(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1022</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           homoo(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1023</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qcreso(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1024</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prcio(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1025</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           praio(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1026</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qireso(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1027</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           mnuccro(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1028</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           pracso (i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1029</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           meltsdt(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1030</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           frzrdt (i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1031</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           mnuccdo(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1032</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nnuccto(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1033</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1034</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1035</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nnuccdo(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1036</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nnuccco(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1037</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nsacwio(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1038</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nsubio(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1039</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nprcio(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1040</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           npraio(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1041</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1042</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           npccno(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1043</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           npsacwso(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1044</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nsubco(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1045</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nprao(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1046</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nprc1o(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1047</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1048</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1049</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1050</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assign variable deltat for sub-stepping...</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1051</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       deltat = deltatin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1052</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       dti    = one / deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1053</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       deltam = one / max(deltat, 150.0_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1054</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1055</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! parameters for scheme</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1056</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1057</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      omsm   = 0.99999_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1058</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       omsm   = 0.99999999_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1059</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       dto2   = 0.5_r8*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1060</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mincld = 0.00001_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1061</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1062</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize time-varying parameters</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1063</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1064</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1065</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i=1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1066</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1067</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize multi-level fields</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1068</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           t(i,k)    = tn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1069</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           q(i,k)    = qn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1070</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           rho(i,k)  = p(i,k) / (r*t(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1071</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           irho(i,k) = one / rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1072</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dv(i,k)   = 8.794E-5_r8*t(i,k)**1.81_r8/p(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1073</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tx1       = t(i,k) * sqrt(t(i,k)) / (t(i,k)+120._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1074</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           mu(i,k)   = 1.496E-6_r8 * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1075</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           sc(i,k)   = mu(i,k)/(rho(i,k)*dv(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1076</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           kap(i,k)  = 1.414e3_r8 * 1.496e-6_r8 * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1077</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1078</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! air density adjustment for fallspeed parameters</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1079</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! includes air density correction factor to the</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1080</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! power of 0.54 following Heymsfield and Bansemer 2007</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1081</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1082</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           rhof(i,k) = (rhosu*irho(i,k))**0.54</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1083</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1084</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           arn(i,k)  = ar * rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1085</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           asn(i,k)  = as * rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1086</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           acn(i,k)  = ac * rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1087</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           ain(i,k)  = ai * rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1088</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1089</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get dz from dp and hydrostatic approx</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1090</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! keep dz positive (define as layer k-1 - layer k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1091</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1092</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dz(i,k)   = pdel(i,k) * irho(i,k) * ginv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1093</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1094</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1095</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! droplet activation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1096</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! hm, modify 5/12/11</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1097</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get provisional droplet number after activation. This is used for</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1098</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! all microphysical process calculations, for consistency with update of</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1099</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! droplet mass before microphysics</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1100</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1101</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate potential for droplet activation if cloud water is present</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1102</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! tendency from activation (npccnin) is read in from companion routine</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1103</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1104</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! hm note: npccn is no longer needed below this code - so this can</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1105</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! be rewwritten and this parameters can be removed</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1106</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1107</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           lcldm(i,k) = max(liqcldf(i,k),mincld)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1108</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1109</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             npccn(i,k) = max( (lcldm(i,k)*npccnin(i,k)-nc(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1110</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                          * deltam, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1111</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             ncold(i,k) = nc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1112</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nc(i,k)    = nc(i,k) + npccn(i,k)*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1113</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1114</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             npccn(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1115</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1116</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1117</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialization</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1118</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           t1(i,k)  = t(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1119</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           q1(i,k)  = q(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1120</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qc1(i,k) = qc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1121</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qi1(i,k) = qi(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1122</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nc1(i,k) = nc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1123</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           ni1(i,k) = ni(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1124</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1125</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize tendencies to zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1126</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tlat1(i,k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1127</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tlat1_aux(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1128</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1129</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qvlat1(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1130</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qctend1(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1131</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qitend1(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1132</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nctend1(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1133</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nitend1(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1134</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1135</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize precip output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1136</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qrout(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1137</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qsout(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1138</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nrout(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1139</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nsout(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1140</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dsout(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1141</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1142</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize variables for trop_mozart</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1143</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nevapr(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1144</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           evapsnow(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1145</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prain(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1146</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prodsnow(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1147</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cmeout(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1148</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1149</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for refl calc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1150</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           rainrt1(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1151</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1152</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize precip fraction and output tendencies</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1153</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cldmax(i,k) = mincld</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1154</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1155</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!initialize aerosol number</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1156</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          naer2(i,k,:) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1157</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dum2l(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1158</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dum2i(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1159</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           ncmax(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1160</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1161</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for debug purpose</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1162</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          prect(1:ncol)=0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1163</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          preci(1:ncol)=0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1164</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          tlat(1:ncol,1:pver)=0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1165</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          qvlat(1:ncol,1:pver)=0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1166</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          qctend(1:ncol,1:pver)=0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1167</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          qitend(1:ncol,1:pver)=0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1168</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          nctend(1:ncol,1:pver)=0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1169</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1170</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1171</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1172</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1173</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize avg precip rate</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1174</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do i=1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1175</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         prect1(i) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1176</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         preci1(i) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1177</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1178</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1179</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Get humidity and saturation vapor pressures  big loop1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1180</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1181</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver  ! big loop1 - k loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1182</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1183</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! find wet bulk temperature and saturation value for provisional t and q without</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1184</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! condensation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1185</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1186</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!        call vqsatd_water(t(1,k),p(1,k),es,qs,gammas,ncol)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1187</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1188</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i=1,ncol  ! big i loop1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1189</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1190</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef NEMS_GSM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1191</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           esl(i,k) = min(fpvsl(t(i,k)), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1192</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           esi(i,k) = min(fpvsi(t(i,k)), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1193</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1194</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           esl(i,k) = min(polysvp(t(i,k),0), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1195</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           esi(i,k) = min(polysvp(t(i,k),1), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1196</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1197</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1198</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           esloesi  = esl(i,k) / esi(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1199</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! hm fix, make sure when above freezing that esi=esl, not active yet</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1200</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (t(i,k) > tmelt) esi(i,k) = esl(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1201</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1202</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qs(i)       = epsqs*esl(i,k)/(p(i,k)-omeps*esl(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1203</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1204</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           relhum(i,k) = min(q(i,k)/qs(i), one) !Anning limiting relhum</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1205</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1206</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k==29) write(0,*)' esl=',esl(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1207</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' esi=',esi(i,k),' pres=',p(i,k),' t=',t(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1208</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' relhum=',relhum(i,k),' q=',q(i,k),' qs=',qs(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1209</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1210</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get cloud fraction, check for minimum</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1211</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1212</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cldm(i,k)  = max(cldn(i,k), mincld)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1213</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cldmw(i,k) = max(cldn(i,k), mincld)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1214</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1215</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           icldm(i,k) = max(icecldf(i,k), mincld)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1216</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           lcldm(i,k) = max(liqcldf(i,k), mincld)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1217</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1218</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1219</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1220</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1        = one / lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1221</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum2l(i,k) = (ncold(i,k)+npccn(i,k)*deltat) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1222</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum2l(i,k) = max(dum2l(i,k),cdnl*irho(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1223</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             ncmax(i,k) = max(dum2l(i,k)*lcldm(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1224</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum2l(i,k) = npccn(i,k)*deltat*tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1225</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1226</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum2l(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1227</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1228</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1229</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1230</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1231</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate nfice based on liquid and ice mmr (no rain and snow mmr available yet)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1232</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1233</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nfice(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1234</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dumfice    = qc(i,k) + qi(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1235</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (dumfice > qsmall .and. qi(i,k) > qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1236</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nfice(i,k) = qi(i,k)/dumfice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1237</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1238</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1239</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (t(i,k) &lt; tmelt - five) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1240</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (liu_in) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1241</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1242</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if aerosols interact with ice set number of activated ice nuclei</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1243</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum2 = naai(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1244</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1245</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1246</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cooper curve (factor of 1000 is to convert from L-1 to m-3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1247</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum2 = 0.005_r8*exp(0.304_r8*(273.15_r8-t(i,k)))*1000._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1248</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! put limit on number of nucleated crystals, set to number at T=-30 C</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1249</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cooper (limit to value at -35 C)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1250</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum2 = min(dum2, 208.9e3_r8)*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1251</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1252</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1253</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnnuc = max((dum2*icldm(i,k)-ni(i,k))*deltam, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1254</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1255</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1256</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get provisional ni and qi after nucleation in order to calculate</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1257</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Bergeron process below</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1258</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             ninew = ni(i,k) + dumnnuc*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1259</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qinew = qi(i,k) + dumnnuc*deltat*mi0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1260</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!T>268</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1261</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1262</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             ninew = ni(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1263</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qinew = qi(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1264</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1265</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1266</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Initialize CME components</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1267</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1268</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cme(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1269</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cmei(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1270</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1271</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1272</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1273</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Bergeron process</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1274</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure to initialize bergeron process to zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1275</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           berg(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1276</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prd       = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1277</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1278</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!condensation loop.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1279</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1280</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get in-cloud qi and ni after nucleation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1281</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (icldm(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1282</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1 = one / icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1283</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qiic(i,k) = qinew * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1284</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             niic(i,k) = ninew * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1285</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1286</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qiic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1287</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             niic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1288</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1289</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1290</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1291</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (nicons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1292</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             niic(i,k) = ninst*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1293</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1294</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1295</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1296</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1297</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!if T &lt; 0 C then bergeron.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1298</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (t(i,k) &lt; 273.15) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1299</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!if ice exists</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1300</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (qi(i,k) > qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1301</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1302</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               bergtsf = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1303</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1304</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qvi = epsqs*esi(i,k) / (p(i,k)-omeps*esi(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1305</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qvl = epsqs*esl(i,k) / (p(i,k)-omeps*esl(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1306</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1307</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dqsidt  = xxls*qvi / (rv*t(i,k)*t(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1308</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               abi     = one + dqsidt*xxls/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1309</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               oneoabi = one / abi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1310</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1311</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get ice size distribution parameters</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1312</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1313</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qiic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1314</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1315</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k) = (cons1*ci*niic(i,k)/qiic(i,k))**oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1316</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1317</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                miu_ice    = mui_hemp_l(lami(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1318</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 miu_ice(k) = max(min(0.008_r8*(lami(k)*0.01)**0.87_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1319</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                      10.0_r8), 0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1320</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1        = one + miu_ice(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1321</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2        = one / gamma(tx1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1322</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 aux        = (gamma(tx1+di)*tx2) ** oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1323</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k)    = aux*lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1324</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0i(k)     = niic(i,k) * lami(k)**tx1 * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1325</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1326</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1327</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1328</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1329</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (lami(k) &lt; lammini*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1330</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   miu_ice(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1331</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lami(k)    = lammini</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1332</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0i(k)     = lami(k)**(di+one)*qiic(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1333</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   niic(i,k)  = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1334</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 else if (lami(k) > lammaxi*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1335</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   miu_ice(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1336</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lami(k)    = lammaxi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1337</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0i(k)     = lami(k)**(di+one)*qiic(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1338</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   niic(i,k)  = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1339</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1340</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1341</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 epsi = (miu_ice(k)+two)*(miu_ice(k)+one)*pi*</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1342</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                  niic(i,k)*rho(i,k)*Dv(i,k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1343</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1344</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!if liquid exists</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1345</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qc(i,k) > qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1346</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1347</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!begin bergeron process</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1348</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     do bergeron (vapor deposition with RHw=1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1349</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     code to find berg (a rate) goes here</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1350</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1351</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate Bergeron process</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1352</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1353</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   prd = epsi*(qvl-qvi)*oneoabi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1354</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1355</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1356</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   prd = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1357</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1358</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1359</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! multiply by cloud fraction and transfer of existing cloud liquid to ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1360</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1361</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 berg(i,k) = max(zero, prd*min(icldm(i,k),lcldm(i,k)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1362</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1363</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if                  ! qiic(i,k) >= qsmall</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1364</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1365</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1366</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (berg(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1367</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1     = qc(i,k) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1368</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 bergtsf = max(zero, tx1/berg(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1369</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if(bergtsf &lt; one) berg(i,k) = max(zero, tx1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1370</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1371</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1372</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1373</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1374</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (bergtsf &lt; one .or. icldm(i,k) >  lcldm(i,k)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1375</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1376</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qiic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1377</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1378</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! first case is for case when liquid water is present, but is completely depleted in time step, i.e., bergrsf > 0 but &lt; 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1379</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1380</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (qc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1381</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     rhin = (one + relhum(i,k)) * half</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1382</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     if (rhin*esloesi > one) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1383</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       prd = epsi*(rhin*qvl-qvi)*oneoabi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1384</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1385</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! multiply by cloud fraction assuming liquid/ice maximum overlap and add to cmei</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1386</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       cmei(i,k) = cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1387</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                           + prd * min(icldm(i,k),lcldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1388</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                           * (one- bergtsf)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1389</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei1=',cmei(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1390</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;' prd=',prd,' bergtsf=',bergtsf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1391</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1392</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                     end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1393</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1394</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1395</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    moved here by Moorthi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1396</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: for case of no liquid, need to set liquid cloud fraction to zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1397</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! store liquid cloud fraction in 'dum'</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1398</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (qc(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1399</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1400</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1401</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1402</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1403</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1404</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! second case is for pure ice cloud, either no liquid, or icldm > lcldm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1405</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (qc(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1406</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1407</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: for case of no liquid, need to set liquid cloud fraction to zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1408</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! store liquid cloud fraction in 'dum'</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1409</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1410</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Moorthi             if (qc(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1411</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                      dum = 0._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1412</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                    else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1413</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                      dum = lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1414</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                    end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1415</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1416</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! set RH to grid-mean value for pure ice cloud</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1417</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     rhin = relhum(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1418</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1419</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     if (rhin*esloesi > one) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1420</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1421</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       prd = epsi*(rhin*qvl-qvi)*oneoabi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1422</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1423</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! multiply by relevant cloud fraction for pure ice cloud</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1424</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assuming maximum overlap of liquid/ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1425</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       cmei(i,k) = cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1426</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                           + prd * max((icldm(i,k)-dum), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1427</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei2=',cmei(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1428</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;' prd=',prd,' icldm=',icldm(i,k),' dum=',dum</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1429</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1430</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                     end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1431</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1432</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1433</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1434</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1435</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if deposition, it should not reduce grid mean rhi below 1.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1436</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if(cmei(i,k) > zero .and. relhum(i,k)*esloesi > one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1437</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;            cmei(i,k) = min(cmei(i,k),(q(i,k)-qs(i)/esloesi)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1438</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                              * oneoabi * dti)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1439</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1440</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei3=',cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1441</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1442</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if ! if (qi(i,k) > qsmall)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1443</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1444</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1445</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1446</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1447</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!..............................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1448</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1449</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! evaporation should not exceed available water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1450</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1451</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tx1 = qc(i,k)*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1452</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (-berg(i,k) &lt; -tx1) berg(i,k) = max(tx1, zero) ! is this correct?????</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1453</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1454</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          berg(i,k) = min(berg(i,k), qc(i,k)/deltat) ! Moorthi - ask anning</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1455</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1456</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!sublimation process...</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1457</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1458</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (relhum(i,k)*esloesi &lt; one .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1459</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;          qiic(i,k) >= qsmall ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1460</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1461</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qvi = epsqs*esi(i,k)/(p(i,k)-omeps*esi(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1462</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qvl = epsqs*esl(i,k)/(p(i,k)-omeps*esl(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1463</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dqsidt  = xxls*qvi/(rv*t(i,k)*t(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1464</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             abi     = one + dqsidt*xxls/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1465</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             oneoabi = one / abi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1466</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1467</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get ice size distribution parameters</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1468</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1469</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             lami(k) = (cons1*ci*niic(i,k)/qiic(i,k))**oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1470</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1471</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            miu_ice(k)=mui_hemp_l(lami(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1472</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             miu_ice(k) = max(min(0.008_r8*(lami(k)*0.01)**0.87_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1473</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                        10.0_r8), 0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1474</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1        = one + miu_ice(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1475</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx2        = one / gamma(tx1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1476</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             aux        = (gamma(tx1+di) * tx2) ** oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1477</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             lami(k)    = aux*lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1478</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1479</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             n0i(k)     = niic(i,k) * lami(k)**tx1 * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1480</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1481</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1482</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (lami(k) &lt; lammini*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1483</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               miu_ice(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1484</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lami(k) = lammini</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1485</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0i(k)  = lami(k)**(di+one)*qiic(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1486</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             else if (lami(k) > lammaxi*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1487</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               miu_ice(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1488</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lami(k) = lammaxi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1489</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0i(k)  = lami(k)**(di+one)*qiic(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1490</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1491</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1492</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             epsi = (miu_ice(k)+two)*(miu_ice(k)+one)*pi*</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1493</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;               niic(i,k)*rho(i,k)*Dv(i,k) / lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1494</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1495</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! modify for ice fraction below</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1496</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prd = epsi*(relhum(i,k)*qvl-qvi)*oneoabi * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1497</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             cmei(i,k) = min(prd, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1498</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1499</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei3a=',cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1500</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' prd=',prd</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1501</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1502</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1503</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sublimation should not exceed available ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1504</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1505</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cmei(i,k) = max(cmei(i,k), -qi(i,k)*dti)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1506</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1507</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei3b=',cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1508</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' qi=',qi(i,k),' deltat=',deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1509</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1510</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sublimation should not increase grid mean rhi above 1.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1511</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if(cmei(i,k) &lt; zero .and. relhum(i,k)*esloesi &lt; one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1512</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;           cmei(i,k) = min(zero, max(cmei(i,k),(q(i,k)-qs(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1513</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                /esloesi) * oneoabi * dti ))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1514</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei3c=',cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1515</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' q=',q(i,k),' qs=',qs(i),' esi=',esi(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1516</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' esl=',esl(i,k),' abi=',abi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1517</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1518</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit cmei due for roundoff error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1519</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1520</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cmei(i,k) = cmei(i,k)*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1521</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei4=',cmei(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1522</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;' omsm=',omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1523</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1524</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conditional for ice nucleation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1525</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1526</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (t(i,k) &lt; (tmelt - five)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1527</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if ( liu_in ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1528</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1529</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! using Liu et al. (2007)/Barahona &amp; Nenes (2009) ice nucleation with hooks into simulated aerosol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1530</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ice nucleation rate (dum2) has already been calculated and read in (naai)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1531</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1532</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum2i(i,k) = naai(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1533</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1534</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1535</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cooper curve (factor of 1000 is to convert from L-1 to m-3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1536</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum2i(i,k) = 0.005_r8*exp(0.304_r8*(273.15_r8-t(i,k)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1537</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     * 1000._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1538</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! put limit on number of nucleated crystals, set to number at T=-30 C</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1539</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cooper (limit to value at -35 C)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1540</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum2i(i,k) = min(dum2i(i,k),208.9e3_r8)*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1541</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1542</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1543</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum2i(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1544</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1545</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1546</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         end do ! end big i loop1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1547</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do   !end big loop1 - k loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1548</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1549</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1550</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do i=1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1551</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         rflx1(i,1) = zero     ! initialize sub-step precip flux variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1552</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         sflx1(i,1) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1553</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1554</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         rflx(i,1)  = zero     ! initialize final precip flux variables.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1555</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         sflx(i,1)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1556</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         ltrue(i)   = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1557</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1558</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1559</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i=1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1560</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           cldo(i,k)    = cldn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1561</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1562</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           rflx1(i,k+1) = zero ! initialize sub-step precip flux variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1563</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           sflx1(i,k+1) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1564</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1565</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           rflx(i,k+1)  = zero ! initialize final precip flux variables.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1566</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           sflx(i,k+1)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1567</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1568</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! skip microphysical calculations if no cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1569</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1570</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if ((qc(i,k) >= qsmall .or. qi(i,k) >= qsmall .or.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1571</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;         cmei(i,k) >= qsmall).and.q(i,k)>=qvsmall) ltrue(i) = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1572</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1573</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           rate1ord_cw2pr_st(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1574</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1575</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1576</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1577</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1578</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1579</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assign number of sub-steps to iter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1580</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! use 2 sub-steps, following tests described in MG2008</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1581</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Anning Cheng 9/17/2016</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1582</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       if (fprcp == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1583</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         iter = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1584</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1585</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         iter  = 2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1586</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1587</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1588</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       riter = one / float(iter)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1589</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get sub-step time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1590</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       deltat = deltat * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1591</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       dti    = one / deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1592</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1593</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! since activation/nucleation processes are fast, need to take into account</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1594</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! factor mtime = mixing timescale in cloud / model time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1595</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! mixing time can be interpreted as cloud depth divided by sub-grid vertical velocity</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1596</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for now mixing timescale is assumed to be 1 timestep for modal aerosols, 20 min bulk</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1597</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1598</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!        note: mtime for bulk aerosols was set to: mtime=deltat/1200._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1599</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1600</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mtime = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1601</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1602</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!! skip calculations if no cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1603</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1604</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do i=1,ncol   !big i loop2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1605</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         if (ltrue(i) == 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1606</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prect(i) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1607</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           preci(i) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1608</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1609</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tlat(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1610</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qvlat(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1611</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qctend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1612</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qitend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1613</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qnitend(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1614</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qrtend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1615</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nctend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1616</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nitend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1617</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nrtend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1618</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nstend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1619</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qniic(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1620</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qric(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1621</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsic(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1622</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nric(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1623</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             rainrt(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1624</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1625</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1626</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1627</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1628</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1629</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qcsinksum_rate1ord(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1630</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qcsum_rate1ord(k)     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1631</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1632</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1633</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1634</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!! begin sub-step!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1635</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.....................................................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1636</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do it=1,iter ! big iter loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1637</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1638</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize sub-step microphysical tendencies</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1639</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1640</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1641</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tlat(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1642</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qvlat(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1643</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qctend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1644</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qitend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1645</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qnitend(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1646</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qrtend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1647</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nctend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1648</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nitend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1649</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nrtend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1650</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nstend(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1651</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1652</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize diagnostic precipitation to zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1653</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1654</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qniic(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1655</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qric(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1656</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsic(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1657</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nric(i,k)    = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1658</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1659</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               rainrt(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1660</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1661</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1662</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1663</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1664</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! begin new i,k loop, calculate new cldmax after adjustment to cldm above</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1665</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1666</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize vertically-integrated rain and snow tendencies</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1667</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1668</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qrtot = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1669</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nrtot = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1670</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qstot = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1671</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nstot = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1672</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1673</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize precip at surface</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1674</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1675</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prect(i) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1676</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             preci(i) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1677</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1678</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1679</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1680</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               km = k - 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1681</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! set cwml and cwmi to current qc and qi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1682</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1683</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               cwml(i,k) = qc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1684</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               cwmi(i,k) = qi(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1685</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1686</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize precip fallspeeds to zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1687</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1688</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               ums(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1689</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               uns(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1690</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               umr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1691</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               unr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1692</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1693</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate precip fraction based on maximum overlap assumption</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1694</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1695</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (k == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1696</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 cldmax(i,k) = cldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1697</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1698</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if rain or snow mix ratio is smaller than</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1699</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! threshold, then set cldmax to cloud fraction at current level</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1700</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qric(i,km)  >= qsmall .or.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1701</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;               qniic(i,km) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1702</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   cldmax(i,k) = max(cldmax(i,km),cldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1703</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1704</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   cldmax(i,k) = cldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1705</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1706</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1707</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1708</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               rdz = rho(i,k)  * dz(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1709</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               rdzi = one / rdz</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1710</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1711</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1712</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1713</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1714</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ice nucleation if activated nuclei exist at t&lt;-5C AND rhmini + 5%</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1715</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1716</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dum2i(i,k) > zero .and. t(i,k) &lt; (tmelt-five) .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1717</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;            relhum(i,k)*esl(i,k)/esi(i,k) > rhmini+0.05_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1718</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1719</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!if NCAI > 0. then set numice = ncai (as before)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1720</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!note: this is gridbox averaged</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1721</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1722</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nimax     = dum2i(i,k)*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1723</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                nnuccd(k) = (dum2i(i,k)-ni(i,k)/icldm(i,k))/deltat*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1724</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnuccd(k) = max(zero, (nimax-ni(i,k))*dti)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1725</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1726</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Calc mass of new particles using new crystal mass...</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1727</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!also this will be multiplied by mtime as nnuccd is...</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1728</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1729</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnuccd(k) = nnuccd(k) * mi0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1730</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1731</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  add mnuccd to cmei....</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1732</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 cmei(i,k)= cmei(i,k) + mnuccd(k) * mtime</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1733</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1734</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei5=',cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1735</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1736</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  limit cmei</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1737</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1738</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qvi = epsqs*esi(i,k)/(p(i,k)-omeps*esi(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1739</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dqsidt    = xxls*qvi/(rv*t(i,k)*t(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1740</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 abi       = one + dqsidt*xxls/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1741</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 cmei(i,k) = min(cmei(i,k),(q(i,k)-qvi)/(abi*deltat))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1742</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1743</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit for roundoff error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1744</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 cmei(i,k) = cmei(i,k)*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1745</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1746</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei6=',cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1747</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1748</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnuccd(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1749</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nimax     = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1750</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnuccd(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1751</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1752</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1753</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1754</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!c............................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1755</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1756</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! obtain in-cloud values of cloud water/ice mixing ratios and number concentrations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1757</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for microphysical process calculations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1758</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! units are kg/kg for mixing ratio, 1/kg for number conc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1759</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1760</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit in-cloud values to 0.005 kg/kg</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1761</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1762</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1       = one / lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1763</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2       = one / icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1764</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qcic(i,k) = min(cwml(i,k)*tx1, 5.e-3_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1765</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qiic(i,k) = min(cwmi(i,k)*tx2, 5.e-3_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1766</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               ncic(i,k) = max(nc(i,k)*tx1, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1767</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               niic(i,k) = max(ni(i,k)*tx2, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1768</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1769</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1770</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (nccons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1771</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ncic(i,k) = ncnst*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1772</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1773</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1774</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (nicons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1775</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 niic(i,k) = ninst*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1776</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1777</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1778</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = qc(i,k) - berg(i,k)*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1779</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (tx1 &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1780</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qcic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1781</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ncic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1782</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (tx1 &lt; zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1783</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   berg(i,k) = qc(i,k)*dti*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1784</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1785</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1786</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1787</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = qi(i,k) + (cmei(i,k)+berg(i,k))*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1788</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (tx1 &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1789</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qiic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1790</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 niic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1791</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (tx1 &lt; zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1792</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   cmei(i,k) = (-qi(i,k)*dti-berg(i,k))*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1793</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' cmei7=',cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1794</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1795</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1796</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1797</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add to cme output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1798</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1799</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               cmeout(i,k) = cmeout(i,k) + cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1800</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1801</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! decrease in number concentration due to sublimation/evap</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1802</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! divide by cloud fraction to get in-cloud decrease</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1803</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! don't reduce Nc due to bergeron process</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1804</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1805</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Moved it here since nsubi since cmei was not limited before(DONIF 03/13/2015)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1806</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (cmei(i,k) &lt; zero .and. qi(i,k) > qsmall</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1807</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                              .and. cldm(i,k) > mincld) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1808</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsubi(k) = cmei(i,k)*ni(i,k) / (qi(i,k)*cldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1809</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1810</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsubi(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1811</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1812</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1813</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsubc(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1814</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1815</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1816</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1817</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1818</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1819</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get size distribution parameters based on in-cloud cloud water/ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1820</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! these calculations also ensure consistency between number and mixing ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1821</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1822</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1823</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1824</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cloud ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1825</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1826</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qiic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1827</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1828</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add upper limit to in-cloud number concentration to prevent numerical error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1829</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 niic(i,k) = min(niic(i,k),qiic(i,k)*1.e20_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1830</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1831</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1832</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k) = (cons1*ci*niic(i,k)/qiic(i,k))**oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1833</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1834</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                miu_ice(k) = mui_hemp_l(lami(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1835</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 miu_ice(k) = max(min(0.008_r8*(lami(k)*0.01)**0.87_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1836</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                10.0_r8), 0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1837</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1        = one + miu_ice(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1838</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2        = one / gamma(tx1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1839</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 aux        = (gamma(tx1+di) * tx2) **oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1840</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k)    = aux*lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1841</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1842</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0i(k)     = niic(i,k)*lami(k)**tx1 * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1843</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1844</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1845</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1846</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1847</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (lami(k) &lt; lammini) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1848</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lami(k)   = lammini</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1849</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0i(k)    = lami(k)**(di+one)*qiic(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1850</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   niic(i,k) = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1851</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 else if (lami(k) > lammaxi) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1852</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lami(k)   = lammaxi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1853</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0i(k)    = lami(k)**(di+one)*qiic(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1854</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   niic(i,k) = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1855</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1856</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1857</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1858</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1859</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0i(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1860</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1861</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1862</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qcic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1863</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1864</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add upper limit to in-cloud number concentration to prevent numerical error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1865</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ncic(i,k) = min(ncic(i,k),qcic(i,k)*1.e20_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1866</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1867</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ncic(i,k) = max(ncic(i,k),cdnl*irho(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1868</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1869</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get pgam from fit to observations of martin et al. 1994</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1870</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1871</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pgam(k) = 0.0005714_r8*(ncic(i,k)/1.e6_r8*rho(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1872</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   + 0.2714_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1873</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1874</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1875</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 if (.true.) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1876</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if ((ncic(i,k) > 1.0e-3) .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1877</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 (qcic(i,k) > 1.0e-11)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1878</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     xs = 0.07_r8*(1000._r8*qcic(i,k)/ncic(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1879</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                               **(-0.14_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1880</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1881</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     xs = 1.2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1882</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1883</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1884</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   xs = max(min(xs, 1.7_r8), 1.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1885</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   xs = xs*xs*xs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1886</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   xs = (xs + sqrt(xs+8.0_r8)*sqrt(xs) - four)/8.0_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1887</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   pgam(k) = sqrt(xs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1888</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1889</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1890</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1891</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1892</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1893</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pgam(k) = one / (pgam(k)*pgam(k)) - one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1894</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pgam(k) = max(two, min(15._r8, pgam(k)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1895</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1896</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1897</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate lamc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1898</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1     = pirhow * gamma(pgam(k)+four)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1899</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx3     = gamma(pgam(k)+one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1900</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2     = 6._r8 * qcic(i,k) * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1901</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1902</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamc(k) = (tx1*ncic(i,k)/tx2) ** oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1903</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1904</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! lammin, 50 micron diameter max mean size</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1905</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1906</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lammin = (pgam(k)+one) / 50.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1907</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lammax = (pgam(k)+one) / 2.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1908</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1909</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (lamc(k) &lt; lammin) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1910</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lamc(k)   = lammin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1911</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ncic(i,k) = tx2*lamc(k)*lamc(k)*lamc(k) / tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1912</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 else if (lamc(k) > lammax) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1913</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lamc(k)   = lammax</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1914</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ncic(i,k) = tx2*lamc(k)*lamc(k)*lamc(k) / tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1915</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1916</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1917</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! parameter to calculate droplet freezing</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1918</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1919</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 cdist1(k) = ncic(i,k) / tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1920</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1921</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1922</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamc(k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1923</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 cdist1(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1924</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1925</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1926</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1927</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1928</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! begin micropysical process calculations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1929</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1930</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! autoconversion of cloud liquid water to rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1931</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! formula from Khrouditnov and Kogan (2000), modified for sub-grid distribution of qc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1932</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! minimum qc of 1 x 10^-8 prevents floating point error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1933</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1934</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               xs = 0.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1935</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1936</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qcic(i,k) >= 1.e-8_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1937</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1938</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! nprc is increase in rain number conc due to autoconversion</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1939</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! nprc1 is decrease in cloud droplet conc due to autoconversion</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1940</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1941</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assume exponential sub-grid distribution of qc, resulting in additional</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1942</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! factor related to qcvar below</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1943</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1944</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1945</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                prc(k) = cons2/(cons3*cons18)*1350._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1946</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;                  * qcic(i,k)**2.47_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1947</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;                  * (1.e-6_r8*ncic(i,k)*rho(i,k))**(-1.79_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1948</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1949</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 if (auto_option == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1950</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1951</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1    = qcic(i,k)*rho(i, k)/3.0e-4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1952</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   prc(k) = 1.0e-3 * qcic(i,k) * (one-exp(-tx1*tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1953</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    * gamma(one+qcvar)/(cons3*qcvar)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1954</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1955</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 elseif (auto_option == 2) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1956</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1957</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   tx1    = qcic(i,k)*rho(i, k)/7.5e-4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1958</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   tx1    = tx1 * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1959</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   prc(k) = 1.0e-4 * qcic(i,k) * (one-exp(-tx1*tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1960</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                    * gamma(one+qcvar)/(cons3*qcvar)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1961</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1962</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 elseif (auto_option == 3) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1963</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1964</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   tx1    = qcic(i,k) / 3.0e-4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1965</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1966</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   prc(k) = 1.0e-3 * (one-EXP(-tx1*tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1967</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                    * cons2/(cons3*cons18)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1968</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                    / (1.e-6_r8/50.0*ncic(i,k)*rho(i,k))**1.79_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1969</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1970</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 elseif (auto_option  == 4) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1971</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1972</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   xs = one / (one+pgam(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1973</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1974</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   beta6 = (one+3.0*xs)*(one+4.0*xs)*(one+5.0*xs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1975</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                   / ((one+xs)*(one+xs+xs))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1976</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1977</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   LW = 1.0e-3_r8 * qcic(i,k) * rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1978</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   NW = ncic(i,k) * rho(i,k)  * 1.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1979</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1980</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   xs = min(20.0, 1.03e16*(LW*LW)/(NW*SQRT(NW)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1981</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   prc(k) = 1.1e10*beta6*LW*LW*LW</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1982</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                    * (one-exp(-(xs**miu_disp))) / NW</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1983</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   prc(k) = prc(k)*1.0e3*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1984</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   prc(k) = prc(k) * gamma(two+qcvar)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1985</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                    / (gamma(qcvar)*(qcvar*qcvar))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1986</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1987</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   prc(k) = prc(k)*dcrit</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1988</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1989</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   xs = 1/xs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1990</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1991</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   prc(k) = cons2/(cons3*cons18)*1350._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1992</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                    * qcic(i,k)**2.47_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1993</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                    * (1.e-6_r8*ncic(i,k)*rho(i,k))**(-1.79_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1994</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1995</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1996</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprc(k) = prc(k)/cons22</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1997</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1998</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprc1(k) = ncic(i,k)*prc(k) / (qcic(i,k)*(one+xs))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>1999</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2000</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2001</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prc(k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2002</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprc(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2003</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprc1(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2004</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2005</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2006</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2007</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2008</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add autoconversion to precip from above to get provisional rain mixing ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2009</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! and number concentration (qric and nric)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2010</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2011</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! 0.45 m/s is fallspeed of new rain drop (80 micron diameter)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2012</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2013</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (fprcp == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2014</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = one / lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2015</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qric(i,k) = min(qrn(i,k)*tx1, 10.e-3_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2016</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nric(i,k) = max(nrn(i,k)*tx1, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2017</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2018</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum  = 0.45_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2019</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum1 = 0.45_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2020</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2021</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (k == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2022</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1 = lcldm(i,k)*dz(i,k)/(cldmax(i,k)*dum)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2023</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qric(i,k) = prc(k)  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2024</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nric(i,k) = nprc(k) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2025</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2026</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (qric(i,km) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2027</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      dum=umr(k-1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2028</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      dum1=unr(k-1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2029</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      Anning Cheng find a possible untable case here</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2030</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum  = max(umr(km),dum)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2031</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum1 = max(unr(km),dum1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2032</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2033</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2034</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! no autoconversion of rain number if rain/snow falling from above</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2035</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! this assumes that new drizzle drops formed by autoconversion are rapidly collected</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2036</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! by the existing rain/snow particles from above</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2037</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2038</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (qric(i,km)  >= 1.e-9_r8 .or.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2039</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                 qniic(i,km) >= 1.e-9_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2040</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     nprc(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2041</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2042</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2043</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1 = rho(i,km) * cldmax(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2044</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx3 = rho(i,k)  * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2045</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qric(i,k) = (tx1*umr(km)*qric(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2046</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   + (rdz*((pra(km)+prc(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2047</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   + (pre(km)-pracs(km)-mnuccr(km))*cldmax(i,k))))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2048</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   / (dum*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2049</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2050</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2051</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      nric(i,k) = (rho(i,k-1)*unr(k-1)*nric(i,k-1)*cldmax(i,k-1)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2052</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; (rho(i,k)*dz(i,k)*(nprc(k)*lcldm(i,k)+(nsubr(k-1)-npracs(k-1)-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2053</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;nnuccr(k-1)+nragg(k-1))*cldmax(i,k)))) /(dum1*rho(i,k)*cldmax(i,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2054</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2055</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2056</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      Anning nsubr never given a value before</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2057</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nric(i,k) = (tx1*unr(km)*nric(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2058</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                + (rdz*(nprc(k)*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2059</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                +(-npracs(km)-nnuccr(km)+nragg(km))*cldmax(i,k))))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2060</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                / (dum1*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2061</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2062</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2063</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif !fprcp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2064</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2065</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2066</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Autoconversion of cloud ice to snow (Ice_aut)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2067</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! similar to Ferrier (1994)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2068</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2069</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (t(i,k) &lt;= 273.15_r8 .and. qiic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2070</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2071</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: assumes autoconversion timescale of 180 sec</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2072</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!vaux = 180.0_r8*10.0_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2073</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2074</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 if (.false.) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2075</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                    vaux = ts_auto_ice * 10.0_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2076</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2077</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                    nprci(k) = (niic(i, k)/vaux)*exp(-lami(k)*dcs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2078</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                    tx1 = one / lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2079</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                    tx2 = tx1 * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2080</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                    prci(k)  = pi*irho(i,k)*niic(i,k)*lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2081</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                       / (6._r8*vaux)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2082</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                       * (cons23*tx1+three*cons24*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2083</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                       + 6._r8*dcs*tx1*tx2+6._r8*tx2*tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2084</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                       * exp(-lami(k)*dcs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2085</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2086</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2087</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2088</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                   miu_ice(k) = mui_hemp_l(lami(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2089</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    miu_ice(k) =max(min(0.008_r8*(lami(k)*0.01)**0.87_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2090</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;,                                 10.0_r8), 0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2091</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    tx1      = lami(k)*dcs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2092</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    nprci(k) = (niic(i,k)/ts_auto_ice)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2093</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       * (one - gamma_incomp(miu_ice(k), tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2094</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2095</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    prci(k) = (qiic(i,k)/ts_auto_ice)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2096</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    * (one - gamma_incomp(miu_ice(k)+three, tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2097</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2098</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2099</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2100</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prci(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2101</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprci(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2102</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2103</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2104</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2105</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add autoconversion to flux from level above to get provisional snow mixing ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2106</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! and number concentration (qniic and nsic)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2107</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Anning Cheng 9/16/2016 forecasting rain and snow, corresponding to MG2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2108</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (fprcp == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2109</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = one / icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2110</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qniic(i,k) = min(qsnw(i,k)*tx1, 10.e-3_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2111</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsic(i,k)  = max(nsnw(i,k)*tx1, 0._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2112</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2113</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2114</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum  = (asn(i,k)*cons25)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2115</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum1 = (asn(i,k)*cons25)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2116</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2117</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (k == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2118</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1 = icldm(i,k)*dz(i,k)/(cldmax(i,k)*dum)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2119</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qniic(i,k) = prci(k)  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2120</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsic(i,k)  = nprci(k) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2121</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2122</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (qniic(i,km) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2123</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum  = ums(km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2124</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum1 = uns(km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2125</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2126</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2127</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1 = rho(i,km) * cldmax(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2128</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx3 = rho(i,k)  * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2129</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qniic(i,k) = (tx1*ums(km)*qniic(i,km) + (rdz*</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2130</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;              ((prci(k)+prai(km)+psacws(km)+bergs(km))*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2131</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;              +(prds(km)+pracs(km)+mnuccr(km))*cldmax(i,k))))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2132</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;              / (dum*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2133</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2134</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      nsic(i,k) = (rho(i,k-1)*uns(k-1)*nsic(i,k-1)*cldmax(i,k-1)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2135</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; (rho(i,k)*dz(i,k)*(nprci(k)*icldm(i,k)+(nsubs(k-1)+nsagg(k-1)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2136</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;nnuccr(k-1))*cldmax(i,k)))) /(dum1*rho(i,k)*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2137</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2138</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      nsubs never given a value before</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2139</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsic(i,k) = (tx1*uns(km)*nsic(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2140</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       + (rdz*(nprci(k)*icldm(i,k)+(nsagg(km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2141</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       + nnuccr(km))*cldmax(i,k)))) /(dum1*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2142</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2143</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2144</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if !fprcp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2145</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2146</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if precip mix ratio is zero so should number concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2147</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2148</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qniic(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2149</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qniic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2150</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsic(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2151</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2152</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2153</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qric(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2154</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qric(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2155</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nric(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2156</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2157</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2158</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure number concentration is a positive number to avoid</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2159</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! taking root of negative later</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2160</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2161</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nric(i,k) = max(nric(i,k),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2162</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsic(i,k) = max(nsic(i,k),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2163</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2164</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2165</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get size distribution parameters for precip</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2166</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2167</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2168</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2169</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qric(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2170</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamr(k) = (pirhow*nric(i,k)/qric(i,k))**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2171</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0r(k)  = nric(i,k)*lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2172</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2173</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2174</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2175</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2176</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (lamr(k) &lt; lamminr) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2177</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lamr(k)   = lamminr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2178</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1       = lamminr * lamminr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2179</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0r(k)    = tx1 * tx1 * qric(i,k)/pirhow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2180</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nric(i,k) = n0r(k)/lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2181</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 else if (lamr(k) > lammaxr) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2182</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lamr(k)   = lammaxr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2183</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1       = lammaxr * lammaxr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2184</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0r(k)    = tx1 * tx1 * qric(i,k)/pirhow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2185</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nric(i,k) = n0r(k)/lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2186</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2187</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2188</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! provisional rain number and mass weighted mean fallspeed (m/s)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2189</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2190</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1    = arn(i,k) / lamr(k) ** br</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2191</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2    = 9.1_r8*rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2192</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 unr(k) = min(tx1*cons4, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2193</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 umr(k) = min(tx1*(cons5/6._r8), tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2194</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2195</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2196</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2197</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0r(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2198</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 umr(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2199</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 unr(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2200</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2201</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2202</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2203</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2204</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2205</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qniic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2206</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lams(k) = (cons6*cs*nsic(i,k) / qniic(i,k))**(one/ds)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2207</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0s(k)  = nsic(i,k)*lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2208</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2209</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2210</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2211</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2212</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (lams(k) &lt; lammins) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2213</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lams(k)   = lammins</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2214</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0s(k)    = lams(k)**(ds+one)*qniic(i,k)/(cs*cons6)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2215</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsic(i,k) = n0s(k)/lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2216</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 else if (lams(k) > lammaxs) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2217</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lams(k)   = lammaxs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2218</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0s(k)    = lams(k)**(ds+one)*qniic(i,k)/(cs*cons6)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2219</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsic(i,k) = n0s(k)/lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2220</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2221</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2222</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! provisional snow number and mass weighted mean fallspeed (m/s)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2223</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2224</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1    = asn(i,k) / lams(k)**bs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2225</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2    = 1.2_r8*rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2226</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ums(k) = min(tx1*(cons8/6._r8), tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2227</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 uns(k) = min(tx1*cons7, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2228</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2229</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2230</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lams(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2231</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0s(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2232</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ums(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2233</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 uns(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2234</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2235</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2236</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2237</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>checked up to here moorthi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2238</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2239</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! heterogeneous freezing of cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2240</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2241</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qcic(i,k) >= qsmall .and. t(i,k) &lt; 269.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2242</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2243</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! immersion freezing (Bigg, 1953)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2244</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2245</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2       = one / (lamc(k) * lamc(k) * lamc(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2246</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx3       = min(aimm*(273.15_r8-t(i,k)), 25.0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2247</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1       = cdist1(k) * tx2 * bimm * exp(tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2248</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnuccc(k) = cons9/(cons3*cons19)* pi*pirhow/36._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2249</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     * gamma(7._r8+pgam(k))*tx1*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2250</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2251</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnuccc(k) = cons10/(cons3*qcvar)* pi/6._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2252</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     * gamma(pgam(k)+four) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2253</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2254</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 if (.true.) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2255</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nnuccc(k) = nimm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2256</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   mnuccc(k) = nimm(i,k)*qcic(i,k)/max(cdist1(k), one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2257</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2258</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2259</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! contact freezing (-40&lt;T&lt;-3 C) (Young, 1974) with hooks into simulated dust</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2260</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! dust size and number in 4 bins are read in from companion routine</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2261</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2262</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!DONIFFFF this implementation would oveestimate strongly contact IN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2263</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! According to Young 1974 the base concentration must be the active contact IN at -4 C</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2264</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! This implementation is using all the dust at all levels</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2265</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Freezing fraction of collected IN is assumed to be 1.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2266</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2267</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tcnt      = (270.16_r8-t(i,k))**1.3_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2268</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 viscosity = 1.8e-5_r8*(t(i,k)/298.0_r8)**0.85_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2269</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 mfp       = two*viscosity</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2270</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     / (p(i,k) *sqrt(8.0_r8*28.96e-3_r8/(pi*</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2271</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                   8.314409_r8*t(i,k))))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2272</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 taux      = t(i,k) - three</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2273</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 taux      = max(taux-273.15, -40.0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2274</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2275</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsdust    = max(exp(-0.517*taux + 8.934) -3.76e6, 0.0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2276</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 nssoot    = max(1.0e4*exp((-0.0101*taux-0.8525)*taux</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2277</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                      +0.7667) -3.77e9, 0.0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2278</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2279</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 do ind_aux = 1, nbincontactdust</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2280</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1 = rndst(i,k,ind_aux)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2281</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nslip(ind_aux) = one + (mfp/tx1) *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2282</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    (1.257_r8+(0.4_r8*Exp(-(1.1_r8*tx1/mfp))))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2283</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ndfaer(ind_aux) = 1.381e-23_r8*t(i,k)* nslip(ind_aux)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2284</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                             /  (6._r8*pi*viscosity*tx1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2285</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2286</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ndfaer(ind_aux) = ndfaer(ind_aux)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2287</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                             * (1.0-exp(-nsdust*12.5664*tx1*tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2288</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2289</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2290</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nslipsoot  = one + (mfp/rnsoot(i,k)) *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2291</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                (1.257_r8+(0.4_r8*Exp(-(1.1_r8*rnsoot(i,k)/mfp))))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2292</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ndfaersoot = 1.381e-23_r8*t(i,k)*nslipsoot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2293</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    / (6._r8*pi*viscosity*rnsoot(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2294</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 ndfaersoot = ndfaersoot *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2295</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                (1.0-exp(-nssoot*12.5664*rnsoot(i,k)*rnsoot(i,k)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2296</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2297</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2298</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2299</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = sum(ndfaer(:)*nacon(i,k,:))+ndfaersoot*nsoot(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2300</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = tx1 * pi * cdist1(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2301</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2 = one / lamc(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2302</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx3 = tx2 * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2303</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnucct(k) = (pi*cons10/(cons3*qcvar*three)) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2304</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     * rhow*gamma(pgam(k)+five)*tx3*tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2305</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2306</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2307</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnucct(k) = (tx1+tx1) * gamma(pgam(k)+two) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2308</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2309</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure number of droplets frozen does not exceed available ice nuclei concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2310</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! this prevents 'runaway' droplet freezing</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2311</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2312</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 if (nnuccc(k)*lcldm(i,k) > nnuccd(k)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2313</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   dum = (nnuccd(k)/(nnuccc(k)*lcldm(i,k)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2314</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! scale mixing ratio of droplet freezing with limit</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2315</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   mnuccc(k) = mnuccc(k)*dum</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2316</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   nnuccc(k) = nnuccd(k)/lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2317</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2318</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2319</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2320</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2321</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if ((nnucct(k)+nnuccc(k))*deltat > ncic(i, k)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2322</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2323</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1 = tx2 * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2324</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nnuccc(k) = ncic(i, k)*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2325</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   mnuccc(k) = cons9/(cons3*cons19)* pi*pirhow/36._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2326</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       * cdist1(k)*gamma(7._r8+pgam(k))*ncic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2327</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       * tx1 * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2328</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2329</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nnucct(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2330</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   mnucct(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2331</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2332</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2333</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2334</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2335</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnuccc(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2336</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnuccc(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2337</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnucct(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2338</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnucct(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2339</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2340</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2341</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2342</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! snow self-aggregation from passarelli, 1978, used by reisner, 1998</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2343</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! this is hard-wired for bs = 0.4 for now</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2344</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ignore self-collection of cloud ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2345</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2346</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qniic(i,k) >= qsmall .and. t(i,k) &lt;= 273.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2347</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = (two+bs)*oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2348</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsagg(k) = -1108._r8*asn(i,k)*Eii* pi**((one-bs)*oneb3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2349</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    * (rho(i,k)*qniic(i,k)/rhosn) ** tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2350</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    * (nsic(i,k)*rho(i,k))**((four-bs)*oneb3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2351</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    / (four*720._r8*rho(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2352</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2353</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsagg(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2354</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2355</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2356</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2357</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! accretion of cloud droplets onto snow/graupel</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2358</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! here use continuous collection equation with</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2359</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! simple gravitational collection kernel</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2360</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ignore collisions between droplets/cloud ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2361</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! since minimum size ice particle for accretion is 50 - 150 micron</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2362</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2363</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ignore collision of snow with droplets above freezing</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2364</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2365</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qniic(i,k) >= qsmall .and. t(i,k) &lt;= tmelt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2366</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                  .and. qcic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2367</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2368</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! put in size dependent collection efficiency</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2369</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! mean diameter of snow is area-weighted, since</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2370</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! accretion is function of crystal geometric area</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2371</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! collection efficiency is approximation based on stoke's law (Thompson et al. 2004)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2372</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2373</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dc0 = (pgam(k)+one)/lamc(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2374</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ds0 = one/lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2375</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum = dc0*dc0*uns(k)*rhow/(9._r8*mu(i,k)*ds0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2376</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 eci = dum*dum/((dum+0.4_r8)*(dum+0.4_r8))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2377</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2378</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 eci = min(one, max(eci, zero))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2379</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2380</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2381</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! no impact of sub-grid distribution of qc since psacws</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2382</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! is linear in qc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2383</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2384</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1      = pi/four*asn(i,k)*rho(i,k)*n0s(k)*Eci*cons11</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2385</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    / lams(k)**(bs+three)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2386</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 psacws(k)  = tx1 * qcic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2387</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npsacws(k) = tx1 * ncic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2388</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2389</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 psacws(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2390</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npsacws(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2391</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2392</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2393</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add secondary ice production due to accretion of droplets by snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2394</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! (Hallet-Mossop process) (from Cotton et al., 1986)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2395</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2396</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if((t(i,k) &lt; 270.16_r8) .and. (t(i,k) >= 268.16_r8)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2397</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ni_secp   = 0.5*3.5e8_r8*(270.16_r8-t(i,k))*psacws(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2398</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsacwi(k) = ni_secp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2399</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 msacwi(k) = min(ni_secp*mi0, psacws(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2400</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               else if((t(i,k) &lt; 268.16_r8) .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2401</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 (t(i,k) >= 265.16_r8)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2402</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ni_secp   = oneb3*3.5e8_r8*(t(i,k)-265.16_r8)*psacws(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2403</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsacwi(k) = ni_secp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2404</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 msacwi(k) = min(ni_secp*mi0, psacws(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2405</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2406</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ni_secp   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2407</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsacwi(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2408</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 msacwi(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2409</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2410</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               psacws(k) = max(zero, psacws(k)-ni_secp*mi0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2411</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2412</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2413</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! accretion of rain water by snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2414</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! formula from ikawa and saito, 1991, used by reisner et al., 1998</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2415</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2416</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qric(i,k) >= 1.e-8_r8 .and. qniic(i,k) >= 1.e-8_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2417</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;          .and. t(i,k) &lt;= 273.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2418</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Anning decrease pracs it can reach 2.3e5 so/1.e6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2419</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = 1.2_r8*umr(k) - 0.95_r8*ums(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2420</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2 = sqrt(tx1*tx1+0.08_r8*ums(k)*umr(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2421</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = one / lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2422</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx3 = one / lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2423</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx4 = tx1 * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2424</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx5 = pi * ecr * rho(i,k) *n0r(k) * n0s(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2425</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2426</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pracs(k) = pirhow*tx2*tx5 *</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2427</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;          (tx4*tx4*tx3*(five*tx4+tx3*(two*tx1+half*tx3)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2428</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2429</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2430</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2 = unr(k) - uns(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2431</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2 = sqrt(1.7_r8*tx2*tx2 + 0.3_r8*unr(k)*uns(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2432</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2433</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npracs(k) = half*tx2*tx5*tx1*tx3*(tx4+tx3*(tx1+tx3))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2434</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2435</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2436</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pracs(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2437</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npracs(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2438</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2439</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2440</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2441</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! heterogeneous freezing of rain drops</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2442</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! follows from Bigg (1953)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2443</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2444</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      if (t(i,k).lt.269.15_r8 .and. qric(i,k).ge.qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2445</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      Anning change to prevent huge value of mnuccr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2446</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2447</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (t(i,k) &lt; 269.15_r8 .and. qric(i,k) >= qsmall</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2448</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                .and. t(i,k) > 260.0_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2449</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2450</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                tx1 = exp(min(aimm*(273.15_r8-t(i,k))-one, 50.0))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2451</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1 = exp(min(aimm*(273.15_r8-t(i,k))-one, 25.0))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2452</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2 = 1.0 / (lamr(k)*lamr(k)*lamr(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2453</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2454</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnuccr(k) = pi * nric(i,k) * bimm * tx1 * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2455</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnuccr(k) = 20._r8 * pirhow * nnuccr(k) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2456</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2457</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2458</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnuccr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2459</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnuccr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2460</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2461</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2462</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2463</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2464</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! accretion of cloud liquid water by rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2465</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! formula from Khrouditnov and Kogan (2000)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2466</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! gravitational collection kernel, droplet fall speed neglected</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2467</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2468</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qric(i,k) >= qsmall .and. qcic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2469</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2470</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! include sub-grid distribution of cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2471</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2472</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pra(k)  = cons12/(cons3*cons20)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2473</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   * 67._r8*(qcic(i,k)*qric(i,k))**1.15_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2474</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npra(k) = pra(k) * (ncic(i,k)/qcic(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2475</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2476</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2477</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pra(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2478</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npra(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2479</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2480</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2481</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!Not done above</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2482</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2483</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Self-collection of rain drops</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2484</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! from Beheng(1994)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2485</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2486</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qric(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2487</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nragg(k) = -8._r8*nric(i,k)*qric(i,k)*rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2488</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2489</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nragg(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2490</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2491</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2492</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2493</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Accretion of cloud ice by snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2494</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! For this calculation, it is assumed that the Vs >> Vi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2495</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! and Ds >> Di for continuous collection</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2496</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2497</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qniic(i,k) >= qsmall .and. qiic(i,k) >= qsmall</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2498</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                  .and.t(i,k) &lt;= 273.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2499</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2500</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1     = (pi/four)*asn(i,k)*rho(i,k)*n0s(k)*Eii*cons11</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2501</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   / lams(k)**(bs+three)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2502</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prai(k)  = tx1 * qiic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2503</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprai(k) = tx1 * niic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2504</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2505</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprai(k)= min(nprai(k), 1.0e10)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2506</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2507</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2508</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prai(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2509</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprai(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2510</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2511</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2512</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2513</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate evaporation/sublimation of rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2514</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: evaporation/sublimation occurs only in cloud-free portion of grid cell</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2515</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! in-cloud condensation/deposition of rain and snow is neglected</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2516</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! except for transfer of cloud water to snow through bergeron process</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2517</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2518</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize evap/sub tendncies</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2519</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               pre(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2520</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               prds(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2521</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2522</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! evaporation of rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2523</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! only calculate if there is some precip fraction > cloud fraction</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2524</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2525</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qcic(i,k)+qiic(i,k) &lt; 1.e-7_r8 .or.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2526</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             cldmax(i,k) > lcldm(i,k)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2527</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2528</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! set temporary cloud fraction to zero if cloud water + ice is very small</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2529</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! this will ensure that evaporation/sublimation of precip occurs over</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2530</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! entire grid cell, since min cloud fraction is specified otherwise</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2531</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qcic(i,k)+qiic(i,k) &lt; 1.e-7_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2532</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2533</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2534</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2535</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2536</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2537</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! saturation vapor pressure</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2538</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                esn = polysvp(t(i,k),0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2539</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 esn = min(fpvsl(t(i,k)), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2540</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qsn = min(epsqs*esn/(p(i,k)-omeps*esn), one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2541</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2542</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! recalculate saturation vapor pressure for liquid and ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2543</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 esl(i,k) = esn</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2544</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                esi(i,k) = polysvp(t(i,k),1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2545</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 esi(i,k) = min(fpvsi(t(i,k)), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2546</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! hm fix, make sure when above freezing that esi=esl, not active yet</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2547</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (t(i,k) > tmelt) esi(i,k) = esl(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2548</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2549</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate q for out-of-cloud region</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2550</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2551</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qclr = (q(i,k)-dum*qsn) / (one-dum)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2552</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2553</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qric(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2554</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2555</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qvs   = epsqs*esl(i,k)/(p(i,k)-omeps*esl(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2556</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dqsdt = xxlv*qvs/(rv*t(i,k)*t(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2557</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ab    = one + dqsdt*xxlv/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2558</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   epsr = (pi+pi)*n0r(k)*rho(i,k)*Dv(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2559</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                  * (f1r/(lamr(k)*lamr(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2560</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                  +  f2r*sqrt(arn(i,k)*rho(i,k)/mu(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2561</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                  *  sc(i,k)**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2562</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                  *  cons13 / lamr(k)**((five+br)*half))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2563</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2564</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   pre(k) = epsr*(qclr-qvs)/ab</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2565</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2566</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! only evaporate in out-of-cloud region</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2567</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! and distribute across cldmax</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2568</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   pre(k) = min(pre(k)*(cldmax(i,k)-dum), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2569</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   pre(k) = pre(k) / cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2570</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2571</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2572</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2573</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sublimation of snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2574</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qniic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2575</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qvi    = epsqs*esi(i,k)/(p(i,k)-omeps*esi(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2576</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dqsidt = xxls*qvi/(rv*t(i,k)*t(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2577</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   abi    = one + dqsidt*xxls/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2578</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   epss   = (pi+pi)*n0s(k)*rho(i,k)*Dv(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2579</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    * (f1s/(lams(k)*lams(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2580</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    +  f2s*sqrt((asn(i,k)*rho(i,k)/mu(i,k)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2581</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    *  sc(i,k)**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2582</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    *  cons14/ lams(k)**((five+bs)*half))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2583</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   prds(k) = epss*(qclr-qvi)/abi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2584</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2585</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! only sublimate in out-of-cloud region and distribute over cldmax</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2586</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   prds(k) = min(prds(k)*(cldmax(i,k)-dum), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2587</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   prds(k) = prds(k)/cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2588</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2589</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2590</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2591</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure RH not pushed above 100% due to rain evaporation/snow sublimation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2592</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get updated RH at end of time step based on cloud water/ice condensation/evap</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2593</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2594</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1  = pre(k)  * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2595</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2  = prds(k) * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2596</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qtmp = q(i,k) - (cmei(i,k)+tx1+tx2) * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2597</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ttmp = t(i,k) + (tx1*xxlv + (cmei(i,k)+tx2)*xxls)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2598</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                         * (deltat/cpp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2599</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2600</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!limit range of temperatures!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2601</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ttmp = max(180._r8,min(ttmp,323._r8))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2602</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2603</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                esn = polysvp(ttmp,0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2604</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 esn = min(fpvsl(ttmp), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2605</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qsn = min(epsqs*esn/(p(i,k)-omeps*esn), one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2606</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2607</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! modify precip evaporation rate if q > qsat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2608</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qtmp > qsn) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2609</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (pre(k)+prds(k) &lt; -1.e-20) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2610</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum1 = pre(k) / (pre(k)+prds(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2611</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! recalculate q and t after cloud water cond but without precip evap</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2612</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     qtmp = q(i,k) - cmei(i,k)*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2613</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     ttmp = t(i,k) + cmei(i,k)*xxls*deltat/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2614</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                    esn = polysvp(ttmp,0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2615</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     esn = min(fpvsl(ttmp), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2616</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     qsn = min(epsqs*esn/(p(i,k)-omeps*esn), one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2617</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx1 = one / (cpp*rv*ttmp*ttmp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2618</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = min(zero, (qtmp-qsn)/(one+cons27*qsn*tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2619</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2620</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! modify rates if needed, divide by cldmax to get local (in-precip) value</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2621</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     pre(k) = dum*dum1/(deltat*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2622</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2623</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! do separately using RHI for prds....</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2624</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                    esn = polysvp(ttmp,1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2625</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     esn = min(fpvsi(ttmp), p(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2626</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     qsn = min(epsqs*esn/(p(i,k)-omeps*esn), one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2627</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = min(zero, (qtmp-qsn)/(one+cons28*qsn*tx1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2628</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2629</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! modify rates if needed, divide by cldmax to get local (in-precip) value</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2630</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     prds(k) = dum*(one-dum1)/(deltat*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2631</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2632</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2633</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2634</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2635</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2636</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! bergeron process - evaporation of droplets and deposition onto snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2637</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qniic(i,k) >= qsmall .and. qcic(i,k) >= qsmall</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2638</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                  .and. t(i,k) &lt; tmelt) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2639</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qvi = epsqs*esi(i,k)/(p(i,k)-omeps*esi(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2640</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qvs = epsqs*esl(i,k)/(p(i,k)-omeps*esl(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2641</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dqsidt = xxls*qvi/(rv*t(i,k)*t(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2642</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 abi = one + dqsidt*xxls/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2643</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 epss = (pi+pi)*n0s(k)*rho(i,k)*Dv(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2644</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                * (f1s/(lams(k)*lams(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2645</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 + f2s*sqrt(asn(i,k)*rho(i,k)/mu(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2646</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 * sc(i,k)**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2647</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 * cons14 / (lams(k)**((five+bs)*half)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2648</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 bergs(k) = epss*(qvs-qvi)/abi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2649</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2650</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 bergs(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2651</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2652</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2653</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2654</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2655</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2656</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation to ensure no negative values of cloud water/precipitation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2657</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! in case microphysical process rates are large</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2658</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2659</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure and use end-of-time step values for cloud water, ice, due</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2660</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! condensation/deposition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2661</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2662</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: for check on conservation, processes are multiplied by omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2663</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! to prevent problems due to round off error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2664</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2665</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! include mixing timescale  (mtime)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2666</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2667</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qce = max(qc(i,k)-berg(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2668</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nce = nc(i,k) + npccn(i,k)*deltat*mtime</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2669</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qie = qi(i,k) + (cmei(i,k)+berg(i,k))*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2670</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nie = ni(i,k) + nnuccd(k)*deltat*mtime</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2671</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2672</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of qc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2673</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2674</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = lcldm(i,k) * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2675</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum = (prc(k) + pra(k) + mnuccc(k) + mnucct(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2676</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             +  msacwi(k) + psacws(k) + bergs(k)) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2677</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2678</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dum > qce) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2679</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2680</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ratio = qce/dum * omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2681</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2682</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prc(k)    = prc(k)    * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2683</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 pra(k)    = pra(k)    * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2684</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnuccc(k) = mnuccc(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2685</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 mnucct(k) = mnucct(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2686</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 msacwi(k) = msacwi(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2687</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 psacws(k) = psacws(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2688</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 bergs(k)  = bergs(k)  * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2689</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2690</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2691</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of nc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2692</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2693</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2694</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum = (nprc1(k) + npra(k) + nnuccc(k) + nnucct(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2695</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;              + npsacws(k) - nsubc(k)) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2696</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2697</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dum > nce) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2698</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ratio = nce/dum * omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2699</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2700</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprc1(k)   = nprc1(k)   * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2701</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npra(k)    = npra(k)    * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2702</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnuccc(k)  = nnuccc(k)  * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2703</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nnucct(k)  = nnucct(k)  * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2704</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 npsacws(k) = npsacws(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2705</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsubc(k)   = nsubc(k)   * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2706</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2707</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2708</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of qi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2709</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2710</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum = ((-mnuccc(k)-mnucct(k)-msacwi(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2711</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;               + (prci(k)+prai(k))*icldm(i,k)) * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2712</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2713</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dum > qie) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2714</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (prci(k)+prai(k)  > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2715</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   ratio = (qie*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2716</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    +(mnuccc(k)+mnucct(k)+msacwi(k))*lcldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2717</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   / ((prci(k)+prai(k))*icldm(i,k))*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2718</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2719</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ratio = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2720</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2721</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2722</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prci(k) = prci(k)*ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2723</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prai(k) = prai(k)*ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2724</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2725</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2726</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of ni</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2727</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2728</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dum = ((-nnucct(k)-nsacwi(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2729</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             +  (nprci(k)+ nprai(k)-nsubi(k))*icldm(i,k))*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2730</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2731</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dum > nie) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2732</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if ( abs(nprci(k)+nprai(k)-nsubi(k)) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2733</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ratio = (nie*dti+(nnucct(k)+nsacwi(k))*lcldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2734</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                  / ((nprci(k)+nprai(k)-nsubi(k))*icldm(i,k))*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2735</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2736</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2737</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ratio = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2738</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2739</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprci(k) = nprci(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2740</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nprai(k) = nprai(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2741</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsubi(k) = nsubi(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2742</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2743</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2744</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for preciptiation conservation, use logic that vertical integral</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2745</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! of tendency from current level to top of model (i.e., qrtot) cannot be negative</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2746</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2747</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of rain mixing rat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2748</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2749</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if ( ((prc(k)+pra(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2750</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             + (-mnuccr(k)+pre(k)-pracs(k))*cldmax(i,k))*rdz</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2751</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;             + qrtot &lt; zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2752</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2753</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (-pre(k)+pracs(k)+mnuccr(k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2754</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2755</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ratio = (qrtot*rdzi + (prc(k)+pra(k))*lcldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2756</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                / ((-pre(k)+pracs(k)+mnuccr(k))*cldmax(i,k))*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2757</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2758</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   pre(k)    = pre(k)    * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2759</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   pracs(k)  = pracs(k)  * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2760</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   mnuccr(k) = mnuccr(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2761</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2762</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2763</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2764</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of nr -  for now neglect evaporation of nr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2765</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2766</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsubr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2767</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2768</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if ((nprc(k)*lcldm(i,k)+(-nnuccr(k)+nsubr(k)-npracs(k) +</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2769</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             nragg(k))*cldmax(i,k))*rdz + nrtot &lt; zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2770</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2771</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (-nsubr(k)-nragg(k)+npracs(k)+nnuccr(k) >= qsmall)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2772</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                                                         then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2773</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ratio = (nrtot*rdzi+nprc(k)*lcldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2774</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   / ((-nsubr(k)-nragg(k)+npracs(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2775</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       +nnuccr(k))*cldmax(i,k))*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2776</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2777</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsubr(k)  = nsubr(k)  * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2778</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   npracs(k) = npracs(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2779</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nnuccr(k) = nnuccr(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2780</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nragg(k)  = nragg(k)  * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2781</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2782</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2783</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2784</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of snow mix ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2785</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2786</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = (bergs(k)+psacws(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2787</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             + (prai(k)+prci(k))*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2788</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if ((tx1+(pracs(k)+ mnuccr(k)+prds(k))*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2789</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                  *rdz+qstot &lt; zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2790</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2791</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (-prds(k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2792</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2793</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   ratio = (qstot*rdzi + tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2794</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   + (pracs(k)+mnuccr(k))*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2795</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   / (-prds(k)*cldmax(i,k))*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2796</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2797</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   prds(k) = prds(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2798</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2799</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2800</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2801</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! conservation of ns</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2802</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2803</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate loss of number due to sublimation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2804</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for now neglect sublimation of ns</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2805</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsubs(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2806</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2807</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if ((nprci(k)*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2808</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;           +(nnuccr(k)+nsubs(k)+nsagg(k))*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2809</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;           * rdz + nstot &lt; zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2810</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2811</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (-nsubs(k)-nsagg(k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2812</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2813</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   ratio = (nstot*rdzi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2814</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    + nprci(k)*icldm(i,k)+ nnuccr(k)*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2815</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    / ((-nsubs(k)-nsagg(k))*cldmax(i,k))*omsm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2816</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2817</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsubs(k) = nsubs(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2818</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsagg(k) = nsagg(k) * ratio</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2819</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2820</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2821</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2822</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get tendencies due to microphysical conversion processes</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2823</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: tendencies are multiplied by appropaiate cloud/precip</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2824</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! fraction to get grid-scale values</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2825</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: cmei is already grid-average values</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2826</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2827</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qvlat(i,k) = qvlat(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2828</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    - (pre(k)+prds(k))*cldmax(i,k) - cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2829</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' qvlata=',qvlat(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2830</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;' pre=',pre(k),' prds=',prds(k),' cldmax=',cldmax(i,k),cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2831</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' it=',it</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2832</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2833</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tlat(i,k) = tlat(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2834</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   +  pre(k)*cldmax(i,k) * xxlv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2835</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   + (prds(k)*cldmax(i,k)+cmei(i,k)) * xxls</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2836</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   + ((bergs(k)+psacws(k)+mnuccc(k)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2837</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       mnucct(k)+msacwi(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2838</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                    + (mnuccr(k)+ pracs(k))*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2839</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                      + berg(i,k)) * xlf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2840</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2841</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2842</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      if(xlon&lt;0.01.and.xlon>-0.01.and.xlat>1.346</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2843</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; .and.xlat&lt;1.347.and.k==38)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2844</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; write(*,*)"anning_m0",pre(k),prds(k),cmei(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2845</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; bergs(k),psacws(k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2846</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; mnuccc(k),mnucct(k),msacwi(k),mnuccr(k),pracs(k),berg(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2847</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2848</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qctend(i,k) = qctend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2849</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (-pra(k)-prc(k)-mnuccc(k)-mnucct(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2850</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                        -msacwi(k)-psacws(k)-bergs(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2851</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     - berg(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2852</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2853</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qitend(i,k) = qitend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2854</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (mnuccc(k)+mnucct(k)+msacwi(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2855</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (-prci(k)-prai(k))*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2856</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + cmei(i,k) + berg(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2857</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2858</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qrtend(i,k) = qrtend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2859</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (pra(k)+prc(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2860</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (pre(k)-pracs(k)-mnuccr(k))*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2861</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2862</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qnitend(i,k) = qnitend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2863</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                      + (prai(k)+prci(k))*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2864</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                      + (psacws(k)+bergs(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2865</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                      + (prds(k)+pracs(k)+mnuccr(k))*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2866</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2867</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint) write(0,*)' k=',k,' qnitend=',qnitend(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2868</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; prai(k), prci(k), icldm(i,k),psacws(k),bergs(k),lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2869</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,prds(k),pracs(k),mnuccr(k),' cldmax=',cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2870</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2871</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add output for cmei (accumulate)!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2872</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               cmeiout(i,k) = cmeiout(i,k) + cmei(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2873</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2874</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2875</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2876</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2877</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2878</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assign variables for trop_mozart, these are grid-average</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2879</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! evaporation/sublimation is stored here as positive term</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2880</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2881</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               evapsnow(i,k) = evapsnow(i,k) + prds(k) * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2882</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nevapr(i,k)   = nevapr(i,k)   + pre(k)  * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2883</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2884</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! change to make sure prain is positive: do not remove snow from</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2885</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! prain used for wet deposition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2886</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               prain(i,k)    = prain(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2887</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       + (pra(k)+prc(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2888</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       + (-pracs(k)-mnuccr(k))*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2889</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2890</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               prodsnow(i,k) = prodsnow(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2891</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       + (prai(k)+prci(k))*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2892</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       + (psacws(k)+bergs(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2893</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       + (pracs(k)+mnuccr(k))*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2894</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2895</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! following are used to calculate 1st order conversion rate of cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2896</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    to rain and snow (1/s), for later use in aerosol wet removal routine</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2897</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! previously, wetdepa used (prain/qc) for this, and the qc in wetdepa may be smaller than the qc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2898</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    used to calculate pra, prc, ... in this routine</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2899</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! qcsinksum_rate1ord = sum over iterations{ rate of direct transfer of cloud water to rain &amp; snow }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2900</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                      (no cloud ice or bergeron terms)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2901</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! qcsum_rate1ord     = sum over iterations{ qc used in calculation of the transfer terms }</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2902</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2903</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qcsinksum_rate1ord(k) = qcsinksum_rate1ord(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2904</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                             +(pra(k)+prc(k)+psacws(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2905</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qcsum_rate1ord(k) = qcsum_rate1ord(k) + qc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2906</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2907</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! microphysics output, note this is grid-averaged</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2908</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               prao(i,k)     = prao(i,k)     + pra(k)    * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2909</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               prco(i,k)     = prco(i,k)     + prc(k)    * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2910</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               mnuccco(i,k)  = mnuccco(i,k)  + mnuccc(k) * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2911</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               mnuccto(i,k)  = mnuccto(i,k)  + mnucct(k) * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2912</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               msacwio(i,k)  = msacwio(i,k)  + msacwi(k) * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2913</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               psacwso(i,k)  = psacwso(i,k)  + psacws(k) * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2914</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               bergso(i,k)   = bergso(i,k)   + bergs(k)  * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2915</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               bergo(i,k)    = bergo(i,k)    + berg(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2916</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               prcio(i,k)    = prcio(i,k)    + prci(k)   * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2917</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               praio(i,k)    = praio(i,k)    + prai(k)   * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2918</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               mnuccro(i,k)  = mnuccro(i,k)  + mnuccr(k) * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2919</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               pracso (i,k)  = pracso (i,k)  + pracs (k) * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2920</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2921</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               mnuccdo(i,k)  = mnuccdo(i,k)  + mnuccd(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2922</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nnuccto(i,k)  = nnuccto(i,k)  + nnucct(k) * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2923</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2924</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nnuccdo(i,k)  = nnuccdo(i,k)  + nnuccd(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2925</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nnuccco(i,k)  = nnuccco(i,k)  + nnuccc(k) * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2926</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsacwio(i,k)  = nsacwio(i,k)  + nsacwi(k) * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2927</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsubio(i,k)   = nsubio(i,k)   + nsubi(k)  * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2928</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nprcio(i,k)   = nprcio(i,k)   + nprci(k)  * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2929</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               npraio(i,k)   = npraio(i,k)   + nprai(k)  * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2930</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2931</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               npccno(i, k)  = npccno(i,k)   + npccn(i,k)*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2932</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               npsacwso(i,k) = npsacwso(i,k) + npsacws(k)*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2933</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsubco(i,k)   = nsubco(i,k)   + nsubc(k)  * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2934</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nprao(i,k)    = nprao(i,k)    + npra(k)   * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2935</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nprc1o(i,k)   = nprc1o(i,k)   + nprc1(k)  * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2936</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2937</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2938</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! multiply activation/nucleation by mtime to account for fast timescale</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2939</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2940</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nctend(i,k) = nctend(i,k) + npccn(i,k)*mtime</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2941</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (-nnuccc(k)-nnucct(k)-npsacws(k)+nsubc(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2942</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                        -npra(k)-nprc1(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2943</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2944</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nitend(i,k) = nitend(i,k) + nnuccd(k)*mtime</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2945</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (nnuccc(k)+nnucct(k)+nsacwi(k))*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2946</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (nsubi(k)-nprci(k)- nprai(k))*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2947</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2948</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nstend(i,k) = nstend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2949</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (nsubs(k)+ nsagg(k)+nnuccr(k))*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2950</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + nprci(k)*icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2951</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2952</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nrtend(i,k) = nrtend(i,k) + nprc(k)*lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2953</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     + (nsubr(k)-npracs(k)-nnuccr(k)+nragg(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2954</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2955</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2956</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure that nc and ni at advanced time step do not exceed</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2957</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! maximum (existing N + source terms*dt), which is possible due to</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2958</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! fast nucleation timescale</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2959</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2960</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (nctend(i,k) > zero .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2961</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             nc(i,k)+nctend(i,k)*deltat > ncmax(i,k)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2962</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nctend(i,k) = max(zero, (ncmax(i,k)-nc(i,k))*dti)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2963</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2964</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (nitend(i,k) > zero .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2965</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             ni(i,k)+nitend(i,k)*deltat > nimax) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2966</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nitend(i,k) = max(zero, (nimax-ni(i,k))*dti)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2967</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2968</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2969</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2970</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get final values for precipitation q and N, based on</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2971</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! flux of precip from above, source/sink term, and terminal fallspeed</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2972</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! see eq. 15-16 in MG2008</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2973</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (fprcp == 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2974</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2975</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2976</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qric(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2977</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (k == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2978</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    qric(i,k) = qrtend(i,k)*dz(i,k)/(cldmax(i,k)*umr(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2979</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    nric(i,k) = nrtend(i,k)*dz(i,k)/(cldmax(i,k)*unr(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2980</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2981</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    tx1       = rho(i,km) * cldmax(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2982</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    tx3       = rho(i,k)  * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2983</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2984</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    qric(i,k) = (tx1*umr(km)*qric(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2985</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                        +  rdz*qrtend(i,k)) / (umr(k)*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2986</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2987</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    nric(i,k) = (tx1*unr(km)*nric(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2988</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                        +  rdz*nrtend(i,k)) / (unr(k)*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2989</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2990</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2991</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2992</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qric(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2993</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nric(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2994</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2995</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2996</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2997</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2998</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qniic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>2999</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (k == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3000</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx1        = dz(i,k)/cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3001</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     qniic(i,k) = qnitend(i,k)*tx1/ums(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3002</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     nsic(i,k)  = nstend(i,k)*tx1/uns(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3003</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3004</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx1        = rho(i,km) * cldmax(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3005</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx3        = rho(i,k)  * cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3006</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3007</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     qniic(i,k) = (tx1*ums(km)*qniic(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3008</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                          +  rdz*qnitend(i,k)) / (ums(k)*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3009</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     nsic(i,k)  = (tx1*uns(km)*nsic(i,km)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3010</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                          +  rdz*nstend(i,k))  / (uns(k)*tx3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3011</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3012</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3013</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qniic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3014</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsic(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3015</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3016</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3017</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate precipitation flux at surface</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3018</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! divide by density of water to get units of m/s</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3019</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3020</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1      = rdz/rhow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3021</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 prect(i) = prect(i) + (qrtend(i,k)+ qnitend(i,k))*tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3022</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 preci(i) = preci(i) +  qnitend(i,k)*tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3023</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3024</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint) write(0,*)' prect=',prect(i),' preci=',preci(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3025</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' qrtend=',qrtend(i,k),' qnitend=',qnitend(i,k),' rdz=',rdz</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3026</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' k=',k,' it=',it, 'rhow=',rhow,' rho=',rho(i,k),' dz=',dz(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3027</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3028</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3029</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3030</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 rainrt(i,k) = qric(i,k)*rho(i,k)*umr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3031</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       / rhow*3600._r8*1000._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3032</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3033</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! vertically-integrated precip source/sink terms (note: grid-averaged)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3034</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3035</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qrtot = max(qrtot + qrtend(i,k)*rdz,  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3036</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qstot = max(qstot + qnitend(i,k)*rdz, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3037</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nrtot = max(nrtot + nrtend(i,k)*rdz,  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3038</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nstot = max(nstot + nstend(i,k)*rdz,  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3039</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3040</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!! done up to here - Moorthi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3041</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate melting and freezing of precip</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3042</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! melt snow at +2 C</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3043</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 taux = 1.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3044</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3045</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 if (.true.) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3046</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3047</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1 = t(i,k) + tlat(i,k)*onebcp*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3048</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (tx1 > 275.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3049</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3050</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     if (qstot > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3051</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3052</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure melting snow doesn't reduce temperature below threshold</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3053</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       dum = xlfocp*qstot*rdzi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3054</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       if (tx1-dum*deltat &lt; 273.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3055</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                         tx2 = (tx1-275.15_r8) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3056</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                         dum = min(one,max(zero,tx2/dum))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3057</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3058</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                         dum = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3059</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3060</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3061</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       qric(i,k)  = qric(i,k) + dum*qniic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3062</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       nric(i,k)  = nric(i,k) + dum*nsic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3063</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       qniic(i,k) = (one-dum)*qniic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3064</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       nsic(i,k)  = (one-dum)*nsic(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3065</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! heating tendency</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3066</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       tmp = -xlf*dum*qstot*rdzi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3067</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       meltsdt(i,k) = meltsdt(i,k) + tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3068</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3069</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       tlat(i,k) = tlat(i,k) + tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3070</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3071</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      if(xlon&lt;0.01.and.xlon>-0.01.and.xlat>1.346</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3072</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; .and.xlat&lt;1.347.and.k==38)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3073</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; write(*,*)"anning_m1",tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3074</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3075</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       qrtot    = qrtot + dum*qstot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3076</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       nrtot    = nrtot + dum*nstot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3077</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       qstot    = (one-dum)*qstot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3078</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       nstot    = (one-dum)*nstot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3079</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                       preci(i) = (one-dum)*preci(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3080</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                     endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3081</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3082</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3083</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                  end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3084</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                  tlataux(i, k) = tlat(i, k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3085</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3086</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! freeze all rain at -5C for Arctic</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3087</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                  if(.true.) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3088</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3089</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    tx1 = t(i,k) + tlat(i,k)*onebcp*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3090</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    if (tx1 &lt; tmelt-five) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3091</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3092</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                      if (qrtot > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3093</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3094</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure freezing rain doesn't increase temperature above threshold</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3095</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        dum = xlfocp*qrtot*rdzi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3096</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        if (tx1+dum*deltat > tmelt-five) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3097</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                          tx2 = -(tx1 - (tmelt-five)) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3098</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                          dum = min(one,max(zero,tx2/dum))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3099</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                        else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3100</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                          dum = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3101</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                        endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3102</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        qniic(i,k)  = qniic(i,k) + dum*qric(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3103</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        nsic(i,k)   = nsic(i,k)  + dum*nric(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3104</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        qric(i,k)   = (one-dum)*qric(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3105</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        nric(i,k)   = (one-dum)*nric(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3106</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! heating tendency</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3107</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        tmp         = xlf*dum*qrtot*rdzi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3108</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        frzrdt(i,k) = frzrdt(i,k) + tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3109</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3110</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        tlat(i,k)   = tlat(i,k) + tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3111</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3112</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      if(xlon&lt;0.01.and.xlon>-0.01.and.xlat>1.346</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3113</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; .and.xlat&lt;1.347.and.k==38)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3114</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp; write(*,*)"anning_m2",tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3115</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3116</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        qstot    = qstot + dum*qrtot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3117</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        qrtot    = (one-dum)*qrtot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3118</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        nstot    = nstot + dum*nrtot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3119</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        nrtot    = (one-dum)*nrtot</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3120</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                        preci(i) = preci(i) + dum*(prect(i)-preci(i))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3121</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                      end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3122</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                    end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3123</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3124</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3125</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3126</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3127</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3128</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3129</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3130</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3131</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if rain/snow mix ratio is zero so should number concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3132</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3133</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qniic(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3134</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qniic(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3135</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsic(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3136</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3137</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3138</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qric(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3139</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qric(i,k) =  zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3140</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nric(i,k) =  zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3141</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3142</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3143</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure number concentration is a positive number to avoid</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3144</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! taking root of negative</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3145</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3146</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nric(i,k) = max(nric(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3147</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsic(i,k) = max(nsic(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3148</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3149</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3150</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get size distribution parameters for fallspeed calculations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3151</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3152</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3153</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3154</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qric(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3155</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lamr(k) = (pirhow*nric(i,k)/qric(i,k))**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3156</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0r(k)  = nric(i,k)*lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3157</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3158</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3159</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! change lammax and lammin for rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3160</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3161</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3162</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (lamr(k) &lt; lamminr) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3163</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     lamr(k)   = lamminr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3164</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx1       = lamr(k) * lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3165</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     n0r(k)    = tx1*tx1*qric(i,k)/pirhow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3166</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     nric(i,k) = n0r(k)/lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3167</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   else if (lamr(k) > lammaxr) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3168</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     lamr(k)   = lammaxr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3169</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx1       = lamr(k) * lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3170</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     n0r(k)    = tx1*tx1*qric(i,k)/pirhow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3171</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     nric(i,k) = n0r(k)/lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3172</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3173</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3174</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3175</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! 'final' values of number and mass weighted mean fallspeed for rain (m/s)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3176</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3177</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1    = arn(i,k) / lamr(k)**br</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3178</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx2    = 9.1_r8*rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3179</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   unr(k) = min(tx1*cons4, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3180</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   umr(k) = min(tx1*(cons5/6._r8),tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3181</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3182</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3183</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lamr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3184</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0r(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3185</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   umr(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3186</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   unr(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3187</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3188</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3189</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!calculate mean size of combined rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3190</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3191</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (lamr(k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3192</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   Artmp = n0r(k) * (0.5*pi) / (lamr(k)*lamr(k)*lamr(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3193</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3194</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   Artmp = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3195</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3196</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3197</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (lamc(k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3198</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   Actmp = cdist1(k) * pi * gamma(pgam(k)+three)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3199</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   / (four * lamc(k)*lamc(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3200</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3201</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                    Actmp = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3202</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3203</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3204</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (Actmp > zero .or.Artmp > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3205</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   rercld(i,k) = rercld(i,k)+three*(qric(i,k)+qcic(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3206</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                      /(four*rhow*(Actmp+Artmp))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3207</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   arcld(i,k)  = arcld(i,k) + one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3208</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3209</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3210</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3211</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3212</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3213</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qniic(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3214</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lams(k) = (cons6*cs*nsic(i,k) / qniic(i,k))**(one/ds)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3215</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0s(k)  = nsic(i,k)*lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3216</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3217</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3218</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3219</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3220</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (lams(k) &lt; lammins) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3221</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     lams(k)   = lammins</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3222</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     n0s(k)    = lams(k)**(ds+one)*qniic(i,k)/(cs*cons6)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3223</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     nsic(i,k) = n0s(k)/lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3224</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3225</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   else if (lams(k) > lammaxs) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3226</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     lams(k)   = lammaxs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3227</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     n0s(k)    = lams(k)**(ds+one)*qniic(i,k)/(cs*cons6)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3228</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     nsic(i,k) = n0s(k)/lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3229</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3230</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3231</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! 'final' values of number and mass weighted mean fallspeed for snow (m/s)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3232</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3233</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx1    = asn(i,k) / lams(k)**bs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3234</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tx2    = 1.2_r8*rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3235</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ums(k) = min(tx1*(cons8/6._r8), tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3236</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   uns(k) = min(tx1*cons7, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3237</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3238</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3239</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   lams(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3240</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   n0s(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3241</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   ums(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3242</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   uns(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3243</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3244</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3245</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!c........................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3246</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sum over sub-step for average process rates</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3247</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3248</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! convert rain/snow q and N for output to history, note,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3249</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! output is for gridbox average</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3250</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3251</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qrout(i,k) = qrout(i,k) + qric(i,k)*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3252</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qsout(i,k) = qsout(i,k) + qniic(i,k)*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3253</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx1        = rho(i,k)*cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3254</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nrout(i,k) = nrout(i,k) + nric(i,k)*tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3255</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsout(i,k) = nsout(i,k) + nsic(i,k)*tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3256</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3257</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if !fprcp Anning Cheng 9/16/2016</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3258</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                tlat1(i,k)     = tlat1(i,k)     + tlat(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3259</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                tlat1_aux(i,k) = tlat1_aux(i,k) + tlataux(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3260</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3261</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                qvlat1(i,k)  = qvlat1(i,k)  + qvlat(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3262</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                qctend1(i,k) = qctend1(i,k) + qctend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3263</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                qitend1(i,k) = qitend1(i,k) + qitend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3264</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                nctend1(i,k) = nctend1(i,k) + nctend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3265</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                nitend1(i,k) = nitend1(i,k) + nitend(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3266</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3267</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                t(i,k)  = t(i,k)  + tlat(i,k)   * deltat/cpp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3268</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                q(i,k)  = q(i,k)  + qvlat(i,k)  * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3269</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                qc(i,k) = qc(i,k) + qctend(i,k) * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3270</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                qi(i,k) = qi(i,k) + qitend(i,k) * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3271</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                nc(i,k) = nc(i,k) + nctend(i,k) * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3272</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                ni(i,k) = ni(i,k) + nitend(i,k) * deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3273</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3274</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                rainrt1(i,k) = rainrt1(i,k) + rainrt(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3275</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3276</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!divide rain radius over substeps for average</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3277</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                if (arcld(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3278</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                  rercld(i,k) = rercld(i,k) / arcld(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3279</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3280</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!calculate precip fluxes and adding them to summing sub-stepping variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3281</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3282</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                rflx(i,1) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3283</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                sflx(i,1) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3284</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3285</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3286</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                rflx(i,k+1) = qrout(i,k)*rho(i,k)*umr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3287</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                sflx(i,k+1) = qsout(i,k)*rho(i,k)*ums(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3288</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3289</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3290</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                rflx1(i,k+1) = rflx1(i,k+1) + rflx(i,k+1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3291</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                sflx1(i,k+1) = sflx1(i,k+1) + sflx(i,k+1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3292</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3293</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!c........................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3294</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3295</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             enddo    ! big k loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3296</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3297</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prect1(i) = prect1(i) + prect(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3298</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             preci1(i) = preci1(i) + preci(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3299</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3300</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          if (lprint) write(0,*)' prect1=',prect1(i),' prect=',</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3301</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;prect(i),' iter=',iter,' it=',it</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3302</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3303</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           enddo !end of  big iter loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3304</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3305</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do k = 1, pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3306</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             rate1ord_cw2pr_st(i,k) = qcsinksum_rate1ord(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3307</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3308</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                          / max(qcsum_rate1ord(k),1.0e-30_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3309</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3310</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3311</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         endif ! end of if (ltrue(i) == 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3312</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enddo   ! end of big i loop2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3313</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3314</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! convert dt from sub-step back to full time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3315</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3316</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       deltat = deltat*real(iter)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3317</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       dti    = one / deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3318</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3319</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3320</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.............................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3321</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3322</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do i=1,ncol  !big i loop3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3323</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3324</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         if (ltrue(i) == 0) then  ! skip all calculations if no cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3325</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3326</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3327</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                                  ! assign default values for effective radius</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3328</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             effc(i,k)    = 10._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3329</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             effi(i,k)    = 25._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3330</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             effc_fn(i,k) = 10._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3331</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             lamcrad(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3332</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             pgamrad(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3333</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             deffi(i,k)   = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3334</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3335</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3336</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3337</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3338</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nstep = 1 ! initialize nstep for sedimentation sub-steps</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3339</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3340</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! divide precip rate by number of sub-steps to get average over time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3341</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3342</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           prect(i) = prect1(i) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3343</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           preci(i) = preci1(i) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3344</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3345</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint) write(0,*)' prect=',prect(i),' prect1=',prect1(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3346</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;,' riter=',riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3347</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3348</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3349</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3350</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assign variables back to start-of-timestep values before updating after sub-steps</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3351</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3352</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             t(i,k)  = t1(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3353</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             q(i,k)  = q1(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3354</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qc(i,k) = qc1(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3355</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qi(i,k) = qi1(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3356</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nc(i,k) = nc1(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3357</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             ni(i,k) = ni1(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3358</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3359</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! divide microphysical tendencies by number of sub-steps to get average over time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3360</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3361</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tlat(i,k)    = tlat1(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3362</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qvlat(i,k)   = qvlat1(i,k)  * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3363</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qctend(i,k)  = qctend1(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3364</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qitend(i,k)  = qitend1(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3365</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nctend(i,k)  = nctend1(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3366</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nitend(i,k)  = nitend1(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3367</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3368</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tlataux(i,k) = tlat1_aux(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3369</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3370</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3371</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             rainrt(i,k)  = rainrt1(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3372</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3373</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! divide by number of sub-steps to find final values</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3374</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             rflx(i,k+1)  = rflx1(i,k+1) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3375</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             sflx(i,k+1)  = sflx1(i,k+1) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3376</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3377</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! divide output precip q and N by number of sub-steps to get average over time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3378</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3379</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qrout(i,k)   = qrout(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3380</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qsout(i,k)   = qsout(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3381</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nrout(i,k)   = nrout(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3382</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsout(i,k)   = nsout(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3383</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3384</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! divide trop_mozart variables by number of sub-steps to get average over time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3385</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3386</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nevapr(i,k)   = nevapr(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3387</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             evapsnow(i,k) = evapsnow(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3388</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prain(i,k)    = prain(i,k)    * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3389</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prodsnow(i,k) = prodsnow(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3390</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             cmeout(i,k)   = cmeout(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3391</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3392</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             cmeiout(i,k) = cmeiout(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3393</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             meltsdt(i,k) = meltsdt(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3394</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             frzrdt (i,k) = frzrdt (i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3395</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3396</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3397</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! microphysics output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3398</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prao(i,k)    = prao(i,k)    * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3399</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prco(i,k)    = prco(i,k)    * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3400</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             mnuccco(i,k) = mnuccco(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3401</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             mnuccto(i,k) = mnuccto(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3402</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             msacwio(i,k) = msacwio(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3403</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             psacwso(i,k) = psacwso(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3404</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             bergso(i,k)  = bergso(i,k)  * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3405</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             bergo(i,k)   = bergo(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3406</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prcio(i,k)   = prcio(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3407</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             praio(i,k)   = praio(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3408</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3409</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             mnuccdo(i,k) = mnuccdo(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3410</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             mnuccto(i,k) = mnuccto(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3411</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3412</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             mnuccro(i,k) = mnuccro(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3413</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             pracso (i,k) = pracso (i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3414</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3415</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!DONIFFFF==========================</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3416</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nnuccdo(i,k) = nnuccdo(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3417</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nnuccco(i,k) = nnuccco(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3418</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsacwio(i,k) = nsacwio(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3419</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsubio(i,k)  = nsubio(i,k)  * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3420</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nprcio(i,k)  = nprcio(i,k)  * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3421</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             npraio(i,k)  = npraio(i,k)  * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3422</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3423</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             npccno(i,k)   = npccno(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3424</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             npsacwso(i,k) = npsacwso(i,k) * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3425</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsubco(i,k)   = nsubco(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3426</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nprao(i,k)    = nprao(i,k)    * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3427</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nprc1o(i,k)   = nprc1o(i,k)   * riter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3428</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3429</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!=====================================</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3430</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3431</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3432</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! modify to include snow. in prain &amp; evap (diagnostic here: for wet dep)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3433</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3434</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prain(i,k) = prain(i,k) + prodsnow(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3435</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3436</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3437</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate sedimentation for cloud water and ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3438</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3439</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3440</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! update in-cloud cloud mixing ratio and number concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3441</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! with microphysical tendencies to calculate sedimentation, assign to dummy vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3442</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note: these are in-cloud values***, hence we divide by cloud fraction</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3443</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3444</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1 = one / lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3445</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx2 = one / icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3446</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumc(i,k)  = (qc(i,k) + qctend(i,k)*deltat) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3447</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumi(i,k)  = (qi(i,k) + qitend(i,k)*deltat) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3448</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = max((nc(i,k)+nctend(i,k)*deltat)*tx1, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3449</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumni(i,k) = max((ni(i,k)+nitend(i,k)*deltat)*tx2, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3450</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3451</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (nccons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3452</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = ncnst*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3453</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3454</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3455</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (nicons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3456</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumni(i,k) = ninst*irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3457</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3458</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3459</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! obtain new slope parameter to avoid possible singularity</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3460</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3461</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumi(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3462</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add upper limit to in-cloud number concentration to prevent numerical error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3463</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumni(i,k) = min(dumni(i,k),dumi(i,k)*1.e20_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3464</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lami(k)    = (cons1*ci* dumni(i,k)/dumi(i,k))**oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3465</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3466</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              miu_ice(k) = mui_hemp_l(lami(k)) Anning changed here</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3467</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               miu_ice(k) = max(min(0.008_r8*(lami(k)*0.01)**0.87_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3468</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                             10.0_r8), 0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3469</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1        = one + miu_ice(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3470</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2        = one / gamma(tx1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3471</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               aux        = (gamma(tx1+di)*tx2) ** oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3472</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lami(k)    = aux*lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3473</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3474</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0i(k)     = niic(i,k)*lami(k)**tx1 * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3475</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3476</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3477</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lami(k) &lt; lammini*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3478</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k)    = lammini</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3479</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 miu_ice(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3480</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 niic(i,k)  = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3481</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3482</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lami(k) > lammaxi*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3483</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k)    = lammaxi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3484</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 miu_ice(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3485</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 niic(i,k)  = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3486</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3487</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3488</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3489</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lami(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3490</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3491</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3492</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3493</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add upper limit to in-cloud number concentration to prevent numerical error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3494</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = min(dumnc(i,k),dumc(i,k)*1.e20_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3495</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add lower limit to in-cloud number concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3496</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = max(dumnc(i,k),cdnl*irho(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3497</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = 0.0005714_r8*(ncic(i,k)/1.e6_r8*rho(i,k))+0.2714_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3498</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               pgam(k)    = max(two, min(15._r8, one/(tx1*tx1)-one))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3499</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3500</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamc(k) = (cr*dumnc(i,k)*gamma(pgam(k)+four)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3501</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 / (dumc(i,k)*gamma(pgam(k)+one)))**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3502</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lammin  = (pgam(k)+one) / 50.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3503</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lammax  = (pgam(k)+one) / 2.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3504</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamc(k) = min(lammax, max(lamc(k),lammin))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3505</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3506</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamc(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3507</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3508</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3509</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate number and mass weighted fall velocity for droplets</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3510</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! include effects of sub-grid distribution of cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3511</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3512</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3513</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3514</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = lamc(k) ** bc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3515</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               unc = acn(i,k)*gamma(one+bc+pgam(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3516</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             / (tx1*gamma(pgam(k)+one))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3517</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               umc = acn(i,k)*gamma(four+bc+pgam(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3518</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;             / (tx1*gamma(pgam(k)+four))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3519</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! fallspeed for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3520</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               vtrmc(i,k) = umc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3521</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3522</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               umc = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3523</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               unc = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3524</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3525</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3526</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3527</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3528</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate number and mass weighted fall velocity for cloud ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3529</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3530</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumi(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3531</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               cons16 = gamma(one+bi+miu_ice(k))/gamma(one+miu_ice(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3532</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               cons17 = gamma(four+bi+miu_ice(k))/gamma(four+miu_ice(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3533</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3534</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1    = ain(i,k) / lami(k)**bi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3535</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2    = 1.2_r8*rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3536</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               uni    = min(tx1*cons16, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3537</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               umi    = min(tx1*cons17, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3538</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! fallspeed</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3539</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               vtrmi(i,k) = umi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3540</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3541</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               umi = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3542</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               uni = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3543</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3544</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3545</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!DONIFFFF tune up sedimentation vel!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3546</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             umi = umi*ui_scale</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3547</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             uni = uni*ui_scale</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3548</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3549</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3550</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1    = g*rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3551</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fi(k)  = tx1*umi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3552</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fni(k) = tx1*uni</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3553</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fc(k)  = tx1*umc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3554</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fnc(k) = tx1*unc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3555</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3556</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate number of split time steps to ensure courant stability criteria</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3557</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for sedimentation calculations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3558</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3559</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             rgvm  = max(fi(k),fc(k),fni(k),fnc(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3560</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nstep = max(int(rgvm*deltat/pdel(i,k)+one),nstep)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3561</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3562</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! redefine dummy variables - sedimentation is calculated over grid-scale</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3563</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! quantities to ensure conservation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3564</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3565</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumc(i,k)  = qc(i,k) + qctend(i,k)*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3566</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumi(i,k)  = qi(i,k) + qitend(i,k)*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3567</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = max(nc(i,k) + nctend(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3568</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumni(i,k) = max(ni(i,k) + nitend(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3569</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3570</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) &lt; qsmall) dumnc(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3571</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumi(i,k) &lt; qsmall) dumni(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3572</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3573</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end do         ! end of k loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3574</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3575</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do n = 1,nstep</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3576</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3577</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             do k = 1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3578</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               falouti(k)  = max(fi(k)  * dumi(i,k),  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3579</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faloutni(k) = max(fni(k) * dumni(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3580</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faloutc(k)  = max(fc(k)  * dumc(i,k),  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3581</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faloutnc(k) = max(fnc(k) * dumnc(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3582</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3583</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3584</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! top of model</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3585</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3586</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             k = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3587</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1      = one / pdel(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3588</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndi  = falouti(k)  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3589</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndni = faloutni(k) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3590</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndc  = faloutc(k)  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3591</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndnc = faloutnc(k) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3592</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3593</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add fallout terms to microphysical tendencies</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3594</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3595</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx2     = one / float(nstep)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3596</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx3     = deltat*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3597</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3598</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qitend(i,k) = qitend(i,k) - faltndi  * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3599</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nitend(i,k) = nitend(i,k) - faltndni * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3600</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qctend(i,k) = qctend(i,k) - faltndc  * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3601</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nctend(i,k) = nctend(i,k) - faltndnc * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3602</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3603</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sedimentation tendencies for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3604</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qcsedten(i,k) = qcsedten(i,k) - faltndc * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3605</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qisedten(i,k) = qisedten(i,k) - faltndi * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3606</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3607</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumi(i,k)  = dumi(i,k)  - faltndi *tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3608</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumni(i,k) = dumni(i,k) - faltndni*tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3609</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumc(i,k)  = dumc(i,k)  - faltndc *tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3610</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = dumnc(i,k) - faltndnc*tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3611</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3612</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             do k = 2,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3613</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3614</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for cloud liquid and ice, if cloud fraction increases with height</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3615</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! then add flux from above to both vapor and cloud water of current level</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3616</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! this means that flux entering clear portion of cell from above evaporates</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3617</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! instantly</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3618</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx4      = tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3619</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1      = one / pdel(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3620</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3621</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lcldm(i,k-1) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3622</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum  = min(one, lcldm(i,k)/lcldm(i,k-1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3623</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3624</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum = min(one, lcldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3625</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3626</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (icldm(i,k-1) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3627</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum1 = min(one, icldm(i,k)/icldm(i,k-1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3628</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3629</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum1 = min(one, icldm(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3630</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3631</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3632</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndqie = (falouti(k)  - falouti(k-1))       * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3633</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndi   = (falouti(k)  - dum1*falouti(k-1))  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3634</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndni  = (faloutni(k) - dum1*faloutni(k-1)) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3635</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3636</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndqce = (faloutc(k) -     faloutc(k-1))    * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3637</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndc   = (faloutc(k) - dum*faloutc(k-1))    * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3638</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndnc  = (faloutnc(k)- dum*faloutnc(k-1))   * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3639</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3640</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add fallout terms to eulerian tendencies</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3641</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3642</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qitend(i,k) = qitend(i,k) - faltndi  * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3643</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nitend(i,k) = nitend(i,k) - faltndni * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3644</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qctend(i,k) = qctend(i,k) - faltndc  * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3645</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nctend(i,k) = nctend(i,k) - faltndnc * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3646</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3647</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3648</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sedimentation tendencies for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3649</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qcsedten(i,k) = qcsedten(i,k) - faltndc * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3650</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qisedten(i,k) = qisedten(i,k) - faltndi * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3651</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3652</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add terms to to evap/sub of cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3653</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3654</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qvlat(i,k)   = qvlat(i,k)   - (faltndqie-faltndi) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3655</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3656</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' qvlatb=',qvlat(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3657</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;' tx2=',tx2,' faltndqie=',faltndqie,' faltndi=',faltndi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3658</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3659</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qisevap(i,k) = qisevap(i,k) + (faltndqie-faltndi) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3660</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3661</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3662</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qvlat(i,k)   = qvlat(i,k)   - (faltndqce-faltndc) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3663</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint .and. k == 29) write(0,*)' qvlatc=',qvlat(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3664</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    &amp;' tx2=',tx2,' faltndqce=',faltndqce,' faltndc=',faltndc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3665</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3666</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qcsevap(i,k) = qcsevap(i,k) + (faltndqce-faltndc) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3667</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3668</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3669</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tlat(i,k) = tlat(i,k) + ((faltndqie-faltndi)*xxls</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3670</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                               +  (faltndqce-faltndc)*xxlv) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3671</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3672</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3673</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumi(i,k)  = dumi(i,k)  - faltndi  * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3674</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumni(i,k) = dumni(i,k) - faltndni * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3675</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumc(i,k)  = dumc(i,k)  - faltndc  * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3676</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = dumnc(i,k) - faltndnc * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3677</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3678</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               Fni(K) = MAX(Fni(K)*tx1, Fni(K-1)*tx4) * pdel(i,K)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3679</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               FI(K)  = MAX(FI(K)*tx1,  FI(K-1)*tx4)  * pdel(i,K)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3680</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               fnc(k) = max(fnc(k)*tx1, fnc(k-1)*tx4) * pdel(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3681</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               Fc(K)  = MAX(Fc(K)*tx1,  Fc(K-1)*tx4)  * pdel(i,K)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3682</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3683</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end do            ! end of k loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3684</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3685</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! units below are m/s</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3686</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cloud water/ice sedimentation flux at surface</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3687</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! is added to precip flux at surface to get total precip (cloud + precip water)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3688</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! rate</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3689</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3690</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint) write(0,*)' befend prect=',prect(i),' preci=',preci(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3691</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx3      = tx2 / (g*1000._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3692</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prect(i) = prect(i) + (faloutc(pver)+falouti(pver)) * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3693</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             preci(i) = preci(i) + falouti(pver) * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3694</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3695</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if (lprint) write(0,*)' end prect=',prect(i),' preci=',preci(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3696</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3697</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end do        ! end of n loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3698</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3699</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3700</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! end sedimentation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3701</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3702</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate sedimentation for rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3703</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Anning Cheng 9/19/2016, forecast rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3704</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! reuse dummy variable for cloud water and ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3705</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  iter =1 for fprcp >= 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3706</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3707</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! initialize nstep for sedimentation sub-steps</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3708</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! reuse dumc, dumi, dumnc, and dumni</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3709</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         if (fprcp == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3710</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nstep = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3711</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3712</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3713</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3714</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            tx1 = deltat / lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3715</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            tx2 = deltat / icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3716</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            dumc(i,k)  = max(qrn(i,k)+qrtend(i,k)*tx1,  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3717</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            dumi(i,k)  = max(qsnw(i,k)+qnitend(i,k)*tx2,zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3718</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            dumnc(i,k) = max(nrn(i,k)+nrtend(i,k)*tx1,  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3719</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            dumni(i,k) = max(nsnw(i,k)+nstend(i,k)*tx2, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3720</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3721</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumc(i,k)  = max(qrn(i,k)+qrtend(i,k)*deltat,  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3722</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumi(i,k)  = max(qsnw(i,k)+qnitend(i,k)*deltat,zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3723</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = max(nrn(i,k)+nrtend(i,k)*deltat,  zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3724</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumni(i,k) = max(nsnw(i,k)+nstend(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3725</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3726</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if rain/snow mix ratio is zero so should number concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3727</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3728</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumi(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3729</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumi(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3730</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumni(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3731</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3732</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3733</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3734</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumc(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3735</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3736</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3737</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3738</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure number concentration is a positive number to avoid</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3739</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! taking root of negative</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3740</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3741</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = max(dumnc(i,k),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3742</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumni(i,k) = max(dumni(i,k),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3743</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3744</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3745</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get size distribution parameters for fallspeed calculations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3746</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3747</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! rain</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3748</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3749</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3750</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamr(k) = (pi*rhow*dumnc(i,k)/dumc(i,k))**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3751</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0r(k)  = dumnc(i,k)*lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3752</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3753</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3754</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! change lammax and lammin for rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3755</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3756</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3757</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lamr(k) &lt; lamminr) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3758</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3759</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamr(k)   = lamminr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3760</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3761</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0r(k)    = lamr(k)**4*dumc(i,k)/(pi*rhow)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3762</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dumnc(i,k) = n0r(k)/lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3763</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               else if (lamr(k) > lammaxr) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3764</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamr(k)   = lammaxr</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3765</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0r(k)    = lamr(k)**4*dumc(i,k)/(pi*rhow)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3766</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dumnc(i,k) = n0r(k)/lamr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3767</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3768</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3769</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3770</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! 'final' values of number and mass weighted mean fallspeed for rain (m/s)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3771</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3772</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1    = arn(i,k) / lamr(k)**br</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3773</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2    = 9.1_r8*rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3774</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               unr(k) = min(tx1*cons4, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3775</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               umr(k) = min(tx1*(cons5/6._r8),tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3776</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3777</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3778</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamr(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3779</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0r(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3780</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               umr(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3781</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               unr(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3782</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3783</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3784</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3785</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3786</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3787</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumi(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3788</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lams(k) = (cons6*cs*dumni(i,k)/ dumi(i,k))**(one/ds)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3789</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0s(k)  = dumni(i,k)*lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3790</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3791</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! check for slope</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3792</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust vars</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3793</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3794</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lams(k) &lt; lammins) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3795</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lams(k)    = lammins</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3796</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0s(k)     = lams(k)**(ds+one)*dumi(i,k)/(cs*cons6)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3797</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dumni(i,k) = n0s(k)/lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3798</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               else if (lams(k) > lammaxs) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3799</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lams(k)    = lammaxs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3800</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0s(k)     = lams(k)**(ds+one)*dumi(i,k)/(cs*cons6)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3801</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dumni(i,k) = n0s(k)/lams(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3802</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3803</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3804</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! 'final' values of number and mass weighted mean fallspeed for snow (m/s)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3805</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3806</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1    = asn(i,k) / lams(k)**bs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3807</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2    = 1.2_r8*rhof(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3808</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               ums(k) = min(tx1*(cons8/6._r8), tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3809</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               uns(k) = min(tx1*cons7, tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3810</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3811</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3812</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lams(k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3813</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0s(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3814</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               ums(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3815</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               uns(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3816</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3817</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3818</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1    = g*rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3819</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fi(k)  = tx1*ums(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3820</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fni(k) = tx1*uns(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3821</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fc(k)  = tx1*umr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3822</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fnc(k) = tx1*unr(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3823</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3824</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate number of split time steps to ensure courant stability criteria</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3825</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for sedimentation calculations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3826</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3827</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             rgvm  = max(fi(k),fc(k),fni(k),fnc(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3828</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nstep = max(int(rgvm*deltat/pdel(i,k)+one),nstep)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3829</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3830</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! redefine dummy variables - sedimentation is calculated over grid-scale</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3831</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! quantities to ensure conservation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3832</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3833</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qrn(i,k)  = (qrn(i,k)  + qrtend(i,k)*deltat)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3834</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qsnw(i,k) = (qsnw(i,k) + qnitend(i,k)*deltat)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3835</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nrn(i,k)  = max((nrn(i,k)  + nrtend(i,k)*deltat),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3836</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsnw(i,k) = max((nsnw(i,k) + nstend(i,k)*deltat),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3837</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3838</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (qrn(i,k)  &lt; qsmall) nrn(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3839</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (qsnw(i,k) &lt; qsmall) nsnw(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3840</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3841</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           enddo         ! end of k loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3842</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3843</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tx2     = one / float(nstep)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3844</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tx3     = deltat*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3845</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do n = 1,nstep</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3846</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3847</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             do k = 1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3848</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               falouti(k)  = max(fi(k)  * qsnw(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3849</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faloutni(k) = max(fni(k) * nsnw(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3850</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faloutc(k)  = max(fc(k)  * qrn(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3851</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faloutnc(k) = max(fnc(k) * nrn(i,k), zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3852</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3853</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3854</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! top of model</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3855</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3856</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             k = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3857</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1      = one / pdel(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3858</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndi  = falouti(k)  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3859</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndni = faloutni(k) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3860</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndc  = faloutc(k)  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3861</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             faltndnc = faloutnc(k) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3862</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3863</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add fallout terms to microphysical tendencies</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3864</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3865</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            qnitend(i,k) = qnitend(i,k) - faltndi  * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3866</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            nstend(i,k) = nstend(i,k) - faltndni * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3867</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            qrtend(i,k) = qrtend(i,k) - faltndc  * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3868</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!            nrtend(i,k) = nrtend(i,k) - faltndnc * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3869</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3870</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! sedimentation tendencies for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3871</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3872</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qsnw(i,k) = qsnw(i,k) - faltndi  * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3873</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsnw(i,k) = nsnw(i,k) - faltndni * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3874</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qrn(i,k)  = qrn(i,k)  - faltndc  * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3875</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nrn(i,k)  = nrn(i,k)  - faltndnc * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3876</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3877</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             do k = 2,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3878</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3879</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3880</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1      = one / pdel(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3881</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              dum  = min(one, lcldm(i,k)/lcldm(i,k-1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3882</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              dum1 = min(one, icldm(i,k)/icldm(i,k-1))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3883</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3884</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndc   = (faloutc(k)  - faloutc(k-1))  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3885</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndnc  = (faloutnc(k) - faloutnc(k-1)) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3886</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3887</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndi   = (falouti(k)  - falouti(k-1))  * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3888</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               faltndni  = (faloutni(k) - faloutni(k-1)) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3889</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3890</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qsnw(i,k) = qsnw(i,k) - faltndi  * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3891</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsnw(i,k) = nsnw(i,k) - faltndni * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3892</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qrn(i,k)  = qrn(i,k)  - faltndc  * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3893</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nrn(i,k)  = nrn(i,k)  - faltndnc * tx3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3894</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3895</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3896</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3897</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3898</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx5      = tx2 / (g*1000._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3899</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             prect(i) = prect(i) + (faloutc(pver)+falouti(pver)) * tx5</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3900</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             preci(i) = preci(i) + (falouti(pver)) * tx5</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3901</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3902</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end do        ! end of n loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3903</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         end if !fprcp ==1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3904</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! end sedimentation for rain and snow</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3905</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3906</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! get new update for variables that includes sedimentation tendency</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3907</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note : here dum variables are grid-average, NOT in-cloud</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3908</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3909</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! DONE UP TO HERE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3910</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3911</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (fprcp == 1) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3912</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate melting and freezing of precip</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3913</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! melt snow at +2 C</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3914</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3915</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3916</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = t(i,k) + tlat(i,k)*onebcp*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3917</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (tx1 > 275.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3918</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qsnw(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3919</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3920</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure melting snow doesn't reduce temperature below threshold</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3921</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = xlfocp*qsnw(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3922</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3923</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (tx1-dum &lt; 273.15_r8)  then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3924</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx2 = tx1-275.15_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3925</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = min(one,max(zero,tx2/dum))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3926</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3927</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3928</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3929</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3930</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qrn(i,k)  = qrn(i,k) + dum*qsnw(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3931</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nrn(i,k)  = nrn(i,k) + dum*nsnw(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3932</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qsnw(i,k) = (one-dum)*qsnw(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3933</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsnw(i,k)  = (one-dum)*nsnw(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3934</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! heating tendency</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3935</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tmp = -xlf*dum*qsnw(i,k)/deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3936</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3937</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tlat(i,k) = tlat(i,k) + tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3938</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3939</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   preci(i) = (one-dum)*preci(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3940</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3941</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3942</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3943</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! freeze all rain at -5C for Arctic</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3944</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3945</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = t(i,k) + tlat(i,k)*onebcp*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3946</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (tx1 &lt; tmelt-five) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3947</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3948</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (qrn(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3949</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3950</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure freezing rain doesn't increase temperature above threshold</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3951</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = xlfocp*qrn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3952</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   if (tx1+dum > tmelt-five) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3953</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     tx2 = -(tx1-(tmelt-5._r8))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3954</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = min(one,max(zero,tx2/dum))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3955</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3956</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                     dum = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3957</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                   end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3958</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3959</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qsnw(i,k) = qsnw(i,k)  + dum*qrn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3960</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nsnw(i,k) = nsnw(i,k)  + dum*nrn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3961</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   qrn(i,k)  = (one-dum)*qrn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3962</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   nrn(i,k)  = (one-dum)*nrn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3963</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! heating tendency</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3964</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tmp       = xlf*dum*qrn(i,k)/deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3965</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3966</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   tlat(i,k) = tlat(i,k) + tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3967</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3968</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   preci(i)  = preci(i) + dum*(prect(i)-preci(i))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3969</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3970</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3971</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3972</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if rain/snow mix ratio is zero so should number concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3973</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3974</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qsnw(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3975</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nsnw(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3976</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3977</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3978</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (qrn(i,k) &lt; qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3979</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nrn(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3980</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3981</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3982</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure number concentration is a positive number to avoid</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3983</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! taking root of negative</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3984</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3985</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nrn(i,k)  = max(nrn(i,k),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3986</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsnw(i,k) = max(nsnw(i,k),zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3987</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3988</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qrout(i,k) = qrout(i,k) + qrn(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3989</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               qsout(i,k) = qsout(i,k) + qsnw(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3990</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nrout(i,k) = nrout(i,k) + nrn(i,k)*rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3991</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               nsout(i,k) = nsout(i,k) + nsnw(i,k)*rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3992</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!.......................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3993</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if !fprcp ==1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3994</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3995</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3996</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3997</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumc(i,k)  = max(qc(i,k)+qctend(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3998</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumi(i,k)  = max(qi(i,k)+qitend(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>3999</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = max(nc(i,k)+nctend(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4000</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumni(i,k) = max(ni(i,k)+nitend(i,k)*deltat, zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4001</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4002</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4003</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (nccons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4004</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = ncnst * irho(i,k) * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4005</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4006</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4007</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (nicons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4008</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumni(i,k) = ninst * irho(i,k) * icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4009</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4010</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4011</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) &lt; qsmall) dumnc(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4012</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumi(i,k) &lt; qsmall) dumni(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4013</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4014</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate instantaneous processes (melting, homogeneous freezing)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4015</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4016</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1 = t(i,k) + tlat(i,k)*onebcp*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4017</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (tx1 > tmelt) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4018</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dumi(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4019</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4020</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit so that melting does not push temperature below freezing</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4021</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum = dumi(i,k)*xlfocp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4022</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (tx1-dum &lt; tmelt) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4023</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = (tx1-tmelt)*cpoxlf / dumi(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4024</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = max(zero, min(one, dum))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4025</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4026</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4027</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4028</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4029</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2 = dum*dumi(i,k)*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4030</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qctend(i,k) = qctend(i,k) + tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4031</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4032</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 melto(i,k)  = tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4033</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4034</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assume melting ice produces droplet</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4035</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! mean volume radius of 8 micron</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4036</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4037</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nctend(i,k) = nctend(i,k) + three*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4038</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                     / (four*pi*5.12e-16_r8*rhow)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4039</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4040</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qitend(i,k) = ((one-dum)*dumi(i,k)-qi(i,k))  * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4041</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nitend(i,k) = ((one-dum)*dumni(i,k)-ni(i,k)) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4042</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tlat(i,k)   = tlat(i,k) - xlf*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4043</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4044</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4045</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4046</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4047</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! homogeneously freeze droplets between  -35 C and -40 C</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4048</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4049</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1 = t(i,k) + tlat(i,k)*onebcp*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4050</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (tx1 &lt; 233.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4051</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4052</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dumc(i,k) > zero .and. qc(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4053</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4054</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit so that freezing does not push temperature above threshold</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4055</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 dum = dumc(i,k)*xlfocp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4056</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 if (tx1+dum > 233.15_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4057</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = -(tx1-233.15_r8)*cpoxlf / dumc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4058</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = max(zero, min(one, dum))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4059</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4060</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                   dum = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4061</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>                 end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4062</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4063</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tx2         = dum*dumc(i,k)*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4064</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qitend(i,k) = qitend(i,k) + tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4065</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4066</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 homoo(i,k)  = tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4067</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4068</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assume 25 micron mean volume radius of homogeneously frozen droplets</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4069</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! consistent with size of detrained ice in stratiform.F90</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4070</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4071</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nitend(i,k) = nitend(i,k) + dum*three*dumc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4072</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     / (four*3.14_r8*1.563e-14_r8* 500._r8) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4073</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 qctend(i,k) = ((one-dum)*dumc(i,k)-qc(i,k))  * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4074</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nctend(i,k) = ((one-dum)*dumnc(i,k)-nc(i,k)) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4075</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 tlat(i,k)   = tlat(i,k) + xlf*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4076</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4077</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4078</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4079</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4080</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! remove any excess over-saturation, which is possible due to non-linearity when adding</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4081</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! together all microphysical processes</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4082</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! follow code similar to old CAM scheme</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4083</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4084</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4085</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      qsn = min(epsqs*esn/(p(i,k)-omeps*esn),one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4086</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      if (qtmp > qsn .and. qsn > 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4087</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! expression below is approximate since there may be ice deposition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4088</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      dum = (qtmp-qsn)/(one+cons27*qsn/(cpp*rv*ttmp**2))/deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4089</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add to output cme</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4090</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! now add to tendencies, partition between liquid and ice based on temperature</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4091</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! now add to tendencies, partition between liquid and ice based on te</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4092</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      dum = (qtmp-qsn)/(one+(xxls*dum1+xxlv*(one-dum1))**2 &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4093</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                     *qsn/(cpp*rv*ttmp**2))/deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4094</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4095</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      qctend(i,k)=qctend(i,k)+dum*(one-dum1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4096</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4097</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!        qcreso(i,k)=dum*(one-dum1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4098</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      qitend(i,k)=qitend(i,k)+dum*dum1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4099</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      qireso(i,k)=dum*dum1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4100</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      qvlat(i,k)=qvlat(i,k)-dum</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4101</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! for output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4102</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!        qvres(i,k)=-dum</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4103</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      tlat(i,k)=tlat(i,k)+dum*(one-dum1)*xxlv+dum*dum1*xxls</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4104</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4105</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4106</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4107</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4108</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4109</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4110</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4111</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!...............................................................................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4112</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! calculate effective radius for pass to radiation code</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4113</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if no cloud water, default value is 10 micron for droplets,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4114</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! 25 micron for cloud ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4115</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4116</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! update cloud variables after instantaneous processes to get effective radius</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4117</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! variables are in-cloud to calculate size dist parameters</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4118</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4119</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1 = one / lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4120</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx2 = one / icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4121</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumc(i,k)  = max(qc(i,k)+qctend(i,k)*deltat, zero) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4122</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumi(i,k)  = max(qi(i,k)+qitend(i,k)*deltat, zero) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4123</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = max(nc(i,k)+nctend(i,k)*deltat, zero) * tx1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4124</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumni(i,k) = max(ni(i,k)+nitend(i,k)*deltat, zero) * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4125</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4126</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      if ((dumc(i, k)*1e6 .gt. 1.0) .and. dumnc(i, k) .lt. 1e-20) then!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4127</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4128</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!        print *, 'dumnc', dumnc(i,k)*1e-6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4129</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!        print *, 'dumc',  dumc(i, k)*1e6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4130</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!        print *, i, k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4131</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4132</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4133</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4134</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (nccons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4135</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = ncnst * irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4136</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4137</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4138</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (nicons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4139</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumni(i,k) = ninst * irho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4140</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4141</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4142</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4143</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit in-cloud mixing ratio of water and ice to reasonable value of 5 g kg-1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4144</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4145</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumc(i,k) = min(dumc(i,k),5.e-3_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4146</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumi(i,k) = min(dumi(i,k),5.e-3_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4147</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4148</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!...................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4149</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cloud ice effective radius</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4150</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4151</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumi(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4152</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add upper limit to in-cloud number concentration to prevent numerical error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4153</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumni(i,k) = min(dumni(i,k),dumi(i,k)*1.e20_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4154</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lami(k)    = (cons1*ci* dumni(i,k)/dumi(i,k))**oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4155</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4156</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              miu_ice(k) = mui_hemp_l(lami(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4157</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               miu_ice(k) = max(min(0.008_r8*(lami(k)*0.01)**0.87_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4158</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                            10.0_r8), 0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4159</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1        = one + miu_ice(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4160</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2        = one / gamma(tx1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4161</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               aux        = (gamma(tx1+di)*tx2) ** oneodi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4162</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lami(k)    = aux*lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4163</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               n0i(k)     = niic(i,k) * lami(k)**tx1 * tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4164</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4165</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lami(k) &lt; lammini*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4166</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 miu_ice(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4167</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k)     = lammini</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4168</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0i(k)      = lami(k)**(di+one)*dumi(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4169</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 niic(i,k)   = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4170</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust number conc if needed to keep mean size in reasonable range</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4171</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nitend(i,k) = (niic(i,k)*icldm(i,k)-ni(i,k))/deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4172</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               else if (lami(k) > lammaxi*aux) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4173</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 miu_ice(k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4174</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lami(k)     = lammaxi</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4175</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 n0i(k)      = lami(k)**(di+one)*dumi(i,k)/(ci*cons1)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4176</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 niic(i,k)   = n0i(k)/lami(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4177</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nitend(i,k) = (niic(i,k)*icldm(i,k)-ni(i,k))/deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4178</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4179</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4180</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               effi(i,k) = 1.e6_r8*gamma(four+miu_ice(k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4181</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                   / (two*lami(k)*gamma(three+miu_ice(k)))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4182</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4183</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               effi(i,k) = 25._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4184</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4185</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4186</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!...................</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4187</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! cloud droplet effective radius</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4188</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4189</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4190</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4191</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4192</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add upper limit to in-cloud number concentration to prevent numerical error</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4193</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = min(dumnc(i,k),dumc(i,k)*1.e20_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4194</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4195</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4196</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! set tendency to ensure minimum droplet concentration</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4197</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! after update by microphysics, except when lambda exceeds bounds on mean drop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4198</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! size or if there is no cloud water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4199</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (dumnc(i,k) &lt; cdnl*irho(i,k)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4200</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nctend(i,k) = (cdnl*irho(i,k)*cldm(i,k)-nc(i,k))*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4201</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4202</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               dumnc(i,k) = max(dumnc(i,k),cdnl*irho(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4203</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4204</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (nccons) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4205</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure nc is consistence with the constant N by adjusting tendency, need</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4206</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! to multiply by cloud fraction</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4207</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! note that nctend may be further adjusted below if mean droplet size is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4208</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! out of bounds</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4209</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4210</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nctend(i,k) = (ncnst*irho(i,k)*lcldm(i,k)-nc(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4211</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                       * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4212</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4213</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4214</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4215</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4216</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = 0.0005714_r8*(ncic(i,k)/1.e6_r8*rho(i,k))+0.2714_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4217</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               pgam(k) = max(two, min(15._r8, one/(tx1*tx1)-one))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4218</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4219</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1     = gamma(pgam(k)+one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4220</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2     = gamma(pgam(k)+four)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4221</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamc(k) = (cr*dumnc(i,k)*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4222</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 / (dumc(i,k)*tx1))**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4223</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lammin  = (pgam(k)+one) / 50.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4224</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lammax  = (pgam(k)+one) / 2.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4225</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lamc(k) &lt; lammin) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4226</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamc(k)   = lammin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4227</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ncic(i,k) = 6._r8*lamc(k)*lamc(k)*lamc(k)*dumc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4228</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     * tx1 / (pirhow*tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4229</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust number conc if needed to keep mean size in reasonable range</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4230</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                nctend(i,k) = (ncic(i,k)*lcldm(i,k)-nc(i,k))*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4231</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4232</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               else if (lamc(k) > lammax) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4233</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamc(k)   = lammax</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4234</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 ncic(i,k) = 6._r8*lamc(k)*lamc(k)*lamc(k)*dumc(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4235</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                     * tx1 / (pirhow*tx2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4236</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! adjust number conc if needed to keep mean size in reasonable range</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4237</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 nctend(i,k) = (ncic(i,k)*lcldm(i,k)-nc(i,k))*dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4238</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4239</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4240</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               effc(i,k) = tx2 / (gamma(pgam(k)+three)*lamc(k)*2.e6_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4241</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!assign output fields for shape here</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4242</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamcrad(i,k) = lamc(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4243</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               pgamrad(i,k) = pgam(k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4244</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4245</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4246</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               effc(i,k)    = 10._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4247</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamcrad(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4248</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               pgamrad(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4249</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4250</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4251</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4252</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ice effective diameter for david mitchell's optics</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4253</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             deffi(i,k) = effi(i,k) * (rhoi / 917._r8*two)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4254</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4255</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4256</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!! recalculate effective radius for constant number, in order to separate</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4257</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! first and second indirect effects</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4258</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! assume constant number of 10^8 kg-1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4259</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4260</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dumnc(i,k) = 1.e8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4261</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4262</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             if (dumc(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4263</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx1 = 0.0005714_r8*(ncic(i,k)/1.e6_r8*rho(i,k))+0.2714_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4264</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               pgam(k) = max(two, min(15._r8, one/(tx1*tx1)-one))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4265</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               tx2     = gamma(pgam(k)+four)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4266</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lamc(k) = (cr*dumnc(i,k)*tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4267</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 / (dumc(i,k)*gamma(pgam(k)+one)))**oneb3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4268</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lammin  = (pgam(k)+one) / 50.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4269</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               lammax  = (pgam(k)+one) / 2.e-6_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4270</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               if (lamc(k) &lt; lammin) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4271</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamc(k) = lammin</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4272</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               else if (lamc(k) > lammax) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4273</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>                 lamc(k) = lammax</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4274</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>               end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4275</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               effc_fn(i,k) = tx2/(gamma(pgam(k)+three)*lamc(k)*2.e6_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4276</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4277</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4278</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>               effc_fn(i,k) = 10._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4279</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>             end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4280</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4281</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4282</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4283</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4284</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end do       ! end of k loop after n loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4285</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4286</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4287</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         endif ! end of if (ltrue(i) == 0) loop</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4288</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4289</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! convert dt from sub-step back to full time step</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4290</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4291</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         deltat = deltat*real(iter)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4292</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         dti    = one / deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4293</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4294</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4295</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4296</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if updated q (after microphysics) is zero, then ensure updated n is also zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4297</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4298</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qc(i,k)+qctend(i,k)*deltat &lt; qsmall)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4299</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 nctend(i,k) = -nc(i,k) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4300</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qi(i,k)+qitend(i,k)*deltat &lt; qsmall)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4301</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                 nitend(i,k) = -ni(i,k) * dti</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4302</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4303</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4304</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4305</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do  !end big i loop3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4306</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4307</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4308</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!print*, 'nctend', 1.0e-6*nctend*deltat</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4309</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4310</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! hm add rain/snow mixing ratio and number concentration as diagnostic</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4311</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4312</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef  CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4313</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('QRAIN',qrout, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4314</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('QSNOW',qsout, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4315</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('NRAIN',nrout, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4316</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('NSNOW',nsout, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4317</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4318</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4319</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add snow output</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4320</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4321</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4322</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qsout(i,k) > 1.e-7_r8 .and. nsout(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4323</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dsout(i,k) = (pirhosn * nsout(i,k)/qsout(i,k)) **(-oneb3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4324</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4325</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4326</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4327</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4328</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4329</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('DSNOW',dsout, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4330</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4331</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! add ip fluxes as output fields</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4332</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('MGFLXPRC',rflx, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4333</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('MGFLXSNW',sflx, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4334</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4335</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4336</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4337</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4338</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if ((qc(i,k)+qctend(i,k)*deltat >= qsmall) .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4339</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;         (cldmax(i,k) > zero) .and. (lcldm(i, k) > zero) .and.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4340</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;         (nc(i,k)+nctend(i,k)*deltat > 0.0)) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4341</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4342</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx1 = rho(i,k) / lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4343</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             tx2 = (qc(i,k)+qctend(i,k)*deltat)*tx1*1000._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4344</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum = tx2 * tx2 * lcldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4345</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;           / (0.109_r8*(nc(i,k)+nctend(i,k)*deltat)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4346</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                      *tx1*1.e-6_r8*cldmax(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4347</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4348</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4349</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4350</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qi(i,k)+qitend(i,k)*deltat >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4351</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum1 = ((qi(i,k)+qitend(i,k)*deltat)*rho(i,k)/icldm(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4352</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;            * 1000._r8/0.1_r8)**(one/0.63_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4353</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;            * icldm(i,k)/cldmax(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4354</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4355</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum1 = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4356</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4357</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4358</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qsout(i,k) >= qsmall) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4359</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum1 = dum1 + (qsout(i,k)*rho(i,k)*1000._r8/0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4360</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp;                                          **(one/0.63_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4361</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4362</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4363</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           refl(i,k) = dum + dum1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4364</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4365</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (rainrt(i,k) >= 0.001) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4366</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum = log10(rainrt(i,k)**6._r8) + 16._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4367</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum = 10._r8**(dum/10._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4368</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4369</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dum = 0.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4370</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4371</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4372</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           refl(i,k)   = refl(i,k) + dum</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4373</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4374</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           areflz(i,k) = refl(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4375</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4376</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (refl(i,k) > minrefl) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4377</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             refl(i,k) = 10._r8*log10(refl(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4378</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4379</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             refl(i,k) = -9999._r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4380</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4381</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4382</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (refl(i,k) > mindbz) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4383</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             arefl(i,k)  = refl(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4384</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             frefl(i,k)  = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4385</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4386</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             arefl(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4387</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             areflz(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4388</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             frefl(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4389</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4390</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4391</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           csrfl(i,k) = min(csmax,refl(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4392</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4393</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (csrfl(i,k) > csmin) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4394</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             acsrfl(i,k) = refl(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4395</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fcsrfl(i,k) = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4396</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4397</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             acsrfl(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4398</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             fcsrfl(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4399</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4400</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4401</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4402</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4403</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4404</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4405</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('REFL',refl, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4406</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('AREFL',arefl, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4407</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('AREFLZ',areflz, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4408</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('FREFL',frefl, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4409</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('CSRFL',csrfl, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4410</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('ACSRFL',acsrfl, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4411</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('FCSRFL',fcsrfl, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4412</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4413</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('RERCLD',rercld, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4414</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4415</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4416</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! averaging for snow and rain number and diameter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4417</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4418</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4419</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4420</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qrout2(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4421</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nrout2(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4422</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           drout2(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4423</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           freqr(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4424</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4425</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           qsout2(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4426</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nsout2(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4427</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dsout2(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4428</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           freqs(i,k)  = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4429</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4430</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qrout(i,k) > 1.e-7_r8 .and. nrout(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4431</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qrout2(i,k) = qrout(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4432</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nrout2(i,k) = nrout(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4433</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             drout2(i,k) = (pirhow*nrout(i,k) / qrout(i,k))**(-oneb3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4434</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             freqr(i,k)  = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4435</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4436</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (qsout(i,k) > 1.e-7_r8 .and. nsout(i,k) > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4437</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             qsout2(i,k) = qsout(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4438</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nsout2(i,k) = nsout(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4439</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             dsout2(i,k) = (pirhosn*nsout(i,k) / qsout(i,k))**(-oneb3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4440</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             freqs(i,k)  = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4441</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4442</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4443</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! output activated liquid and ice (convert from #/kg -> #/m3)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4444</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           ncai(i,k) = dum2i(i,k)*rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4445</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           ncal(i,k) = dum2l(i,k)*rho(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4446</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4447</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4448</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4449</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4450</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4451</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('NCAL',ncal, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4452</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('NCAI',ncai, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4453</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4454</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!add averaged output fields.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4455</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('AQRAIN',qrout2, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4456</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('AQSNOW',qsout2, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4457</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('ANRAIN',nrout2, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4458</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('ANSNOW',nsout2, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4459</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('ADRAIN',drout2, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4460</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('ADSNOW',dsout2, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4461</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('FREQR',freqr, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4462</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('FREQS',freqs, pcols,lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4463</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4464</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4465</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!redefine fice here....</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4466</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       do k=1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4467</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         do i=1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4468</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           nfice(i,k) = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4469</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tx1        = qc(i,k) + qctend(i,k)*deltat    ! water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4470</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           tx2        = qi(i,k) + qitend(i,k)*deltat    ! ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4471</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           dumfice    = qsout(i,k) + qrout(i,k) + tx1 + tx2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4472</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           if (dumfice > zero) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4473</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             nfice(i,k) = (qsout(i,k) + tx2) / dumfice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4474</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>           endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4475</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4476</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enddo</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4477</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4478</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4479</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call outfld('FICE',nfice, pcols, lchnk)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4480</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4481</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4482</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>      return</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4483</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      end subroutine mmicro_pcond</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4484</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4485</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef CAM</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4486</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4487</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!##############################################################################</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4488</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4489</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      subroutine findsp1 (lchnk, ncol, q, t, p, tsp, qsp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4490</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4491</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4492</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Purpose:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4493</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     find the wet bulb temperature for a given t and q</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4494</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     in a longitude height section</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4495</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     wet bulb temp is the temperature and spec humidity that is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4496</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     just saturated and has the same enthalpy</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4497</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if q > qs(t) then tsp > t and qsp = qs(tsp) &lt; q</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4498</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if q &lt; qs(t) then tsp &lt; t and qsp = qs(tsp) > q</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4499</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4500</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Method:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4501</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! a Newton method is used</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4502</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! first guess uses an algorithm provided by John Petch from the UKMO</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4503</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! we exclude points where the physical situation is unrealistic</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4504</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! e.g. where the temperature is outside the range of validity for the</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4505</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      saturation vapor pressure, or where the water vapor pressure</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4506</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      exceeds the ambient pressure, or the saturation specific humidity is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4507</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      unrealistic</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4508</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4509</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Author: P. Rasch</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4510</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4511</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4512</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4513</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     input arguments</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4514</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4515</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer, intent(in) :: lchnk</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4516</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer, intent(in) :: ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4517</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4518</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: q(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4519</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: t(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4520</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: p(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4521</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4522</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! output arguments</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4523</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4524</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: tsp(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4525</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qsp(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4526</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4527</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! local variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4528</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4529</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer i</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4530</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4531</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical lflg</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4532</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer iter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4533</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer l</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4534</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical :: error_found</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4535</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4536</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) omeps</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4537</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) trinv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4538</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4539</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) desdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4540</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     real(r8) desdp                ! change in sat vap pressure wrt pressure</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4541</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dqsdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4542</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dgdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4543</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) g</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4544</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) weight(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4545</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) hlatsb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4546</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) hlatvp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4547</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) hltalt(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4548</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) tterm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4549</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) qs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4550</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) tc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4551</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4552</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! work variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4553</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) t1, q1, dt, dq</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4554</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dtm, dqm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4555</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) qvd, a1, tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4556</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) rair</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4557</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) r1b, c1, c2, c3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4558</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) denom</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4559</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dttol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4560</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dqtol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4561</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer doit(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4562</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) enin(pcols), enout(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4563</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) tlim(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4564</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4565</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       omeps = one - epsqs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4566</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       trinv = one / ttrice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4567</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       a1 = 7.5_r8*log(10._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4568</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       rair = 287.04_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4569</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       c3 = rair*a1/cp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4570</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dtm = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4571</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqm = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4572</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dttol = 1.e-4_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4573</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqtol = 1.e-4_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4574</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  tmin = 173.16 ! the coldest temperature we can deal with</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4575</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4576</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! max number of times to iterate the calculation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4577</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       iter = 10</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4578</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4579</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do k = 1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4580</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4581</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4582</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! first guess on the wet bulb temperature</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4583</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4584</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4585</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4586</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef DEBUG</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4587</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if ( (lchnk == lchnklook(nlook) ) .and. (i ==</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4588</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; icollook(nlook) ) ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4589</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' '</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4590</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' level, t, q, p', k, t(i,k), q(i,k), p(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4591</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4592</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4593</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4594</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit the temperature range to that relevant to the sat vap pres tables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4595</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#if ( defined WACCM_PHYS )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4596</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tlim(i) = min(max(t(i,k),128._r8),373._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4597</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4598</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tlim(i) = min(max(t(i,k),173._r8),373._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4599</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4600</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = estblf(tlim(i))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4601</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       denom = p(i,k) - omeps*es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4602</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qs = epsqs*es/denom</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4603</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4604</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enout(i) = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4605</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure a meaningful calculation is possible</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4606</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (p(i,k) > 5._r8*es .and. qs > zero .and. qs &lt; 0.5_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4607</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4608</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Saturation specific humidity</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4609</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4610</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qs = min(epsqs*es/denom,one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4611</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4612</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! "generalized" analytic expression for t derivative of es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4613</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  accurate to within 1 percent for 173.16 &lt; t &lt; 373.16</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4614</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4615</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Weighting of hlat accounts for transition from water to ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4616</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! polynomial expression approximates difference between es over</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4617</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! water and es over ice from 0 to -ttrice (C) (min of ttrice is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4618</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! -40): required for accurate estimate of es derivative in transition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4619</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! range from ice to water also accounting for change of hlatv with t</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4620</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! above freezing where const slope is given by -2369 j/(kg c) = cpv - cw</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4621</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4622</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tc = tlim(i) - tt0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4623</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       lflg = (tc >= -ttrice .and. tc &lt; zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4624</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       weight(i) = min(-tc*trinv,one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4625</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatsb = hlatv + weight(i)*hlatf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4626</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatvp = hlatv - 2369.0_r8*tc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4627</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tlim(i) &lt; tt0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4628</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatsb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4629</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4630</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatvp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4631</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4632</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enin(i) = cp*tlim(i) + hltalt(i,k)*q(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4633</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4634</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make a guess at the wet bulb temp using a UKMO algorithm (from J. Petch)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4635</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tmp = q(i,k) - qs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4636</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       c1 = hltalt(i,k)*c3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4637</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       c2 = (tlim(i) + 36._r8)**2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4638</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       r1b = c2/(c2 + c1*qs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4639</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qvd = r1b*tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4640</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tsp(i,k) = tlim(i) + ((hltalt(i,k)/cp)*qvd)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4641</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef DEBUG</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4642</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if ( (lchnk == lchnklook(nlook) ) .and. (i ==</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4643</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; icollook(nlook) ) ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4644</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' relative humidity ', q(i,k)/qs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4645</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' first guess ', tsp(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4646</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4647</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4648</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = estblf(tsp(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4649</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qsp(i,k) = min(epsqs*es/(p(i,k) - omeps*es),one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4650</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4651</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4652</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tsp(i,k) = tlim(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4653</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qsp(i,k) = q(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4654</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enin(i) = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4655</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4656</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4657</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4658</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! now iterate on first guess</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4659</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4660</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do l = 1, iter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4661</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dtm = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4662</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqm = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4663</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4664</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4665</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = estblf(tsp(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4666</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4667</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Saturation specific humidity</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4668</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4669</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qs = min(epsqs*es/(p(i,k) - omeps*es),one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4670</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4671</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! "generalized" analytic expression for t derivative of es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4672</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! accurate to within 1 percent for 173.16 &lt; t &lt; 373.16</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4673</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4674</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Weighting of hlat accounts for transition from water to ice</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4675</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! polynomial expression approximates difference between es over</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4676</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! water and es over ice from 0 to -ttrice (C) (min of ttrice is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4677</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! -40): required for accurate estimate of es derivative in transition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4678</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! range from ice to water also accounting for change of hlatv with t</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4679</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! above freezing where const slope is given by -2369 j/(kg c) = cpv - cw</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4680</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4681</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tc = tsp(i,k) - tt0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4682</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       lflg = (tc >= -ttrice .and. tc &lt; zero)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4683</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       weight(i) = min(-tc*trinv,one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4684</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatsb = hlatv + weight(i)*hlatf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4685</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatvp = hlatv - 2369.0_r8*tc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4686</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tsp(i,k) &lt; tt0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4687</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatsb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4688</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4689</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatvp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4690</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4691</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (lflg) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4692</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tterm = pcf(1) + tc*(pcf(2) + tc*(pcf(3)+tc*(pcf(4) + tc*</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4693</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;pcf(5))))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4694</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4695</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tterm = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4696</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4697</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       desdt = hltalt(i,k)*es/(rgasv*tsp(i,k)*tsp(i,k)) + tterm*trinv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4698</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqsdt = (epsqs + omeps*qs)/(p(i,k) - omeps*es)*desdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4699</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              g = cp*(tlim(i)-tsp(i,k)) + hltalt(i,k)*q(i,k)- hltalt(i,k)*qsp(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4700</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       g = enin(i) - (cp*tsp(i,k) + hltalt(i,k)*qsp(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4701</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dgdt = -(cp + hltalt(i,k)*dqsdt)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4702</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       t1 = tsp(i,k) - g/dgdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4703</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dt = abs(t1 - tsp(i,k))/t1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4704</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tsp(i,k) = max(t1,tmin)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4705</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = estblf(tsp(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4706</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       q1 = min(epsqs*es/(p(i,k) - omeps*es),one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4707</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dq = abs(q1 - qsp(i,k))/max(q1,1.e-12_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4708</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qsp(i,k) = q1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4709</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef DEBUG</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4710</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if ( (lchnk == lchnklook(nlook) ) .and. (i ==</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4711</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; icollook(nlook) ) ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4712</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' rel chg lev, iter, t, q ', k, l, dt, dq, g</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4713</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4714</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4715</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dtm = max(dtm,dt)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4716</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqm = max(dqm,dq)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4717</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if converged at this point, exclude it from more iterations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4718</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (dt &lt; dttol .and. dq &lt; dqtol) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4719</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4720</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4721</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enout(i) = cp*tsp(i,k) + hltalt(i,k)*qsp(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4722</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! bail out if we are too near the end of temp range</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4723</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#if ( defined WACCM_PHYS )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4724</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tsp(i,k) &lt; 130.16_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4725</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4726</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tsp(i,k) &lt; 174.16_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4727</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4728</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4729</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4730</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4731</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4732</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4733</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4734</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (dtm &lt; dttol .and. dqm &lt; dqtol) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4735</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       go to 10</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4736</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4737</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4738</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4739</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      10 continue</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4740</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4741</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       error_found = .false.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4742</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (dtm > dttol .or. dqm > dqtol) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4743</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4744</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 0) error_found = .true.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4745</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4746</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (error_found) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4747</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4748</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4749</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' findsp not converging at point i, k ', i, k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4750</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' t, q, p, enin ', t(i,k), q(i,k), p(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4751</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enin(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4752</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' tsp, qsp, enout ', tsp(i,k), qsp(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4753</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enout(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4754</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call endrun ('FINDSP')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4755</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4756</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4757</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4758</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4759</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4760</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 2 .and. abs((enin(i)-enout(i))/(enin(i)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4761</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;enout(i))) > 1.e-4_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4762</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       error_found = .true.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4763</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4764</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4765</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (error_found) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4766</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4767</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 2 .and. abs((enin(i)-enout(i))/(enin(i)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4768</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;enout(i))) > 1.e-4_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4769</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' the enthalpy is not conserved for point ', i,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4770</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; k, enin(i), enout(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4771</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' t, q, p, enin ', t(i,k), q(i,k), p(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4772</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enin(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4773</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' tsp, qsp, enout ', tsp(i,k), qsp(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4774</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enout(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4775</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call endrun ('FINDSP')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4776</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4777</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4778</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4779</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4780</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4781</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4782</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       return</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4783</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      end subroutine findsp1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4784</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4785</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4786</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      subroutine findsp1_water (lchnk, ncol, q, t, p, tsp, qsp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4787</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4788</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4789</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Purpose:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4790</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     find the wet bulb temperature for a given t and q</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4791</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     in a longitude height section</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4792</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     wet bulb temp is the temperature and spec humidity that is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4793</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     just saturated and has the same enthalpy</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4794</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if q > qs(t) then tsp > t and qsp = qs(tsp) &lt; q</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4795</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     if q &lt; qs(t) then tsp &lt; t and qsp = qs(tsp) > q</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4796</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4797</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Method:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4798</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! a Newton method is used</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4799</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! first guess uses an algorithm provided by John Petch from the UKMO</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4800</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! we exclude points where the physical situation is unrealistic</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4801</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! e.g. where the temperature is outside the range of validity for the</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4802</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      saturation vapor pressure, or where the water vapor pressure</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4803</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      exceeds the ambient pressure, or the saturation specific humidity is</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4804</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!      unrealistic</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4805</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4806</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Author: P. Rasch</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4807</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4808</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!-----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4809</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4810</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     input arguments</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4811</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4812</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer, intent(in) :: lchnk</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4813</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer, intent(in) :: ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4814</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4815</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: q(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4816</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: t(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4817</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(in) :: p(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4818</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4819</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! output arguments</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4820</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4821</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: tsp(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4822</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), intent(out) :: qsp(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4823</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4824</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! local variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4825</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4826</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer i</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4827</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4828</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical lflg</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4829</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer iter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4830</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer l</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4831</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       logical :: error_found</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4832</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4833</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) omeps</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4834</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) trinv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4835</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4836</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) desdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4837</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     real(r8) desdp                ! change in sat vap pressure wrt pressure</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4838</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dqsdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4839</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dgdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4840</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) g</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4841</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) weight(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4842</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) hlatsb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4843</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) hlatvp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4844</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) hltalt(pcols,pver)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4845</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) tterm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4846</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) qs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4847</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) tc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4848</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4849</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! work variables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4850</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) t1, q1, dt, dq</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4851</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dtm, dqm</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4852</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) qvd, a1, tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4853</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) rair</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4854</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) r1b, c1, c2, c3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4855</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) denom</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4856</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dttol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4857</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) dqtol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4858</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       integer doit(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4859</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) enin(pcols), enout(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4860</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) tlim(pcols)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4861</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4862</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       omeps = one - epsqs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4863</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       a1 = 7.5_r8*log(10._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4864</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       rair = 287.04_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4865</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       c3 = rair*a1/cp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4866</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dtm = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4867</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqm = zero</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4868</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dttol = 1.e-4_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4869</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqtol = 1.e-4_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4870</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4871</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! max number of times to iterate the calculation</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4872</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       iter = 8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4873</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4874</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do k = 1,pver</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4875</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4876</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4877</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! first guess on the wet bulb temperature</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4878</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4879</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4880</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4881</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef DEBUG</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4882</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if ( (lchnk == lchnklook(nlook) ) .and. (i ==</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4883</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; icollook(nlook) ) ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4884</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' '</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4885</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' level, t, q, p', k, t(i,k), q(i,k), p(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4886</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4887</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4888</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! limit the temperature range to that relevant to the sat vap pres tables</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4889</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#if ( defined WACCM_PHYS )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4890</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tlim(i) = min(max(t(i,k),128._r8),373._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4891</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4892</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tlim(i) = min(max(t(i,k),173._r8),373._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4893</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4894</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4895</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = polysvp(tlim(i),0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4896</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       denom = p(i,k) - omeps*es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4897</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qs = epsqs*es/denom</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4898</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4899</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enout(i) = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4900</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make sure a meaningful calculation is possible</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4901</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (p(i,k) > 5._r8*es .and. qs > zero .and. qs &lt; 0.5_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4902</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4903</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Saturation specific humidity</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4904</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4905</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qs = min(epsqs*es/denom,one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4906</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4907</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! "generalized" analytic expression for t derivative of es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4908</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  accurate to within 1 percent for 173.16 &lt; t &lt; 373.16</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4909</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4910</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4911</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! No icephs or water to ice transition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4912</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4913</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatvp = hlatv - 2369.0*(tlim(i)-tt0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4914</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatsb = hlatv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4915</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tlim(i) &lt; tt0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4916</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatsb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4917</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4918</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatvp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4919</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4920</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!--xl</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4921</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enin(i) = cp*tlim(i) + hltalt(i,k)*q(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4922</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4923</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! make a guess at the wet bulb temp using a UKMO algorithm (from J. Petch)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4924</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tmp = q(i,k) - qs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4925</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       c1 = hltalt(i,k)*c3</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4926</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       c2 = (tlim(i) + 36._r8)**2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4927</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       r1b = c2/(c2 + c1*qs)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4928</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qvd = r1b*tmp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4929</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tsp(i,k) = tlim(i) + ((hltalt(i,k)/cp)*qvd)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4930</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef DEBUG</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4931</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if ( (lchnk == lchnklook(nlook) ) .and. (i ==</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4932</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; icollook(nlook) ) ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4933</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' relative humidity ', q(i,k)/qs</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4934</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' first guess ', tsp(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4935</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4936</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4937</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = polysvp(tsp(i,k),0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4938</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qsp(i,k) = min(epsqs*es/(p(i,k) - omeps*es),one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4939</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4940</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4941</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tsp(i,k) = tlim(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4942</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qsp(i,k) = q(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4943</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enin(i) = one</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4944</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4945</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4946</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4947</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! now iterate on first guess</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4948</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4949</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do l = 1, iter</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4950</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dtm = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4951</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqm = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4952</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4953</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4954</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = polysvp(tsp(i,k),0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4955</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4956</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! Saturation specific humidity</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4957</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4958</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qs = min(epsqs*es/(p(i,k) - omeps*es),one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4959</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4960</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! "generalized" analytic expression for t derivative of es</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4961</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! accurate to within 1 percent for 173.16 &lt; t &lt; 373.16</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4962</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4963</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4964</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! No icephs or water to ice transition</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4965</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4966</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatvp = hlatv - 2369.0*(tsp(i,k)-tt0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4967</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hlatsb = hlatv</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4968</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tsp(i,k) &lt; tt0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4969</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatsb</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4970</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4971</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       hltalt(i,k) = hlatvp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4972</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4973</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       desdt = hltalt(i,k)*es/(rgasv*tsp(i,k)*tsp(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4974</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqsdt = (epsqs + omeps*qs)/(p(i,k) - omeps*es)*desdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4975</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       g = enin(i) - (cp*tsp(i,k) + hltalt(i,k)*qsp(i,k))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4976</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dgdt = -(cp + hltalt(i,k)*dqsdt)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4977</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       t1 = tsp(i,k) - g/dgdt</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4978</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dt = abs(t1 - tsp(i,k))/t1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4979</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       tsp(i,k) = max(t1,tmin)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4980</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4981</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       es = polysvp(tsp(i,k),0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4982</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       q1 = min(epsqs*es/(p(i,k) - omeps*es),one)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4983</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dq = abs(q1 - qsp(i,k))/max(q1,1.e-12_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4984</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       qsp(i,k) = q1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4985</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#ifdef DEBUG</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4986</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if ( (lchnk == lchnklook(nlook) ) .and. (i ==</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4987</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; icollook(nlook) ) ) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4988</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' rel chg lev, iter, t, q ', k, l, dt, dq, g</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4989</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4990</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4991</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dtm = max(dtm,dt)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4992</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dqm = max(dqm,dq)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4993</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! if converged at this point, exclude it from more iterations</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4994</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (dt &lt; dttol .and. dq &lt; dqtol) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4995</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 2</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4996</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4997</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       enout(i) = cp*tsp(i,k) + hltalt(i,k)*qsp(i,k)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4998</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! bail out if we are too near the end of temp range</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>4999</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#if ( defined WACCM_PHYS )</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5000</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tsp(i,k) &lt; 130.16_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5001</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5002</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (tsp(i,k) &lt; 174.16_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5003</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5004</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       doit(i) = 4</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5005</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5006</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5007</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5008</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5009</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5010</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (dtm &lt; dttol .and. dqm &lt; dqtol) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5011</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       go to 10</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5012</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5013</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5014</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5015</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      10 continue</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5016</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5017</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       error_found = .false.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5018</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (dtm > dttol .or. dqm > dqtol) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5019</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5020</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 0) error_found = .true.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5021</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5022</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (error_found) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5023</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5024</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5025</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' findsp not converging at point i, k ', i, k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5026</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' t, q, p, enin ', t(i,k), q(i,k), p(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5027</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enin(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5028</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' tsp, qsp, enout ', tsp(i,k), qsp(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5029</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enout(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5030</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call endrun ('FINDSP')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5031</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5032</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5033</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5034</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5035</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5036</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 2 .and. abs((enin(i)-enout(i))/(enin(i)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5037</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;enout(i))) > 1.e-4_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5038</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       error_found = .true.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5039</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5040</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5041</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (error_found) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5042</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       do i = 1,ncol</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5043</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       if (doit(i) == 2 .and. abs((enin(i)-enout(i))/(enin(i)+</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5044</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;enout(i))) > 1.e-4_r8) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5045</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' the enthalpy is not conserved for point ', i,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5046</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; k, enin(i), enout(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5047</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' t, q, p, enin ', t(i,k), q(i,k), p(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5048</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enin(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5049</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       write (iulog,*) ' tsp, qsp, enout ', tsp(i,k), qsp(i,k),</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5050</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; enout(i)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5051</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       call endrun ('FINDSP')</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5052</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5053</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5054</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5055</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5056</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end do</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5057</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5058</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       return</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5059</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      end subroutine findsp1_water</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5060</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>#endif</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5061</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!--jtb : end of GEOS5 exclusion (begins at top of findsp)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5062</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5063</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5064</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! error function in single precision</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5065</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5066</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    Copyright(C) 1996 Takuya OOURA (email: ooura@mmm.t.u-tokyo.ac.jp).</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5067</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    You may use, copy, modify this code for any purpose and</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5068</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!    without fee. You may distribute this ORIGINAL package.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5069</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5070</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       function derf(x)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5071</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       implicit real (a - h, o - z)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5072</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) a,b,x</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5073</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       dimension a(0 : 64), b(0 : 64)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5074</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       integer i,k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5075</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (a(i), i = 0, 12) / 0.00000000005958930743d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5076</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000113739022964d0, 0.00000001466005199839d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5077</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000016350354461960d0, 0.00000164610044809620d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5078</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00001492559551950604d0, 0.00012055331122299265d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5079</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00085483269811296660d0, 0.00522397762482322257d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5080</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.02686617064507733420d0, 0.11283791670954881569d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5081</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.37612638903183748117d0, 1.12837916709551257377d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5082</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (a(i), i = 13, 25) / 0.00000000002372510631d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5083</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000045493253732d0, 0.00000000590362766598d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5084</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000006642090827576d0, 0.00000067595634268133d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5085</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000621188515924000d0, 0.00005103883009709690d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5086</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00037015410692956173d0, 0.00233307631218880978d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5087</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.01254988477182192210d0, 0.05657061146827041994d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5088</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.21379664776456006580d0, 0.84270079294971486929d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5089</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (a(i), i = 26, 38) / 0.00000000000949905026d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5090</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000018310229805d0, 0.00000000239463074000d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5091</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000002721444369609d0, 0.00000028045522331686d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5092</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000261830022482897d0, 0.00002195455056768781d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5093</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00016358986921372656d0, 0.00107052153564110318d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5094</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00608284718113590151d0, 0.02986978465246258244d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5095</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.13055593046562267625d0, 0.67493323603965504676d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5096</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (a(i), i = 39, 51) / 0.00000000000382722073d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5097</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000007421598602d0, 0.00000000097930574080d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5098</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000001126008898854d0, 0.00000011775134830784d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5099</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000111992758382650d0, 0.00000962023443095201d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5100</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00007404402135070773d0, 0.00050689993654144881d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5101</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00307553051439272889d0, 0.01668977892553165586d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5102</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.08548534594781312114d0, 0.56909076642393639985d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5103</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (a(i), i = 52, 64) / 0.00000000000155296588d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5104</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000003032205868d0, 0.00000000040424830707d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5105</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000471135111493d0, 0.00000005011915876293d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5106</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000048722516178974d0, 0.00000430683284629395d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5107</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00003445026145385764d0, 0.00024879276133931664d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5108</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00162940941748079288d0, 0.00988786373932350462d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5109</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.05962426839442303805d0, 0.49766113250947636708d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5110</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (b(i), i = 0, 12) / -0.00000000029734388465d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5111</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00000000269776334046d0, -0.00000000640788827665d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5112</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000001667820132100d0, -0.00000021854388148686d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5113</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00000266246030457984d0, 0.00001612722157047886d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5114</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00025616361025506629d0, 0.00015380842432375365d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5115</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00815533022524927908d0, -0.01402283663896319337d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5116</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.19746892495383021487d0, 0.71511720328842845913d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5117</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (b(i), i = 13, 25) / -0.00000000001951073787d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5118</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000032302692214d0, 0.00000000522461866919d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5119</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00000000342940918551d0, -0.00000035772874310272d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5120</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00000019999935792654d0, 0.00002687044575042908d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5121</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00011843240273775776d0, -0.00080991728956032271d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5122</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00661062970502241174d0, 0.00909530922354827295d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5123</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.20160072778491013140d0, 0.51169696718727644908d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5124</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (b(i), i = 26, 38) / 0.00000000003147682272d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5125</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000048465972408d0, 0.00000000063675740242d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5126</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00000003377623323271d0, -0.00000015451139637086d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5127</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000203340624738438d0, 0.00001947204525295057d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5128</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00002854147231653228d0, -0.00101565063152200272d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5129</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00271187003520095655d0, 0.02328095035422810727d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5130</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.16725021123116877197d0, 0.32490054966649436974d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5131</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (b(i), i = 39, 51) / 0.00000000002319363370d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5132</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000006303206648d0, -0.00000000264888267434d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5133</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00000002050708040581d0, 0.00000011371857327578d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5134</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000211211337219663d0, 0.00000368797328322935d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5135</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00009823686253424796d0, -0.00065860243990455368d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5136</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00075285814895230877d0, 0.02585434424202960464d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5137</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.11637092784486193258d0, 0.18267336775296612024d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5138</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       data (b(i), i = 52, 64) / -0.00000000000367789363d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5139</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00000000020876046746d0, -0.00000000193319027226d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5140</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000000435953392472d0, 0.00000018006992266137d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5141</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00000078441223763969d0, -0.00000675407647949153d0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5142</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 0.00008428418334440096d0, -0.00017604388937031815d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5143</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.00239729611435071610d0, 0.02064129023876022970d0, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5144</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;0.06905562880005864105d0, 0.09084526782065478489d0 /</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5145</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       w = abs(x)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5146</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       if (w .lt. 2.2d0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5147</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       t = w * w</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5148</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       k = int(t)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5149</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       t = t - k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5150</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       k = k * 13</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5151</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       y = ((((((((((((a(k) * t + a(k + 1)) * t + a(k + 2)) * t + a(k +</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5152</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; 3)) * t + a(k + 4)) * t + a(k + 5)) * t + a(k + 6)) * t + a(k +</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5153</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; 7)) * t + a(k + 8)) * t + a(k + 9)) * t + a(k + 10)) * t + a(k +</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5154</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; 11)) * t + a(k + 12)) * w</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5155</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       else if (w .lt. 6.9d0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5156</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       k = int(w)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5157</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       t = w - k</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5158</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       k = 13 * (k - 2)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5159</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       y = (((((((((((b(k) * t + b(k + 1)) * t + b(k + 2)) * t + b(k +</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5160</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; 3)) * t + b(k + 4)) * t + b(k + 5)) * t + b(k + 6)) * t + b(k +</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5161</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; 7)) * t + b(k + 8)) * t + b(k + 9)) * t + b(k + 10)) * t + b(k +</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5162</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>     &amp; 11)) * t + b(k + 12)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5163</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       y = y * y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5164</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       y = y * y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5165</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       y = y * y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5166</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       y = 1 - y * y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5167</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5168</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       y = 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5169</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5170</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       if (x .lt. 0) y = -y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5171</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       derf = y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5172</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       end function derf</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5173</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5174</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5175</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5176</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccDONIFccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5177</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5178</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5179</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5180</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!**********************************</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5181</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       FUNCTION MUI_HEMP(T)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5182</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5183</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5184</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: MUI_HEMP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5185</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       REAL(r8), intent(in) :: T</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5186</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       REAL(r8) :: TC, mui, lambdai</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5187</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       TC=T-273.15_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5188</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5189</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       TC=MIN(MAX(TC, -70.0), -15.0)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5190</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5191</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       if (TC  >  -27.0) then</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5192</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lambdai = 6.8_r8*exp(-0.096_r8*TC)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5193</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       else</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5194</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lambdai = 24.8_r8*exp(-0.049_r8*TC)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5195</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       end if</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5196</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5197</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mui=(0.13_r8*(lambdai**0.64_r8))-two</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5198</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mui=max(mui, 1.5_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5199</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       MUI_HEMP=mui</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5200</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5201</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5202</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       END FUNCTION MUI_HEMP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5203</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5204</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5205</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccDONIFccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5206</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5207</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5208</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5209</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!**********************************</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5210</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       FUNCTION MUI_HEMP_L(lambda)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5211</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5212</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5213</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) :: MUI_HEMP_L</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5214</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       REAL(r8), intent(in) :: lambda</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5215</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       REAL(r8) :: TC, mui, lx</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5216</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       lx = lambda*0.01</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5217</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5218</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mui=(0.008_r8*(lx**0.87_r8))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5219</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       mui=max(min(mui, 10.0_r8), 0.1_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5220</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       MUI_HEMP_L=mui  !Anning for multithread to work</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5221</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5222</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5223</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       END FUNCTION MUI_HEMP_L</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5224</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5225</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5226</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5227</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5228</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       FUNCTION gamma_incomp(muice, x)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5229</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5230</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5231</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5232</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8)             :: gamma_incomp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5233</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       REAL(r8), intent(in) :: muice, x</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5234</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       REAL(r8)             :: xog, kg, alfa, auxx</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5235</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       alfa = min(max(muice+1._r8, 1._r8), 20._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5236</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5237</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       xog  = log(alfa -0.3068_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5238</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       kg   = 1.44818*(alfa**0.5357_r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5239</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       auxx = max(min(kg*(log(x)-xog), 30._r8), -30._r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5240</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       gamma_incomp= one/(one +exp(-auxx))</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5241</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       gamma_incomp = max(gamma_incomp, 1.0e-20)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5242</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5243</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       END FUNCTION gamma_incomp</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5244</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5245</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5246</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5247</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5248</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       FUNCTION GAMMA(X)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5249</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5250</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5251</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5252</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D    DOUBLE PRECISION FUNCTION DGAMMA(X)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5253</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5254</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5255</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! THIS ROUTINE CALCULATES THE GAMMA FUNCTION FOR A REAL ARGUMENT X.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5256</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   COMPUTATION IS BASED ON AN ALGORITHM OUTLINED IN REFERENCE 1.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5257</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   THE PROGRAM USES RATIONAL FUNCTIONS THAT APPROXIMATE THE GAMMA</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5258</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   FUNCTION TO AT LEAST 20 SIGNIFICANT DECIMAL DIGITS.  COEFFICIENTS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5259</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   FOR THE APPROXIMATION OVER THE INTERVAL (1,2) ARE UNPUBLISHED.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5260</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   THOSE FOR THE APPROXIMATION FOR X .GE. 12 ARE FROM REFERENCE 2.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5261</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   THE ACCURACY ACHIEVED DEPENDS ON THE ARITHMETIC SYSTEM, THE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5262</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   COMPILER, THE INTRINSIC FUNCTIONS, AND PROPER SELECTION OF THE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5263</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   MACHINE-DEPENDENT CONSTANTS.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5264</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5265</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5266</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!*******************************************************************</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5267</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!*******************************************************************</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5268</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5269</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! EXPLANATION OF MACHINE-DEPENDENT CONSTANTS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5270</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5271</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! BETA   - RADIX FOR THE FLOATING-POINT REPRESENTATION</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5272</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! MAXEXP - THE SMALLEST POSITIVE POWER OF BETA THAT OVERFLOWS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5273</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! XBIG   - THE LARGEST ARGUMENT FOR WHICH GAMMA(X) IS REPRESENTABLE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5274</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          IN THE MACHINE, I.E., THE SOLUTION TO THE EQUATION</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5275</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                  GAMMA(XBIG) = BETA**MAXEXP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5276</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! XINF   - THE LARGEST MACHINE REPRESENTABLE FLOATING-POINT NUMBER;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5277</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          APPROXIMATELY BETA**MAXEXP</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5278</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! EPS    - THE SMALLEST POSITIVE FLOATING-POINT NUMBER SUCH THAT</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5279</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          1.0+EPS .GT. 1.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5280</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! XMININ - THE SMALLEST POSITIVE FLOATING-POINT NUMBER SUCH THAT</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5281</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!          1/XMININ IS MACHINE REPRESENTABLE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5282</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5283</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     APPROXIMATE VALUES FOR SOME IMPORTANT MACHINES ARE:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5284</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5285</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                            BETA       MAXEXP        XBIG</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5286</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5287</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! CRAY-1         (S.P.)        2         8191        966.961</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5288</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! CYBER 180/855</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5289</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   UNDER NOS    (S.P.)        2         1070        177.803</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5290</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! IEEE (IBM/XT,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5291</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   SUN, ETC.)   (S.P.)        2          128        35.040</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5292</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! IEEE (IBM/XT,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5293</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   SUN, ETC.)   (D.P.)        2         1024        171.624</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5294</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! IBM 3033       (D.P.)       16           63        57.574</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5295</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! VAX D-FORMAT   (D.P.)        2          127        34.844</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5296</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! VAX G-FORMAT   (D.P.)        2         1023        171.489</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5297</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5298</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!                            XINF         EPS        XMININ</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5299</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5300</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! CRAY-1         (S.P.)   5.45E+2465   7.11E-15    1.84E-2466</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5301</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! CYBER 180/855</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5302</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   UNDER NOS    (S.P.)   1.26E+322    3.55E-15    3.14E-294</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5303</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! IEEE (IBM/XT,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5304</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   SUN, ETC.)   (S.P.)   3.40E+38     1.19E-7     1.18E-38</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5305</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! IEEE (IBM/XT,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5306</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!   SUN, ETC.)   (D.P.)   1.79D+308    2.22D-16    2.23D-308</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5307</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! IBM 3033       (D.P.)   7.23D+75     2.22D-16    1.39D-76</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5308</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! VAX D-FORMAT   (D.P.)   1.70D+38     1.39D-17    5.88D-39</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5309</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! VAX G-FORMAT   (D.P.)   8.98D+307    1.11D-16    1.12D-308</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5310</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5311</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!*******************************************************************</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5312</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!*******************************************************************</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5313</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5314</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ERROR RETURNS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5315</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5316</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  THE PROGRAM RETURNS THE VALUE XINF FOR SINGULARITIES OR</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5317</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     WHEN OVERFLOW WOULD OCCUR.  THE COMPUTATION IS BELIEVED</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5318</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     TO BE FREE OF UNDERFLOW AND OVERFLOW.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5319</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5320</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5321</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  INTRINSIC FUNCTIONS REQUIRED ARE:</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5322</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5323</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     INT, DBLE, EXP, LOG, REAL, SIN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5324</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5325</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5326</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! REFERENCES:  AN OVERVIEW OF SOFTWARE DEVELOPMENT FOR SPECIAL</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5327</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              FUNCTIONS   W. J. CODY, LECTURE NOTES IN MATHEMATICS,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5328</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              506, NUMERICAL ANALYSIS DUNDEE, 1975, G. A. WATSON</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5329</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              (ED.), SPRINGER VERLAG, BERLIN, 1976.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5330</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5331</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              COMPUTER APPROXIMATIONS, HART, ET. AL., WILEY AND</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5332</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!              SONS, NEW YORK, 1968.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5333</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5334</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  LATEST MODIFICATION: OCTOBER 12, 1989</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5335</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5336</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  AUTHORS: W. J. CODY AND L. STOLTZ</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5337</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!           APPLIED MATHEMATICS DIVISION</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5338</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!           ARGONNE NATIONAL LABORATORY</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5339</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!           ARGONNE, IL 60439</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5340</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5341</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5342</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       INTEGER I,N</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5343</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       LOGICAL PARITY</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5344</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5345</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       REAL(r8)  :: gamma,CONV,FACT,RES,SUM,X,XDEN,XNUM,Y,Y1,YSQ,Z</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5346</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8) ::  C(7),P(8),Q(8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5347</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5348</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  MATHEMATICAL CONSTANTS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5349</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5350</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: ONE=1.0E0_r8,     HALF=0.5E0_r8,          &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5351</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                        TWELVE=12.0E0_r8, TWO=2.0E0_r8,           &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5352</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                        ZERO=0.0E0_r8,                            &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5353</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                        PI=3.1415926535897932384626434E0_r8,      &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5354</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                        SQRTPI=0.9189385332046727417803297E0_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5355</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5356</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D    DATA ONE,HALF,TWELVE,TWO,ZERO/1.0D0,0.5D0,12.0D0,2.0D0,0.0D0/,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5357</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   1     SQRTPI/0.9189385332046727417803297D0/,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5358</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   2     PI/3.1415926535897932384626434D0/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5359</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5360</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  MACHINE DEPENDENT PARAMETERS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5361</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5362</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       real(r8), parameter :: XBIG=35.040E0_r8, XMININ=1.18E-38_r8,     &amp;</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5363</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;                        EPS=1.19E-7_r8,   XINF=3.4E38_r8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5364</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5365</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D    DATA XBIG,XMININ,EPS/171.624D0,2.23D-308,2.22D-16/,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5366</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   1     XINF/1.79D308/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5367</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5368</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  NUMERATOR AND DENOMINATOR COEFFICIENTS FOR RATIONAL MINIMAX</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5369</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!     APPROXIMATION OVER (1,2).</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5370</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5371</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       DATA P/-1.71618513886549492533811E+0_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5372</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;2.47656508055759199108314E+1_r8, -3.79804256470945635097577E+2_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5373</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;6.29331155312818442661052E+2_r8, 8.66966202790413211295064E+2_r8,-</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5374</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;3.14512729688483675254357E+4_r8, -3.61444134186911729807069E+4_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5375</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;6.64561438202405440627855E+4_r8/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5376</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       DATA Q/-3.08402300119738975254353E+1_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5377</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;3.15350626979604161529144E+2_r8, -1.01515636749021914166146E+3_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5378</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;-3.10777167157231109440444E+3_r8, 2.25381184209801510330112E+4_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5379</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;4.75584627752788110767815E+3_r8, -1.34659959864969306392456E+5_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5380</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;-1.15132259675553483497211E+5_r8/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5381</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D    DATA P/-1.71618513886549492533811D+0,2.47656508055759199108314D+1,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5382</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   1       -3.79804256470945635097577D+2,6.29331155312818442661052D+2,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5383</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   2       8.66966202790413211295064D+2,-3.14512729688483675254357D+4,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5384</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   3       -3.61444134186911729807069D+4,6.64561438202405440627855D+4/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5385</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D    DATA Q/-3.08402300119738975254353D+1,3.15350626979604161529144D+2,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5386</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   1      -1.01515636749021914166146D+3,-3.10777167157231109440444D+3,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5387</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   2        2.25381184209801510330112D+4,4.75584627752788110767815D+3,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5388</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   3      -1.34659959864969306392456D+5,-1.15132259675553483497211D+5/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5389</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5390</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  COEFFICIENTS FOR MINIMAX APPROXIMATION OVER (12, INF).</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5391</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5392</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       DATA C/-1.910444077728E-03_r8,8.4171387781295E-04_r8, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5393</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;5.952379913043012E-04_r8,7.93650793500350248E-04_r8, -</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5394</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp;2.777777777777681622553E-03_r8,8.333333333333333331554247E-02_r8,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5395</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>     &amp; 5.7083835261E-03_r8/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5396</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D    DATA C/-1.910444077728D-03,8.4171387781295D-04,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5397</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   1     -5.952379913043012D-04,7.93650793500350248D-04,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5398</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   2     -2.777777777777681622553D-03,8.333333333333333331554247D-02,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5399</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D   3      5.7083835261D-03/</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5400</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5401</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  STATEMENT FUNCTIONS FOR CONVERSION BETWEEN INTEGER AND FLOAT</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5402</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5403</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      CONV(I) = REAL(I,r8)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5404</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D    CONV(I) = DBLE(I)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5405</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       PARITY = .FALSE.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5406</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       FACT   = ONE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5407</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       N = 0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5408</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       Y = X</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5409</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       IF(Y &lt;= ZERO) THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5410</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5411</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  ARGUMENT IS NEGATIVE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5412</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5413</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         Y  = -X</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5414</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         Y1 = AINT(Y)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5415</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         RES = Y - Y1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5416</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         IF(RES.NE.ZERO)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5417</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           IF(Y1.NE.AINT(Y1*HALF)*TWO) PARITY = .TRUE.</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5418</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             FACT = -PI/SIN(PI*RES)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5419</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             Y    = Y + ONE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5420</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ELSE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5421</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           RES=XINF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5422</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           GOTO 900</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5423</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ENDIF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5424</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       ENDIF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5425</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5426</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  ARGUMENT IS POSITIVE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5427</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5428</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       IF(Y.LT.EPS)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5429</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5430</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  ARGUMENT .LT. EPS</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5431</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5432</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         IF(Y.GE.XMININ)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5433</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           RES = ONE/Y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5434</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ELSE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5435</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           RES = XINF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5436</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           GOTO 900</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5437</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ENDIF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5438</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       ELSEIF(Y.LT.TWELVE)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5439</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         Y1 = Y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5440</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         IF(Y.LT.ONE)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5441</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5442</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  0.0 .LT. ARGUMENT .LT. 1.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5443</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5444</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           Z = Y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5445</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           Y = Y + ONE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5446</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ELSE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5447</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5448</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  1.0 .LT. ARGUMENT .LT. 12.0, REDUCE ARGUMENT IF NECESSARY</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5449</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5450</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           N = INT(Y) - 1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5451</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           Y = Y - CONV(N)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5452</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           Z = Y - ONE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5453</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ENDIF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5454</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5455</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  EVALUATE APPROXIMATION FOR 1.0 .LT. ARGUMENT .LT. 2.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5456</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5457</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         XNUM = ZERO</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5458</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         XDEN = ONE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5459</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         DO 260 I=1,8</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5460</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           XNUM = (XNUM+P(I))*Z</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5461</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           XDEN = XDEN*Z + Q(I)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5462</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>260      CONTINUE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5463</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         RES = XNUM/XDEN + ONE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5464</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         IF(Y1.LT.Y)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5465</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5466</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  ADJUST RESULT FOR CASE  0.0 .LT. ARGUMENT .LT. 1.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5467</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5468</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           RES = RES/Y1</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5469</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         ELSEIF(Y1.GT.Y)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5470</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5471</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  ADJUST RESULT FOR CASE  2.0 .LT. ARGUMENT .LT. 12.0</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5472</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5473</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           DO 290 I=1,N</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5474</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             RES = RES*Y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5475</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             Y   = Y + ONE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5476</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>290        CONTINUE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5477</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ENDIF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5478</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       ELSE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5479</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5480</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  EVALUATE FOR ARGUMENT .GE. 12.0,</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5481</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5482</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>         IF(Y.LE.XBIG)THEN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5483</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           YSQ = Y*Y</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5484</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           SUM = C(7)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5485</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           DO 350 I=1,6</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5486</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>             SUM = SUM / YSQ + C(I)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5487</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>350        CONTINUE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5488</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           SUM = SUM / Y - Y + SQRTPI</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5489</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           SUM = SUM + (Y-HALF)*LOG(Y)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5490</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           RES = EXP(SUM)</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5491</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ELSE</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5492</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           RES = XINF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5493</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>           GOTO 900</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5494</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>         ENDIF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5495</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       ENDIF</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5496</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5497</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!  FINAL ADJUSTMENTS AND RETURN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5498</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!----------------------------------------------------------------------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5499</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       IF(PARITY) RES = -RES</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5500</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       IF(FACT.NE.ONE) RES = FACT/RES</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5501</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>900    GAMMA = RES</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5502</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>!D900 DGAMMA = RES</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5503</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount uncoveredLine"><pre></pre></td>
    <td align="left" class="src uncoveredLine"><pre>       RETURN</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5504</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>! ---------- LAST LINE OF GAMMA ----------</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5505</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>       END function gamma</pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5506</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5507</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5508</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre></pre></td>
    </tr>

    <tr>
    <td align="right" class="lineno"><pre>5509</pre></td>
    <td align="right" class="linebranch"></td>
    <td align="right" class="linecount "><pre></pre></td>
    <td align="left" class="src "><pre>      end module cldwat2m_micro</pre></td>
    </tr>

  </table>
  <br>

  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr><td class="hr"><td></tr>
    <tr><td class="footer">Generated by: <a href="http://gcovr.com">GCOVR (Version 4.2)</a></td></tr>
  </table>
  <br>

</body>

</html>

